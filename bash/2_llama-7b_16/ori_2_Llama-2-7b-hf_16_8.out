Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:07<00:14,  7.24s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:12<00:05,  5.92s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:18<00:00,  6.11s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:18<00:00,  6.19s/it]
[2024-01-18 07:06:17,069] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 66/128 [00:00<00:00, 654.51it/s]100%|██████████| 128/128 [00:00<00:00, 662.72it/s]
[2024-01-18 07:06:17,392] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:01<02:36,  1.23s/it]  2%|▏         | 2/128 [00:01<01:41,  1.25it/s]  2%|▏         | 3/128 [00:02<01:23,  1.49it/s]  3%|▎         | 4/128 [00:02<01:14,  1.66it/s]  4%|▍         | 5/128 [00:03<01:09,  1.76it/s]  5%|▍         | 6/128 [00:03<01:07,  1.81it/s]  5%|▌         | 7/128 [00:04<01:05,  1.84it/s]  6%|▋         | 8/128 [00:04<00:59,  2.00it/s]  7%|▋         | 9/128 [00:05<00:57,  2.08it/s]  8%|▊         | 10/128 [00:05<00:57,  2.04it/s]  9%|▊         | 11/128 [00:06<00:55,  2.11it/s]  9%|▉         | 12/128 [00:06<00:56,  2.06it/s] 10%|█         | 13/128 [00:07<00:57,  2.01it/s] 11%|█         | 14/128 [00:07<00:57,  1.98it/s] 12%|█▏        | 15/128 [00:08<00:57,  1.95it/s] 12%|█▎        | 16/128 [00:08<00:57,  1.96it/s] 13%|█▎        | 17/128 [00:09<00:57,  1.94it/s] 14%|█▍        | 18/128 [00:09<00:56,  1.94it/s] 15%|█▍        | 19/128 [00:10<00:54,  2.01it/s] 16%|█▌        | 20/128 [00:10<00:51,  2.09it/s] 16%|█▋        | 21/128 [00:11<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:11<00:49,  2.16it/s] 18%|█▊        | 23/128 [00:12<00:50,  2.08it/s] 19%|█▉        | 24/128 [00:12<00:48,  2.13it/s] 20%|█▉        | 25/128 [00:13<00:49,  2.06it/s] 20%|██        | 26/128 [00:13<00:48,  2.09it/s] 21%|██        | 27/128 [00:13<00:47,  2.11it/s] 22%|██▏       | 28/128 [00:14<00:48,  2.04it/s] 23%|██▎       | 29/128 [00:14<00:46,  2.11it/s] 23%|██▎       | 30/128 [00:15<00:47,  2.07it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.03it/s] 25%|██▌       | 32/128 [00:16<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 34/128 [00:17<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:18<00:46,  1.99it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.97it/s] 30%|██▉       | 38/128 [00:19<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:45,  1.96it/s] 31%|███▏      | 40/128 [00:20<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:21<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:21<00:42,  2.02it/s] 34%|███▎      | 43/128 [00:21<00:42,  2.00it/s] 34%|███▍      | 44/128 [00:22<00:42,  1.98it/s] 35%|███▌      | 45/128 [00:23<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:23<00:41,  1.96it/s] 37%|███▋      | 47/128 [00:24<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:24<00:39,  2.00it/s] 38%|███▊      | 49/128 [00:25<00:39,  1.99it/s] 39%|███▉      | 50/128 [00:25<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.03it/s] 41%|████      | 52/128 [00:26<00:37,  2.01it/s] 41%|████▏     | 53/128 [00:27<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.97it/s] 43%|████▎     | 55/128 [00:28<00:36,  2.02it/s] 44%|████▍     | 56/128 [00:28<00:38,  1.88it/s] 45%|████▍     | 57/128 [00:29<00:37,  1.90it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.97it/s] 46%|████▌     | 59/128 [00:30<00:35,  1.97it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:31<00:34,  1.94it/s] 48%|████▊     | 62/128 [00:31<00:36,  1.83it/s] 49%|████▉     | 63/128 [00:32<00:33,  1.94it/s] 50%|█████     | 64/128 [00:32<00:32,  1.95it/s] 51%|█████     | 65/128 [00:33<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.95it/s] 52%|█████▏    | 67/128 [00:34<00:29,  2.04it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.99it/s] 54%|█████▍    | 69/128 [00:35<00:29,  1.98it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.95it/s] 55%|█████▌    | 71/128 [00:36<00:29,  1.93it/s] 56%|█████▋    | 72/128 [00:36<00:28,  2.00it/s] 57%|█████▋    | 73/128 [00:37<00:26,  2.11it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.04it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.89it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.89it/s] 60%|██████    | 77/128 [00:39<00:26,  1.89it/s] 61%|██████    | 78/128 [00:39<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.99it/s] 65%|██████▍   | 83/128 [00:42<00:22,  1.99it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.97it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.96it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.96it/s] 68%|██████▊   | 87/128 [00:44<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.05it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.00it/s] 70%|███████   | 90/128 [00:45<00:19,  1.97it/s] 71%|███████   | 91/128 [00:46<00:18,  1.96it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.94it/s] 73%|███████▎  | 93/128 [00:47<00:17,  1.95it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.93it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:49<00:15,  2.06it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.09it/s] 77%|███████▋  | 99/128 [00:50<00:14,  2.04it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.07it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.04it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.01it/s] 80%|████████  | 103/128 [00:52<00:12,  1.97it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:53<00:10,  2.02it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.06it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.03it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.09it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.13it/s] 87%|████████▋ | 111/128 [00:56<00:08,  2.07it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.03it/s] 88%|████████▊ | 113/128 [00:57<00:07,  1.99it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:58<00:06,  1.99it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.97it/s] 91%|█████████▏| 117/128 [00:59<00:05,  1.96it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.96it/s] 93%|█████████▎| 119/128 [01:00<00:04,  1.95it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.94it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.99it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.03it/s] 97%|█████████▋| 124/128 [01:02<00:02,  2.00it/s] 98%|█████████▊| 125/128 [01:03<00:01,  1.99it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.97it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.94it/s]100%|██████████| 128/128 [01:04<00:00,  1.94it/s]100%|██████████| 128/128 [01:04<00:00,  1.97it/s]
[2024-01-18 07:07:22,389] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:06,  1.92it/s]  2%|▏         | 2/128 [00:01<01:04,  1.94it/s]  2%|▏         | 3/128 [00:01<01:04,  1.93it/s]  3%|▎         | 4/128 [00:02<01:04,  1.94it/s]  4%|▍         | 5/128 [00:02<01:03,  1.94it/s]  5%|▍         | 6/128 [00:03<01:03,  1.92it/s]  5%|▌         | 7/128 [00:03<01:03,  1.90it/s]  6%|▋         | 8/128 [00:04<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:05<00:57,  2.04it/s]  9%|▊         | 11/128 [00:05<00:55,  2.10it/s]  9%|▉         | 12/128 [00:05<00:56,  2.04it/s] 10%|█         | 13/128 [00:06<00:57,  1.99it/s] 11%|█         | 14/128 [00:07<00:58,  1.95it/s] 12%|█▏        | 15/128 [00:07<00:58,  1.92it/s] 12%|█▎        | 16/128 [00:08<00:58,  1.93it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.91it/s] 14%|█▍        | 18/128 [00:09<00:57,  1.91it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.97it/s] 16%|█▌        | 20/128 [00:10<00:52,  2.05it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.08it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.12it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.04it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.03it/s] 20%|██        | 26/128 [00:12<00:49,  2.06it/s] 21%|██        | 27/128 [00:13<00:48,  2.08it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.08it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.04it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.00it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.95it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.95it/s] 28%|██▊       | 36/128 [00:18<00:47,  1.92it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.91it/s] 30%|██▉       | 38/128 [00:19<00:47,  1.91it/s] 30%|███       | 39/128 [00:19<00:46,  1.92it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.92it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.90it/s] 33%|███▎      | 42/128 [00:21<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.98it/s] 34%|███▍      | 44/128 [00:22<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.93it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.92it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.98it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.96it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.04it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.00it/s] 41%|████      | 52/128 [00:26<00:38,  1.98it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.95it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.95it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.00it/s] 44%|████▍     | 56/128 [00:28<00:38,  1.86it/s] 45%|████▍     | 57/128 [00:28<00:37,  1.88it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.95it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:35,  1.91it/s] 48%|████▊     | 62/128 [00:31<00:36,  1.81it/s] 49%|████▉     | 63/128 [00:32<00:33,  1.92it/s] 50%|█████     | 64/128 [00:32<00:33,  1.93it/s] 51%|█████     | 65/128 [00:33<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.93it/s] 52%|█████▏    | 67/128 [00:34<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.96it/s] 54%|█████▍    | 69/128 [00:35<00:30,  1.96it/s] 55%|█████▍    | 70/128 [00:35<00:30,  1.93it/s] 55%|█████▌    | 71/128 [00:36<00:29,  1.91it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.97it/s] 57%|█████▋    | 73/128 [00:37<00:26,  2.08it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.01it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.86it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.86it/s] 60%|██████    | 77/128 [00:39<00:27,  1.87it/s] 61%|██████    | 78/128 [00:39<00:26,  1.87it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:42<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.95it/s] 66%|██████▋   | 85/128 [00:43<00:22,  1.94it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.93it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.03it/s] 70%|██████▉   | 89/128 [00:45<00:19,  1.98it/s] 70%|███████   | 90/128 [00:45<00:19,  1.94it/s] 71%|███████   | 91/128 [00:46<00:19,  1.94it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.91it/s] 73%|███████▎  | 93/128 [00:47<00:18,  1.92it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.92it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.91it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.91it/s] 76%|███████▌  | 97/128 [00:49<00:15,  2.04it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.07it/s] 77%|███████▋  | 99/128 [00:50<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:51<00:13,  1.99it/s] 80%|████████  | 103/128 [00:52<00:12,  1.95it/s] 81%|████████▏ | 104/128 [00:53<00:12,  1.93it/s] 82%|████████▏ | 105/128 [00:53<00:12,  1.91it/s] 83%|████████▎ | 106/128 [00:54<00:11,  2.00it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.04it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.00it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.07it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.11it/s] 87%|████████▋ | 111/128 [00:56<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.01it/s] 88%|████████▊ | 113/128 [00:57<00:07,  1.97it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.01it/s] 90%|████████▉ | 115/128 [00:58<00:06,  1.97it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.96it/s] 91%|█████████▏| 117/128 [00:59<00:05,  1.94it/s] 92%|█████████▏| 118/128 [01:00<00:05,  1.94it/s] 93%|█████████▎| 119/128 [01:00<00:04,  1.93it/s] 94%|█████████▍| 120/128 [01:01<00:04,  1.93it/s] 95%|█████████▍| 121/128 [01:01<00:03,  1.98it/s] 95%|█████████▌| 122/128 [01:02<00:03,  1.97it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:03<00:02,  1.98it/s] 98%|█████████▊| 125/128 [01:03<00:01,  1.97it/s] 98%|█████████▊| 126/128 [01:04<00:01,  1.95it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.92it/s]100%|██████████| 128/128 [01:05<00:00,  1.92it/s]100%|██████████| 128/128 [01:05<00:00,  1.96it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.92s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.37s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.28s/it]
[2024-01-18 07:09:23,752] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 55%|█████▍    | 70/128 [00:00<00:00, 692.54it/s]100%|██████████| 128/128 [00:00<00:00, 698.87it/s]
[2024-01-18 07:09:24,065] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.29it/s]  2%|▏         | 2/128 [00:00<01:01,  2.04it/s]  2%|▏         | 3/128 [00:01<00:55,  2.24it/s]  3%|▎         | 4/128 [00:01<00:54,  2.26it/s]  4%|▍         | 5/128 [00:02<00:57,  2.14it/s]  5%|▍         | 6/128 [00:02<00:54,  2.24it/s]  5%|▌         | 7/128 [00:03<00:54,  2.21it/s]  6%|▋         | 8/128 [00:03<00:57,  2.10it/s]  7%|▋         | 9/128 [00:04<00:54,  2.20it/s]  8%|▊         | 10/128 [00:04<00:51,  2.27it/s]  9%|▊         | 11/128 [00:04<00:51,  2.27it/s]  9%|▉         | 12/128 [00:05<00:50,  2.28it/s] 10%|█         | 13/128 [00:05<00:50,  2.27it/s] 11%|█         | 14/128 [00:06<00:52,  2.17it/s] 12%|█▏        | 15/128 [00:06<00:51,  2.21it/s] 12%|█▎        | 16/128 [00:07<00:50,  2.23it/s] 13%|█▎        | 17/128 [00:07<00:51,  2.14it/s] 14%|█▍        | 18/128 [00:08<00:50,  2.18it/s] 15%|█▍        | 19/128 [00:08<00:49,  2.20it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.13it/s] 17%|█▋        | 22/128 [00:10<00:47,  2.21it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.12it/s] 19%|█▉        | 24/128 [00:10<00:48,  2.14it/s] 20%|█▉        | 25/128 [00:11<00:48,  2.14it/s] 20%|██        | 26/128 [00:11<00:45,  2.22it/s] 21%|██        | 27/128 [00:12<00:47,  2.13it/s] 22%|██▏       | 28/128 [00:12<00:48,  2.05it/s] 23%|██▎       | 29/128 [00:13<00:49,  2.00it/s] 23%|██▎       | 30/128 [00:13<00:47,  2.05it/s] 24%|██▍       | 31/128 [00:14<00:48,  2.01it/s] 25%|██▌       | 32/128 [00:14<00:46,  2.06it/s] 26%|██▌       | 33/128 [00:15<00:44,  2.11it/s] 27%|██▋       | 34/128 [00:15<00:44,  2.12it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.05it/s] 28%|██▊       | 36/128 [00:16<00:43,  2.11it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.06it/s] 30%|██▉       | 38/128 [00:17<00:44,  2.02it/s] 30%|███       | 39/128 [00:18<00:41,  2.13it/s] 31%|███▏      | 40/128 [00:18<00:41,  2.14it/s] 32%|███▏      | 41/128 [00:19<00:40,  2.14it/s] 33%|███▎      | 42/128 [00:19<00:40,  2.15it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.07it/s] 34%|███▍      | 44/128 [00:20<00:40,  2.09it/s] 35%|███▌      | 45/128 [00:21<00:40,  2.03it/s] 36%|███▌      | 46/128 [00:21<00:38,  2.15it/s] 37%|███▋      | 47/128 [00:21<00:37,  2.18it/s] 38%|███▊      | 48/128 [00:22<00:37,  2.11it/s] 38%|███▊      | 49/128 [00:22<00:38,  2.04it/s] 39%|███▉      | 50/128 [00:23<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:23<00:36,  2.08it/s] 41%|████      | 52/128 [00:24<00:34,  2.18it/s] 41%|████▏     | 53/128 [00:24<00:34,  2.20it/s] 42%|████▏     | 54/128 [00:25<00:33,  2.22it/s] 43%|████▎     | 55/128 [00:25<00:34,  2.13it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.07it/s] 45%|████▍     | 57/128 [00:26<00:32,  2.17it/s] 45%|████▌     | 58/128 [00:27<00:32,  2.16it/s] 46%|████▌     | 59/128 [00:27<00:33,  2.07it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:28<00:32,  2.08it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.04it/s] 49%|████▉     | 63/128 [00:29<00:32,  2.01it/s] 50%|█████     | 64/128 [00:30<00:32,  1.96it/s] 51%|█████     | 65/128 [00:30<00:32,  1.96it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.96it/s] 52%|█████▏    | 67/128 [00:31<00:29,  2.08it/s] 53%|█████▎    | 68/128 [00:32<00:28,  2.10it/s] 54%|█████▍    | 69/128 [00:32<00:27,  2.15it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.07it/s] 55%|█████▌    | 71/128 [00:33<00:26,  2.18it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.07it/s] 57%|█████▋    | 73/128 [00:34<00:27,  2.03it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.01it/s] 59%|█████▊    | 75/128 [00:35<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.03it/s] 60%|██████    | 77/128 [00:36<00:25,  2.00it/s] 61%|██████    | 78/128 [00:37<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:37<00:24,  2.03it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.99it/s] 63%|██████▎   | 81/128 [00:38<00:23,  1.97it/s] 64%|██████▍   | 82/128 [00:39<00:22,  2.02it/s] 65%|██████▍   | 83/128 [00:39<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:39<00:21,  2.07it/s] 66%|██████▋   | 85/128 [00:40<00:20,  2.09it/s] 67%|██████▋   | 86/128 [00:40<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:41<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:42<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:42<00:18,  2.09it/s] 70%|███████   | 90/128 [00:42<00:18,  2.05it/s] 71%|███████   | 91/128 [00:43<00:17,  2.11it/s] 72%|███████▏  | 92/128 [00:43<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:44<00:16,  2.11it/s] 73%|███████▎  | 94/128 [00:44<00:15,  2.15it/s] 74%|███████▍  | 95/128 [00:45<00:16,  2.06it/s] 75%|███████▌  | 96/128 [00:45<00:15,  2.08it/s] 76%|███████▌  | 97/128 [00:46<00:15,  2.04it/s] 77%|███████▋  | 98/128 [00:46<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:47<00:14,  1.96it/s] 78%|███████▊  | 100/128 [00:47<00:13,  2.01it/s] 79%|███████▉  | 101/128 [00:48<00:13,  2.05it/s] 80%|███████▉  | 102/128 [00:48<00:12,  2.15it/s] 80%|████████  | 103/128 [00:49<00:10,  2.36it/s] 81%|████████▏ | 104/128 [00:49<00:10,  2.29it/s] 82%|████████▏ | 105/128 [00:49<00:10,  2.27it/s] 83%|████████▎ | 106/128 [00:50<00:10,  2.16it/s] 84%|████████▎ | 107/128 [00:50<00:09,  2.18it/s] 84%|████████▍ | 108/128 [00:51<00:09,  2.21it/s] 85%|████████▌ | 109/128 [00:51<00:09,  2.09it/s] 86%|████████▌ | 110/128 [00:52<00:08,  2.10it/s] 87%|████████▋ | 111/128 [00:52<00:07,  2.15it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.14it/s] 88%|████████▊ | 113/128 [00:53<00:06,  2.22it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.20it/s] 90%|████████▉ | 115/128 [00:54<00:06,  2.11it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:55<00:05,  2.08it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.17it/s] 93%|█████████▎| 119/128 [00:56<00:04,  2.24it/s] 94%|█████████▍| 120/128 [00:56<00:03,  2.21it/s] 95%|█████████▍| 121/128 [00:57<00:03,  2.22it/s] 95%|█████████▌| 122/128 [00:57<00:02,  2.22it/s] 96%|█████████▌| 123/128 [00:58<00:02,  2.20it/s] 97%|█████████▋| 124/128 [00:58<00:01,  2.21it/s] 98%|█████████▊| 125/128 [00:59<00:01,  2.12it/s] 98%|█████████▊| 126/128 [00:59<00:00,  2.07it/s] 99%|█████████▉| 127/128 [01:00<00:00,  2.01it/s]100%|██████████| 128/128 [01:00<00:00,  2.04it/s]100%|██████████| 128/128 [01:00<00:00,  2.11it/s]
[2024-01-18 07:10:24,852] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.25it/s]  2%|▏         | 2/128 [00:00<01:02,  2.00it/s]  2%|▏         | 3/128 [00:01<00:56,  2.21it/s]  3%|▎         | 4/128 [00:01<00:55,  2.22it/s]  4%|▍         | 5/128 [00:02<00:58,  2.11it/s]  5%|▍         | 6/128 [00:02<00:55,  2.21it/s]  5%|▌         | 7/128 [00:03<00:57,  2.11it/s]  6%|▋         | 8/128 [00:03<00:59,  2.03it/s]  7%|▋         | 9/128 [00:04<00:55,  2.13it/s]  8%|▊         | 10/128 [00:04<00:53,  2.21it/s]  9%|▊         | 11/128 [00:05<00:52,  2.22it/s]  9%|▉         | 12/128 [00:05<00:52,  2.23it/s] 10%|█         | 13/128 [00:05<00:51,  2.24it/s] 11%|█         | 14/128 [00:06<00:53,  2.14it/s] 12%|█▏        | 15/128 [00:06<00:52,  2.17it/s] 12%|█▎        | 16/128 [00:07<00:51,  2.19it/s] 13%|█▎        | 17/128 [00:07<00:52,  2.11it/s] 14%|█▍        | 18/128 [00:08<00:51,  2.14it/s] 15%|█▍        | 19/128 [00:08<00:50,  2.16it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:09<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.18it/s] 18%|█▊        | 23/128 [00:10<00:50,  2.09it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:11<00:48,  2.11it/s] 20%|██        | 26/128 [00:12<00:46,  2.19it/s] 21%|██        | 27/128 [00:12<00:48,  2.10it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.02it/s] 24%|██▍       | 31/128 [00:14<00:48,  1.98it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.03it/s] 26%|██▌       | 33/128 [00:15<00:45,  2.09it/s] 27%|██▋       | 34/128 [00:16<00:44,  2.09it/s] 27%|██▋       | 35/128 [00:16<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.08it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.03it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:18<00:42,  2.10it/s] 31%|███▏      | 40/128 [00:18<00:41,  2.11it/s] 32%|███▏      | 41/128 [00:19<00:41,  2.11it/s] 33%|███▎      | 42/128 [00:19<00:40,  2.11it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.04it/s] 34%|███▍      | 44/128 [00:20<00:40,  2.06it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:21<00:38,  2.13it/s] 37%|███▋      | 47/128 [00:22<00:37,  2.15it/s] 38%|███▊      | 48/128 [00:22<00:38,  2.08it/s] 38%|███▊      | 49/128 [00:23<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:23<00:39,  1.99it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.03it/s] 41%|████      | 52/128 [00:24<00:35,  2.13it/s] 41%|████▏     | 53/128 [00:25<00:34,  2.16it/s] 42%|████▏     | 54/128 [00:25<00:33,  2.18it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.10it/s] 44%|████▍     | 56/128 [00:26<00:35,  2.04it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.14it/s] 45%|████▌     | 58/128 [00:27<00:33,  2.07it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:28<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.04it/s] 48%|████▊     | 62/128 [00:29<00:33,  2.00it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.97it/s] 50%|█████     | 64/128 [00:30<00:33,  1.93it/s] 51%|█████     | 65/128 [00:31<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:31<00:32,  1.94it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.06it/s] 53%|█████▎    | 68/128 [00:32<00:28,  2.07it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.12it/s] 55%|█████▍    | 70/128 [00:33<00:28,  2.05it/s] 55%|█████▌    | 71/128 [00:34<00:26,  2.15it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.05it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.97it/s] 59%|█████▊    | 75/128 [00:36<00:27,  1.96it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.00it/s] 60%|██████    | 77/128 [00:37<00:25,  1.97it/s] 61%|██████    | 78/128 [00:37<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:38<00:24,  2.02it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.97it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.95it/s] 64%|██████▍   | 82/128 [00:39<00:22,  2.00it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.05it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.07it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:42<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:42<00:20,  1.95it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.07it/s] 70%|███████   | 90/128 [00:43<00:18,  2.02it/s] 71%|███████   | 91/128 [00:44<00:17,  2.09it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.09it/s] 73%|███████▎  | 94/128 [00:45<00:15,  2.13it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.04it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.06it/s] 76%|███████▌  | 97/128 [00:46<00:15,  2.03it/s] 77%|███████▋  | 98/128 [00:47<00:15,  2.00it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.95it/s] 78%|███████▊  | 100/128 [00:48<00:14,  2.00it/s] 79%|███████▉  | 101/128 [00:48<00:13,  2.04it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.14it/s] 80%|████████  | 103/128 [00:49<00:10,  2.34it/s] 81%|████████▏ | 104/128 [00:50<00:10,  2.28it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.26it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.15it/s] 84%|████████▎ | 107/128 [00:51<00:09,  2.17it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.19it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.08it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.09it/s] 87%|████████▋ | 111/128 [00:53<00:07,  2.13it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.13it/s] 88%|████████▊ | 113/128 [00:54<00:06,  2.21it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.18it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.10it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.05it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.07it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.16it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.23it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.20it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.21it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.21it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.19it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.20it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.11it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.05it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.00it/s]100%|██████████| 128/128 [01:01<00:00,  2.03it/s]100%|██████████| 128/128 [01:01<00:00,  2.08it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:07<00:14,  7.36s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:14<00:07,  7.41s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:21<00:00,  6.86s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:21<00:00,  7.01s/it]
[2024-01-18 07:12:27,581] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 67/128 [00:00<00:00, 666.66it/s]100%|██████████| 128/128 [00:00<00:00, 673.96it/s]
[2024-01-18 07:12:27,902] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.98it/s]  2%|▏         | 2/128 [00:00<00:56,  2.24it/s]  2%|▏         | 3/128 [00:01<00:59,  2.11it/s]  3%|▎         | 4/128 [00:01<01:00,  2.04it/s]  4%|▍         | 5/128 [00:02<00:59,  2.08it/s]  5%|▍         | 6/128 [00:02<00:59,  2.04it/s]  5%|▌         | 7/128 [00:03<00:58,  2.08it/s]  6%|▋         | 8/128 [00:03<00:56,  2.14it/s]  7%|▋         | 9/128 [00:04<00:54,  2.18it/s]  8%|▊         | 10/128 [00:04<00:56,  2.10it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:53,  2.16it/s] 10%|█         | 13/128 [00:06<00:54,  2.10it/s] 11%|█         | 14/128 [00:06<00:55,  2.06it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.12it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.06it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.04it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.98it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.06it/s] 16%|█▋        | 21/128 [00:10<00:49,  2.16it/s] 17%|█▋        | 22/128 [00:10<00:47,  2.24it/s] 18%|█▊        | 23/128 [00:10<00:47,  2.21it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.20it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.22it/s] 20%|██        | 26/128 [00:12<00:47,  2.14it/s] 21%|██        | 27/128 [00:12<00:47,  2.14it/s] 22%|██▏       | 28/128 [00:13<00:46,  2.14it/s] 23%|██▎       | 29/128 [00:13<00:45,  2.15it/s] 23%|██▎       | 30/128 [00:14<00:44,  2.19it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.04it/s] 26%|██▌       | 33/128 [00:15<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:16<00:47,  1.96it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.11it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.04it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.02it/s] 30%|███       | 39/128 [00:18<00:42,  2.09it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.02it/s] 32%|███▏      | 41/128 [00:19<00:46,  1.88it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.98it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.96it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.02it/s] 38%|███▊      | 49/128 [00:23<00:39,  1.99it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.13it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.08it/s] 41%|████      | 52/128 [00:25<00:37,  2.04it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.07it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.10it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.12it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.05it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.08it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.03it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.01it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.97it/s] 50%|█████     | 64/128 [00:31<00:31,  2.02it/s] 51%|█████     | 65/128 [00:31<00:31,  1.99it/s] 52%|█████▏    | 66/128 [00:31<00:29,  2.11it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.06it/s] 53%|█████▎    | 68/128 [00:32<00:27,  2.18it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.11it/s] 55%|█████▍    | 70/128 [00:33<00:28,  2.06it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.05it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.02it/s] 58%|█████▊    | 74/128 [00:35<00:25,  2.09it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.03it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:26,  1.94it/s] 61%|██████    | 78/128 [00:37<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.95it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.95it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.94it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.04it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.07it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:42<00:19,  2.04it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.07it/s] 70%|███████   | 90/128 [00:43<00:17,  2.12it/s] 71%|███████   | 91/128 [00:44<00:17,  2.13it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.05it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.07it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.03it/s] 74%|███████▍  | 95/128 [00:46<00:15,  2.09it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.02it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.06it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.10it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.11it/s] 80%|████████  | 103/128 [00:50<00:11,  2.15it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.09it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:51<00:11,  1.99it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.98it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.02it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.06it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.11it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.12it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.07it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.19it/s] 90%|████████▉ | 115/128 [00:55<00:05,  2.25it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.12it/s] 91%|█████████▏| 117/128 [00:56<00:04,  2.22it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.13it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.13it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.06it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.02it/s] 95%|█████████▌| 122/128 [00:59<00:03,  1.99it/s] 96%|█████████▌| 123/128 [00:59<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:00<00:02,  1.96it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.01it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.05it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.15it/s]100%|██████████| 128/128 [01:02<00:00,  2.08it/s]100%|██████████| 128/128 [01:02<00:00,  2.06it/s]
[2024-01-18 07:13:30,160] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.95it/s]  2%|▏         | 2/128 [00:00<00:57,  2.20it/s]  2%|▏         | 3/128 [00:01<01:00,  2.07it/s]  3%|▎         | 4/128 [00:01<01:01,  2.01it/s]  4%|▍         | 5/128 [00:02<00:59,  2.05it/s]  5%|▍         | 6/128 [00:02<01:00,  2.01it/s]  5%|▌         | 7/128 [00:03<00:59,  2.05it/s]  6%|▋         | 8/128 [00:03<00:56,  2.11it/s]  7%|▋         | 9/128 [00:04<00:55,  2.15it/s]  8%|▊         | 10/128 [00:04<00:56,  2.08it/s]  9%|▊         | 11/128 [00:05<00:55,  2.09it/s]  9%|▉         | 12/128 [00:05<00:54,  2.13it/s] 10%|█         | 13/128 [00:06<00:55,  2.07it/s] 11%|█         | 14/128 [00:06<00:56,  2.03it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.09it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.04it/s] 13%|█▎        | 17/128 [00:08<00:55,  2.01it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.97it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.96it/s] 16%|█▌        | 20/128 [00:09<00:53,  2.03it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.13it/s] 17%|█▋        | 22/128 [00:10<00:47,  2.21it/s] 18%|█▊        | 23/128 [00:11<00:48,  2.18it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.17it/s] 20%|█▉        | 25/128 [00:11<00:47,  2.19it/s] 20%|██        | 26/128 [00:12<00:48,  2.11it/s] 21%|██        | 27/128 [00:12<00:47,  2.11it/s] 22%|██▏       | 28/128 [00:13<00:47,  2.11it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.16it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.01it/s] 26%|██▌       | 33/128 [00:15<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:16<00:47,  1.94it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.08it/s] 29%|██▉       | 37/128 [00:17<00:45,  2.02it/s] 30%|██▉       | 38/128 [00:18<00:45,  2.00it/s] 30%|███       | 39/128 [00:18<00:43,  2.06it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.00it/s] 32%|███▏      | 41/128 [00:20<00:46,  1.85it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.96it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.92it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.91it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.91it/s] 38%|███▊      | 48/128 [00:23<00:40,  2.00it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.97it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.11it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.05it/s] 41%|████      | 52/128 [00:25<00:37,  2.01it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.05it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.08it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.10it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:27<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.03it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.06it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:29<00:33,  1.99it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.95it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:32,  1.95it/s] 51%|█████     | 65/128 [00:32<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.03it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.00it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.13it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.07it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:34<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.02it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.07it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.01it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.96it/s] 60%|██████    | 77/128 [00:37<00:26,  1.93it/s] 61%|██████    | 78/128 [00:38<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.94it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.02it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.06it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.00it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.04it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.06it/s] 70%|███████   | 90/128 [00:44<00:17,  2.11it/s] 71%|███████   | 91/128 [00:44<00:17,  2.12it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.07it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.03it/s] 74%|███████▍  | 95/128 [00:46<00:15,  2.09it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.01it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.06it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.09it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.10it/s] 80%|████████  | 103/128 [00:50<00:11,  2.14it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.08it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.03it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.01it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.05it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.10it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.11it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.03it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.06it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.18it/s] 90%|████████▉ | 115/128 [00:56<00:05,  2.24it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.10it/s] 91%|█████████▏| 117/128 [00:57<00:04,  2.21it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.12it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.12it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.05it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.01it/s] 95%|█████████▌| 122/128 [00:59<00:03,  1.98it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.97it/s] 97%|█████████▋| 124/128 [01:00<00:02,  1.95it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.00it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.04it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.14it/s]100%|██████████| 128/128 [01:02<00:00,  2.07it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.19s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.14s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.98s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.76s/it]
[2024-01-18 07:15:27,011] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 41%|████▏     | 53/128 [00:00<00:00, 524.43it/s] 97%|█████████▋| 124/128 [00:00<00:00, 629.56it/s]100%|██████████| 128/128 [00:00<00:00, 614.55it/s]
[2024-01-18 07:15:27,354] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:51,  2.46it/s]  2%|▏         | 2/128 [00:00<00:58,  2.14it/s]  2%|▏         | 3/128 [00:01<00:55,  2.27it/s]  3%|▎         | 4/128 [00:01<00:57,  2.14it/s]  4%|▍         | 5/128 [00:02<00:59,  2.06it/s]  5%|▍         | 6/128 [00:02<00:58,  2.10it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<00:56,  2.11it/s]  7%|▋         | 9/128 [00:04<00:55,  2.16it/s]  8%|▊         | 10/128 [00:04<00:54,  2.16it/s]  9%|▊         | 11/128 [00:05<00:54,  2.16it/s]  9%|▉         | 12/128 [00:05<00:53,  2.16it/s] 10%|█         | 13/128 [00:06<00:53,  2.16it/s] 11%|█         | 14/128 [00:06<00:54,  2.09it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.05it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:55,  1.99it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.04it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.15it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.11it/s] 18%|█▊        | 23/128 [00:10<00:50,  2.07it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:11<00:47,  2.15it/s] 20%|██        | 26/128 [00:12<00:48,  2.09it/s] 21%|██        | 27/128 [00:12<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:44,  2.21it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.12it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.06it/s] 26%|██▌       | 33/128 [00:15<00:47,  2.01it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.05it/s] 27%|██▋       | 35/128 [00:16<00:43,  2.15it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.19it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.11it/s] 30%|██▉       | 38/128 [00:18<00:42,  2.13it/s] 30%|███       | 39/128 [00:18<00:43,  2.07it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.10it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.03it/s] 33%|███▎      | 42/128 [00:20<00:41,  2.07it/s] 34%|███▎      | 43/128 [00:20<00:40,  2.10it/s] 34%|███▍      | 44/128 [00:20<00:39,  2.11it/s] 35%|███▌      | 45/128 [00:21<00:40,  2.06it/s] 36%|███▌      | 46/128 [00:22<00:40,  2.01it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.97it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.02it/s] 38%|███▊      | 49/128 [00:23<00:37,  2.09it/s] 39%|███▉      | 50/128 [00:23<00:35,  2.18it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.11it/s] 41%|████      | 52/128 [00:24<00:36,  2.06it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.03it/s] 42%|████▏     | 54/128 [00:25<00:35,  2.07it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.20it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.09it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.05it/s] 45%|████▌     | 58/128 [00:27<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:28<00:32,  2.13it/s] 47%|████▋     | 60/128 [00:28<00:31,  2.13it/s] 48%|████▊     | 61/128 [00:29<00:31,  2.14it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.06it/s] 49%|████▉     | 63/128 [00:30<00:32,  2.03it/s] 50%|█████     | 64/128 [00:30<00:31,  2.00it/s] 51%|█████     | 65/128 [00:31<00:30,  2.05it/s] 52%|█████▏    | 66/128 [00:31<00:29,  2.11it/s] 52%|█████▏    | 67/128 [00:32<00:28,  2.12it/s] 53%|█████▎    | 68/128 [00:32<00:27,  2.16it/s] 54%|█████▍    | 69/128 [00:32<00:27,  2.16it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.09it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.02it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.00it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.96it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.01it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.94it/s] 60%|██████    | 77/128 [00:37<00:26,  1.95it/s] 61%|██████    | 78/128 [00:37<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.99it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.01it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.05it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:42<00:20,  1.98it/s] 70%|██████▉   | 89/128 [00:43<00:19,  1.97it/s] 70%|███████   | 90/128 [00:43<00:18,  2.02it/s] 71%|███████   | 91/128 [00:44<00:17,  2.13it/s] 72%|███████▏  | 92/128 [00:44<00:16,  2.13it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.07it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.09it/s] 74%|███████▍  | 95/128 [00:45<00:16,  2.05it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.01it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.03it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.06it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:48<00:12,  2.18it/s] 80%|███████▉  | 102/128 [00:49<00:11,  2.20it/s] 80%|████████  | 103/128 [00:49<00:11,  2.18it/s] 81%|████████▏ | 104/128 [00:50<00:10,  2.25it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.15it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.09it/s] 84%|████████▎ | 107/128 [00:51<00:10,  2.04it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.01it/s] 85%|████████▌ | 109/128 [00:52<00:09,  1.99it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.06it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.00it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:55<00:07,  1.99it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.03it/s] 92%|█████████▏| 118/128 [00:57<00:05,  2.00it/s] 93%|█████████▎| 119/128 [00:57<00:04,  1.98it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.02it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.13it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.16it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.09it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.13it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.13it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.16it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.19it/s]100%|██████████| 128/128 [01:01<00:00,  2.17it/s]100%|██████████| 128/128 [01:01<00:00,  2.07it/s]
[2024-01-18 07:16:29,161] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:52,  2.42it/s]  2%|▏         | 2/128 [00:00<00:59,  2.11it/s]  2%|▏         | 3/128 [00:01<00:57,  2.18it/s]  3%|▎         | 4/128 [00:01<00:59,  2.08it/s]  4%|▍         | 5/128 [00:02<01:01,  2.02it/s]  5%|▍         | 6/128 [00:02<00:59,  2.05it/s]  5%|▌         | 7/128 [00:03<01:00,  2.00it/s]  6%|▋         | 8/128 [00:03<00:57,  2.07it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:56,  2.11it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:54,  2.12it/s] 10%|█         | 13/128 [00:06<00:54,  2.12it/s] 11%|█         | 14/128 [00:06<00:55,  2.06it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.02it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.99it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.96it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.93it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.02it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.12it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.06it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.09it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.04it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.07it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.12it/s] 20%|██        | 26/128 [00:12<00:49,  2.06it/s] 21%|██        | 27/128 [00:13<00:49,  2.02it/s] 22%|██▏       | 28/128 [00:13<00:50,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:44,  2.18it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.05it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.03it/s] 27%|██▋       | 35/128 [00:16<00:43,  2.13it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.16it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.09it/s] 30%|██▉       | 38/128 [00:18<00:42,  2.11it/s] 30%|███       | 39/128 [00:18<00:43,  2.05it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.07it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.04it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.07it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.09it/s] 35%|███▌      | 45/128 [00:21<00:40,  2.04it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:23<00:40,  2.00it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.06it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.15it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.08it/s] 41%|████      | 52/128 [00:25<00:37,  2.04it/s] 41%|████▏     | 53/128 [00:25<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.05it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.17it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.07it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.03it/s] 45%|████▌     | 58/128 [00:28<00:35,  2.00it/s] 46%|████▌     | 59/128 [00:28<00:32,  2.10it/s] 47%|████▋     | 60/128 [00:29<00:32,  2.11it/s] 48%|████▊     | 61/128 [00:29<00:31,  2.11it/s] 48%|████▊     | 62/128 [00:30<00:32,  2.03it/s] 49%|████▉     | 63/128 [00:30<00:32,  2.00it/s] 50%|█████     | 64/128 [00:31<00:32,  1.98it/s] 51%|█████     | 65/128 [00:31<00:31,  2.03it/s] 52%|█████▏    | 66/128 [00:32<00:29,  2.08it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.10it/s] 53%|█████▎    | 68/128 [00:32<00:28,  2.14it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.13it/s] 55%|█████▍    | 70/128 [00:33<00:28,  2.07it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:34<00:28,  1.98it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.94it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:36<00:27,  1.96it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.93it/s] 60%|██████    | 77/128 [00:37<00:26,  1.93it/s] 61%|██████    | 78/128 [00:38<00:26,  1.91it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:41<00:21,  1.99it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.00it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:43<00:19,  1.96it/s] 70%|███████   | 90/128 [00:44<00:18,  2.01it/s] 71%|███████   | 91/128 [00:44<00:17,  2.12it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.12it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.05it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.08it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.04it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.00it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.97it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.05it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.07it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.17it/s] 80%|███████▉  | 102/128 [00:49<00:11,  2.19it/s] 80%|████████  | 103/128 [00:50<00:11,  2.17it/s] 81%|████████▏ | 104/128 [00:50<00:10,  2.24it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.14it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.08it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.03it/s] 84%|████████▍ | 108/128 [00:52<00:10,  2.00it/s] 85%|████████▌ | 109/128 [00:53<00:09,  1.98it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.05it/s] 87%|████████▋ | 111/128 [00:54<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.03it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:55<00:07,  1.99it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.01it/s] 92%|█████████▏| 118/128 [00:57<00:05,  1.99it/s] 93%|█████████▎| 119/128 [00:58<00:04,  1.97it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.01it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.12it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.15it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.07it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.12it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.12it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.15it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.18it/s]100%|██████████| 128/128 [01:02<00:00,  2.16it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:07<00:14,  7.28s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:11<00:05,  5.53s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.88s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.96s/it]
[2024-01-18 07:18:29,060] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 54%|█████▍    | 69/128 [00:00<00:00, 689.01it/s]100%|██████████| 128/128 [00:00<00:00, 680.33it/s]
[2024-01-18 07:18:29,376] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:57,  2.20it/s]  2%|▏         | 2/128 [00:00<01:01,  2.06it/s]  2%|▏         | 3/128 [00:01<01:02,  2.01it/s]  3%|▎         | 4/128 [00:01<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<00:57,  2.14it/s]  5%|▍         | 6/128 [00:02<00:58,  2.07it/s]  5%|▌         | 7/128 [00:03<00:57,  2.10it/s]  6%|▋         | 8/128 [00:03<00:58,  2.05it/s]  7%|▋         | 9/128 [00:04<00:54,  2.17it/s]  8%|▊         | 10/128 [00:04<00:56,  2.10it/s]  9%|▊         | 11/128 [00:05<00:53,  2.19it/s]  9%|▉         | 12/128 [00:05<00:53,  2.19it/s] 10%|█         | 13/128 [00:06<00:54,  2.11it/s] 11%|█         | 14/128 [00:06<00:55,  2.07it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.13it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.14it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.09it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.04it/s] 15%|█▍        | 19/128 [00:09<00:51,  2.10it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.15it/s] 16%|█▋        | 21/128 [00:09<00:49,  2.15it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.19it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.11it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.20it/s] 20%|█▉        | 25/128 [00:11<00:45,  2.27it/s] 20%|██        | 26/128 [00:12<00:47,  2.17it/s] 21%|██        | 27/128 [00:12<00:48,  2.08it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.04it/s] 23%|██▎       | 29/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.08it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.13it/s] 25%|██▌       | 32/128 [00:15<00:44,  2.14it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.05it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.03it/s] 27%|██▋       | 35/128 [00:16<00:46,  1.98it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.03it/s] 29%|██▉       | 37/128 [00:17<00:42,  2.14it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.06it/s] 30%|███       | 39/128 [00:18<00:43,  2.03it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.00it/s] 32%|███▏      | 41/128 [00:19<00:44,  1.97it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.94it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.03it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.99it/s] 35%|███▌      | 45/128 [00:21<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.97it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.03it/s] 38%|███▊      | 49/128 [00:23<00:39,  2.00it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.05it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.07it/s] 41%|████      | 52/128 [00:25<00:36,  2.10it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.05it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.09it/s] 44%|████▍     | 56/128 [00:26<00:33,  2.14it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.08it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.04it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.01it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.94it/s] 50%|█████     | 64/128 [00:31<00:34,  1.83it/s] 51%|█████     | 65/128 [00:31<00:32,  1.91it/s] 52%|█████▏    | 66/128 [00:32<00:32,  1.92it/s] 52%|█████▏    | 67/128 [00:32<00:30,  1.99it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.97it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.11it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.04it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:35<00:29,  1.87it/s] 57%|█████▋    | 73/128 [00:35<00:29,  1.89it/s] 58%|█████▊    | 74/128 [00:36<00:28,  1.88it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.02it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:26,  1.95it/s] 61%|██████    | 78/128 [00:38<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:38<00:24,  2.00it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.96it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.96it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.95it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.95it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.07it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.04it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.07it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.98it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.03it/s] 70%|███████   | 90/128 [00:44<00:18,  2.09it/s] 71%|███████   | 91/128 [00:44<00:17,  2.14it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.07it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.01it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.99it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.97it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.95it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.94it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.95it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.07it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.03it/s] 80%|███████▉  | 102/128 [00:50<00:13,  2.00it/s] 80%|████████  | 103/128 [00:50<00:12,  2.06it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.16it/s] 82%|████████▏ | 105/128 [00:51<00:11,  1.95it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.93it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.05it/s] 85%|████████▌ | 109/128 [00:53<00:08,  2.15it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.18it/s] 87%|████████▋ | 111/128 [00:54<00:07,  2.16it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.10it/s] 88%|████████▊ | 113/128 [00:55<00:06,  2.19it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:56<00:05,  2.18it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.14it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.08it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.12it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.12it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.06it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.08it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.04it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.07it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.12it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.06it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.08it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 07:19:31,991] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.15it/s]  2%|▏         | 2/128 [00:00<01:02,  2.02it/s]  2%|▏         | 3/128 [00:01<01:03,  1.98it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<00:58,  2.10it/s]  5%|▍         | 6/128 [00:02<00:59,  2.04it/s]  5%|▌         | 7/128 [00:03<00:58,  2.07it/s]  6%|▋         | 8/128 [00:03<00:59,  2.02it/s]  7%|▋         | 9/128 [00:04<00:55,  2.13it/s]  8%|▊         | 10/128 [00:04<00:57,  2.07it/s]  9%|▊         | 11/128 [00:05<00:54,  2.16it/s]  9%|▉         | 12/128 [00:05<00:53,  2.15it/s] 10%|█         | 13/128 [00:06<00:55,  2.08it/s] 11%|█         | 14/128 [00:06<00:55,  2.04it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.09it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.11it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.06it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.01it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.05it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.15it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.07it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.16it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.23it/s] 20%|██        | 26/128 [00:12<00:47,  2.14it/s] 21%|██        | 27/128 [00:12<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:13<00:49,  1.99it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.05it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.10it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.04it/s] 26%|██▌       | 33/128 [00:15<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.97it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.94it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.99it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.10it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.03it/s] 30%|███       | 39/128 [00:18<00:44,  2.00it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.98it/s] 32%|███▏      | 41/128 [00:19<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.92it/s] 34%|███▎      | 43/128 [00:20<00:42,  2.00it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.92it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.00it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.05it/s] 41%|████      | 52/128 [00:25<00:36,  2.07it/s] 41%|████▏     | 53/128 [00:25<00:37,  2.03it/s] 42%|████▏     | 54/128 [00:26<00:37,  2.00it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.06it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.11it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.05it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:28<00:34,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:29<00:33,  1.98it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.95it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.92it/s] 50%|█████     | 64/128 [00:31<00:35,  1.81it/s] 51%|█████     | 65/128 [00:32<00:33,  1.89it/s] 52%|█████▏    | 66/128 [00:32<00:32,  1.89it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.95it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.94it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.08it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.01it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:35<00:30,  1.84it/s] 57%|█████▋    | 73/128 [00:36<00:29,  1.86it/s] 58%|█████▊    | 74/128 [00:36<00:29,  1.85it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.99it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.95it/s] 60%|██████    | 77/128 [00:38<00:26,  1.92it/s] 61%|██████    | 78/128 [00:38<00:26,  1.92it/s] 62%|██████▏   | 79/128 [00:39<00:24,  1.97it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.05it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.01it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.01it/s] 70%|███████   | 90/128 [00:44<00:18,  2.07it/s] 71%|███████   | 91/128 [00:45<00:17,  2.11it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.01it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.99it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.92it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.92it/s] 77%|███████▋  | 99/128 [00:49<00:15,  1.92it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:50<00:13,  1.97it/s] 80%|████████  | 103/128 [00:51<00:12,  2.04it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.13it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:53<00:11,  1.90it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.03it/s] 85%|████████▌ | 109/128 [00:54<00:08,  2.13it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.15it/s] 87%|████████▋ | 111/128 [00:55<00:07,  2.14it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:56<00:06,  2.16it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.15it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.11it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.05it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.10it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.10it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.04it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.06it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.05it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.10it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.04it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.06it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.17s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.15s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.95s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.73s/it]
[2024-01-18 07:21:29,677] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 41%|████      | 52/128 [00:00<00:00, 518.56it/s] 94%|█████████▍| 120/128 [00:00<00:00, 613.23it/s]100%|██████████| 128/128 [00:00<00:00, 602.59it/s]
[2024-01-18 07:21:30,026] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:51,  2.46it/s]  2%|▏         | 2/128 [00:00<00:55,  2.28it/s]  2%|▏         | 3/128 [00:01<00:58,  2.12it/s]  3%|▎         | 4/128 [00:01<01:00,  2.06it/s]  4%|▍         | 5/128 [00:02<01:01,  2.01it/s]  5%|▍         | 6/128 [00:02<01:02,  1.97it/s]  5%|▌         | 7/128 [00:03<00:59,  2.02it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:54,  2.19it/s]  8%|▊         | 10/128 [00:04<00:54,  2.18it/s]  9%|▊         | 11/128 [00:05<00:55,  2.09it/s]  9%|▉         | 12/128 [00:05<00:56,  2.06it/s] 10%|█         | 13/128 [00:06<00:55,  2.08it/s] 11%|█         | 14/128 [00:06<00:55,  2.05it/s] 12%|█▏        | 15/128 [00:07<00:56,  1.99it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.98it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.96it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.95it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.08it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.10it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.05it/s] 17%|█▋        | 22/128 [00:10<00:52,  2.01it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.00it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.11it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:47,  2.16it/s] 21%|██        | 27/128 [00:13<00:48,  2.10it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.05it/s] 23%|██▎       | 29/128 [00:13<00:45,  2.15it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.09it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  2.00it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.06it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.11it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:17<00:45,  2.01it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.08it/s] 30%|███       | 39/128 [00:18<00:43,  2.02it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.00it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.07it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.04it/s] 34%|███▎      | 43/128 [00:20<00:42,  2.00it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.94it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.06it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.08it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.18it/s] 41%|████      | 52/128 [00:25<00:36,  2.09it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.99it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.03it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.00it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.04it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.00it/s] 46%|████▌     | 59/128 [00:28<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.06it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.02it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.99it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.98it/s] 50%|█████     | 64/128 [00:31<00:32,  1.95it/s] 51%|█████     | 65/128 [00:31<00:30,  2.03it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.00it/s] 52%|█████▏    | 67/128 [00:32<00:30,  1.98it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.97it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.05it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.99it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.03it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.98it/s] 57%|█████▋    | 73/128 [00:35<00:27,  1.97it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.02it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.95it/s] 60%|██████    | 77/128 [00:37<00:26,  1.94it/s] 61%|██████    | 78/128 [00:38<00:25,  1.92it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.96it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.95it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.95it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.03it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.99it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.98it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.01it/s] 70%|███████   | 90/128 [00:44<00:19,  1.98it/s] 71%|███████   | 91/128 [00:45<00:18,  1.96it/s] 72%|███████▏  | 92/128 [00:45<00:18,  1.95it/s] 73%|███████▎  | 93/128 [00:46<00:18,  1.93it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.93it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.91it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.92it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.92it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.04it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.08it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.09it/s] 80%|████████  | 103/128 [00:51<00:11,  2.10it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.04it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.00it/s] 83%|████████▎ | 106/128 [00:52<00:10,  2.04it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.11it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.05it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:55<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.02it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:57<00:06,  1.98it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.02it/s] 92%|█████████▏| 118/128 [00:58<00:05,  1.99it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.03it/s] 94%|█████████▍| 120/128 [00:59<00:04,  1.99it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.97it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.95it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.96it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.98it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
[2024-01-18 07:22:33,515] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:52,  2.40it/s]  2%|▏         | 2/128 [00:00<00:56,  2.23it/s]  2%|▏         | 3/128 [00:01<01:00,  2.08it/s]  3%|▎         | 4/128 [00:01<01:01,  2.02it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:02<01:03,  1.93it/s]  5%|▌         | 7/128 [00:03<01:00,  1.98it/s]  6%|▋         | 8/128 [00:03<00:58,  2.05it/s]  7%|▋         | 9/128 [00:04<00:55,  2.15it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:56,  2.06it/s]  9%|▉         | 12/128 [00:05<00:57,  2.02it/s] 10%|█         | 13/128 [00:06<00:56,  2.04it/s] 11%|█         | 14/128 [00:06<00:56,  2.01it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.96it/s] 12%|█▎        | 16/128 [00:07<00:57,  1.94it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.92it/s] 14%|█▍        | 18/128 [00:08<00:57,  1.92it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.04it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.06it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.01it/s] 17%|█▋        | 22/128 [00:10<00:53,  1.98it/s] 18%|█▊        | 23/128 [00:11<00:53,  1.97it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.08it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.03it/s] 20%|██        | 26/128 [00:12<00:47,  2.13it/s] 21%|██        | 27/128 [00:13<00:49,  2.06it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.06it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.97it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.03it/s] 27%|██▋       | 35/128 [00:17<00:44,  2.08it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.02it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.98it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.05it/s] 30%|███       | 39/128 [00:19<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:42,  2.03it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.00it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.91it/s] 36%|███▌      | 46/128 [00:22<00:43,  1.90it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.89it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.02it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.05it/s] 40%|███▉      | 51/128 [00:25<00:35,  2.14it/s] 41%|████      | 52/128 [00:25<00:36,  2.06it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.96it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.01it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.98it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.03it/s] 48%|████▊     | 61/128 [00:30<00:33,  1.99it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.96it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:31,  2.01it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.95it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.03it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.96it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.95it/s] 58%|█████▊    | 74/128 [00:36<00:27,  2.00it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.95it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.93it/s] 60%|██████    | 77/128 [00:38<00:26,  1.93it/s] 61%|██████    | 78/128 [00:39<00:26,  1.90it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.88it/s] 63%|██████▎   | 81/128 [00:40<00:25,  1.87it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.94it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.93it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.01it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.97it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.94it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.99it/s] 70%|███████   | 90/128 [00:45<00:19,  1.96it/s] 71%|███████   | 91/128 [00:45<00:19,  1.94it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.94it/s] 73%|███████▎  | 93/128 [00:46<00:18,  1.91it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.92it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.90it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.90it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.91it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.99it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.06it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.07it/s] 80%|████████  | 103/128 [00:51<00:11,  2.09it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.04it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.00it/s] 83%|████████▎ | 106/128 [00:53<00:10,  2.03it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.99it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.10it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.04it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.04it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.98it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.00it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.97it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.01it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.96it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.01it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.97it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.95it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.94it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:02<00:02,  1.96it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.94it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:04<00:00,  2.01it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:07<00:14,  7.07s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:14<00:07,  7.20s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:20<00:00,  6.65s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:20<00:00,  6.78s/it]
[2024-01-18 07:24:38,202] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 66/128 [00:00<00:00, 653.76it/s]100%|██████████| 128/128 [00:00<00:00, 664.68it/s]
[2024-01-18 07:24:38,526] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.97it/s]  2%|▏         | 2/128 [00:00<01:00,  2.08it/s]  2%|▏         | 3/128 [00:01<01:03,  1.98it/s]  3%|▎         | 4/128 [00:02<01:02,  1.98it/s]  4%|▍         | 5/128 [00:02<01:00,  2.04it/s]  5%|▍         | 6/128 [00:03<01:05,  1.87it/s]  5%|▌         | 7/128 [00:03<01:07,  1.78it/s]  6%|▋         | 8/128 [00:04<01:02,  1.91it/s]  7%|▋         | 9/128 [00:04<00:59,  2.01it/s]  8%|▊         | 10/128 [00:05<00:59,  1.98it/s]  9%|▊         | 11/128 [00:05<00:59,  1.97it/s]  9%|▉         | 12/128 [00:06<00:58,  1.97it/s] 10%|█         | 13/128 [00:06<00:59,  1.94it/s] 11%|█         | 14/128 [00:07<00:59,  1.93it/s] 12%|█▏        | 15/128 [00:07<00:59,  1.91it/s] 12%|█▎        | 16/128 [00:08<00:58,  1.90it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.90it/s] 14%|█▍        | 18/128 [00:09<00:55,  1.97it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.02it/s] 16%|█▌        | 20/128 [00:10<00:50,  2.13it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.07it/s] 17%|█▋        | 22/128 [00:11<00:52,  2.01it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.08it/s] 19%|█▉        | 24/128 [00:12<00:51,  2.03it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.07it/s] 20%|██        | 26/128 [00:13<00:50,  2.01it/s] 21%|██        | 27/128 [00:13<00:50,  1.98it/s] 22%|██▏       | 28/128 [00:14<00:51,  1.96it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.95it/s] 23%|██▎       | 30/128 [00:15<00:48,  2.03it/s] 24%|██▍       | 31/128 [00:15<00:48,  1.99it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.96it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.93it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.06it/s] 28%|██▊       | 36/128 [00:18<00:48,  1.89it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.91it/s] 30%|██▉       | 38/128 [00:19<00:47,  1.91it/s] 30%|███       | 39/128 [00:19<00:46,  1.92it/s] 31%|███▏      | 40/128 [00:20<00:48,  1.81it/s] 32%|███▏      | 41/128 [00:20<00:47,  1.85it/s] 33%|███▎      | 42/128 [00:21<00:46,  1.86it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.93it/s] 34%|███▍      | 44/128 [00:22<00:46,  1.83it/s] 35%|███▌      | 45/128 [00:23<00:45,  1.84it/s] 36%|███▌      | 46/128 [00:23<00:44,  1.86it/s] 37%|███▋      | 47/128 [00:24<00:43,  1.88it/s] 38%|███▊      | 48/128 [00:24<00:42,  1.89it/s] 38%|███▊      | 49/128 [00:25<00:41,  1.91it/s] 39%|███▉      | 50/128 [00:25<00:40,  1.91it/s] 40%|███▉      | 51/128 [00:26<00:40,  1.92it/s] 41%|████      | 52/128 [00:26<00:39,  1.92it/s] 41%|████▏     | 53/128 [00:27<00:38,  1.93it/s] 42%|████▏     | 54/128 [00:27<00:38,  1.94it/s] 43%|████▎     | 55/128 [00:28<00:36,  2.02it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.99it/s] 45%|████▍     | 57/128 [00:29<00:34,  2.03it/s] 45%|████▌     | 58/128 [00:29<00:35,  2.00it/s] 46%|████▌     | 59/128 [00:30<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:30<00:36,  1.84it/s] 48%|████▊     | 61/128 [00:31<00:36,  1.85it/s] 48%|████▊     | 62/128 [00:31<00:35,  1.87it/s] 49%|████▉     | 63/128 [00:32<00:34,  1.88it/s] 50%|█████     | 64/128 [00:33<00:34,  1.88it/s] 51%|█████     | 65/128 [00:33<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:33<00:30,  2.00it/s] 52%|█████▏    | 67/128 [00:34<00:32,  1.87it/s] 53%|█████▎    | 68/128 [00:35<00:30,  1.94it/s] 54%|█████▍    | 69/128 [00:35<00:32,  1.83it/s] 55%|█████▍    | 70/128 [00:36<00:31,  1.85it/s] 55%|█████▌    | 71/128 [00:36<00:30,  1.87it/s] 56%|█████▋    | 72/128 [00:37<00:27,  2.03it/s] 57%|█████▋    | 73/128 [00:37<00:29,  1.88it/s] 58%|█████▊    | 74/128 [00:38<00:28,  1.88it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.87it/s] 59%|█████▉    | 76/128 [00:39<00:27,  1.87it/s] 60%|██████    | 77/128 [00:39<00:27,  1.87it/s] 61%|██████    | 78/128 [00:40<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:41<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:42<00:23,  1.98it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.94it/s] 66%|██████▌   | 84/128 [00:43<00:22,  1.93it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.99it/s] 67%|██████▋   | 86/128 [00:44<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:44<00:19,  2.06it/s] 69%|██████▉   | 88/128 [00:45<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.03it/s] 70%|███████   | 90/128 [00:46<00:19,  1.97it/s] 71%|███████   | 91/128 [00:46<00:18,  1.96it/s] 72%|███████▏  | 92/128 [00:47<00:19,  1.84it/s] 73%|███████▎  | 93/128 [00:48<00:18,  1.86it/s] 73%|███████▎  | 94/128 [00:48<00:18,  1.88it/s] 74%|███████▍  | 95/128 [00:49<00:17,  1.89it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.99it/s] 76%|███████▌  | 97/128 [00:50<00:15,  1.97it/s] 77%|███████▋  | 98/128 [00:50<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:51<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:51<00:14,  1.98it/s] 79%|███████▉  | 101/128 [00:52<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:52<00:13,  1.96it/s] 80%|████████  | 103/128 [00:53<00:12,  1.95it/s] 81%|████████▏ | 104/128 [00:53<00:12,  1.93it/s] 82%|████████▏ | 105/128 [00:54<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:54<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:55<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:55<00:09,  2.04it/s] 85%|████████▌ | 109/128 [00:56<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:56<00:09,  1.97it/s] 87%|████████▋ | 111/128 [00:57<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:57<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:58<00:07,  1.97it/s] 89%|████████▉ | 114/128 [00:58<00:07,  1.96it/s] 90%|████████▉ | 115/128 [00:59<00:06,  1.95it/s] 91%|█████████ | 116/128 [00:59<00:06,  1.94it/s] 91%|█████████▏| 117/128 [01:00<00:05,  1.94it/s] 92%|█████████▏| 118/128 [01:00<00:05,  1.94it/s] 93%|█████████▎| 119/128 [01:01<00:04,  2.01it/s] 94%|█████████▍| 120/128 [01:01<00:04,  1.99it/s] 95%|█████████▍| 121/128 [01:02<00:03,  1.97it/s] 95%|█████████▌| 122/128 [01:02<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:03<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:03<00:02,  1.95it/s] 98%|█████████▊| 125/128 [01:04<00:01,  1.95it/s] 98%|█████████▊| 126/128 [01:04<00:01,  1.92it/s] 99%|█████████▉| 127/128 [01:05<00:00,  1.92it/s]100%|██████████| 128/128 [01:05<00:00,  1.91it/s]100%|██████████| 128/128 [01:05<00:00,  1.94it/s]
[2024-01-18 07:25:44,405] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.93it/s]  2%|▏         | 2/128 [00:00<01:01,  2.04it/s]  2%|▏         | 3/128 [00:01<01:04,  1.95it/s]  3%|▎         | 4/128 [00:02<01:03,  1.95it/s]  4%|▍         | 5/128 [00:02<01:03,  1.94it/s]  5%|▍         | 6/128 [00:03<01:07,  1.81it/s]  5%|▌         | 7/128 [00:03<01:09,  1.73it/s]  6%|▋         | 8/128 [00:04<01:04,  1.87it/s]  7%|▋         | 9/128 [00:04<01:00,  1.96it/s]  8%|▊         | 10/128 [00:05<01:00,  1.95it/s]  9%|▊         | 11/128 [00:05<01:00,  1.93it/s]  9%|▉         | 12/128 [00:06<00:59,  1.93it/s] 10%|█         | 13/128 [00:06<01:00,  1.91it/s] 11%|█         | 14/128 [00:07<00:59,  1.90it/s] 12%|█▏        | 15/128 [00:07<01:00,  1.88it/s] 12%|█▎        | 16/128 [00:08<00:59,  1.88it/s] 13%|█▎        | 17/128 [00:08<00:59,  1.88it/s] 14%|█▍        | 18/128 [00:09<00:56,  1.94it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.00it/s] 16%|█▌        | 20/128 [00:10<00:51,  2.10it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.05it/s] 17%|█▋        | 22/128 [00:11<00:53,  1.99it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.06it/s] 19%|█▉        | 24/128 [00:12<00:51,  2.01it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.04it/s] 20%|██        | 26/128 [00:13<00:51,  1.99it/s] 21%|██        | 27/128 [00:13<00:51,  1.96it/s] 22%|██▏       | 28/128 [00:14<00:51,  1.94it/s] 23%|██▎       | 29/128 [00:14<00:51,  1.93it/s] 23%|██▎       | 30/128 [00:15<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.97it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.94it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.92it/s] 27%|██▋       | 34/128 [00:17<00:49,  1.91it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:18<00:49,  1.87it/s] 29%|██▉       | 37/128 [00:19<00:48,  1.89it/s] 30%|██▉       | 38/128 [00:19<00:47,  1.90it/s] 30%|███       | 39/128 [00:20<00:46,  1.91it/s] 31%|███▏      | 40/128 [00:20<00:48,  1.80it/s] 32%|███▏      | 41/128 [00:21<00:47,  1.83it/s] 33%|███▎      | 42/128 [00:21<00:46,  1.85it/s] 34%|███▎      | 43/128 [00:22<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:22<00:46,  1.81it/s] 35%|███▌      | 45/128 [00:23<00:45,  1.82it/s] 36%|███▌      | 46/128 [00:23<00:44,  1.85it/s] 37%|███▋      | 47/128 [00:24<00:43,  1.87it/s] 38%|███▊      | 48/128 [00:24<00:42,  1.88it/s] 38%|███▊      | 49/128 [00:25<00:41,  1.89it/s] 39%|███▉      | 50/128 [00:26<00:40,  1.90it/s] 40%|███▉      | 51/128 [00:26<00:40,  1.92it/s] 41%|████      | 52/128 [00:27<00:39,  1.92it/s] 41%|████▏     | 53/128 [00:27<00:38,  1.93it/s] 42%|████▏     | 54/128 [00:28<00:38,  1.93it/s] 43%|████▎     | 55/128 [00:28<00:36,  2.01it/s] 44%|████▍     | 56/128 [00:29<00:36,  1.98it/s] 45%|████▍     | 57/128 [00:29<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:30<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:30<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:31<00:37,  1.83it/s] 48%|████▊     | 61/128 [00:31<00:36,  1.84it/s] 48%|████▊     | 62/128 [00:32<00:35,  1.86it/s] 49%|████▉     | 63/128 [00:32<00:34,  1.88it/s] 50%|█████     | 64/128 [00:33<00:34,  1.87it/s] 51%|█████     | 65/128 [00:33<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:34<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:34<00:32,  1.86it/s] 53%|█████▎    | 68/128 [00:35<00:31,  1.93it/s] 54%|█████▍    | 69/128 [00:36<00:32,  1.82it/s] 55%|█████▍    | 70/128 [00:36<00:31,  1.84it/s] 55%|█████▌    | 71/128 [00:37<00:30,  1.86it/s] 56%|█████▋    | 72/128 [00:37<00:27,  2.01it/s] 57%|█████▋    | 73/128 [00:38<00:29,  1.86it/s] 58%|█████▊    | 74/128 [00:38<00:28,  1.86it/s] 59%|█████▊    | 75/128 [00:39<00:28,  1.86it/s] 59%|█████▉    | 76/128 [00:39<00:27,  1.86it/s] 60%|██████    | 77/128 [00:40<00:27,  1.87it/s] 61%|██████    | 78/128 [00:40<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:41<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:41<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:42<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:42<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:43<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:43<00:22,  1.93it/s] 66%|██████▋   | 85/128 [00:44<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:44<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:45<00:19,  2.06it/s] 69%|██████▉   | 88/128 [00:45<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:46<00:19,  2.03it/s] 70%|███████   | 90/128 [00:46<00:19,  1.97it/s] 71%|███████   | 91/128 [00:47<00:18,  1.95it/s] 72%|███████▏  | 92/128 [00:47<00:19,  1.83it/s] 73%|███████▎  | 93/128 [00:48<00:18,  1.85it/s] 73%|███████▎  | 94/128 [00:48<00:18,  1.87it/s] 74%|███████▍  | 95/128 [00:49<00:17,  1.89it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.98it/s] 76%|███████▌  | 97/128 [00:50<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:50<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:51<00:14,  1.98it/s] 78%|███████▊  | 100/128 [00:51<00:14,  1.97it/s] 79%|███████▉  | 101/128 [00:52<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:53<00:13,  1.96it/s] 80%|████████  | 103/128 [00:53<00:12,  1.94it/s] 81%|████████▏ | 104/128 [00:54<00:12,  1.92it/s] 82%|████████▏ | 105/128 [00:54<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:55<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:55<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:56<00:09,  2.04it/s] 85%|████████▌ | 109/128 [00:56<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:57<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:57<00:08,  2.02it/s] 88%|████████▊ | 112/128 [00:58<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:58<00:07,  1.97it/s] 89%|████████▉ | 114/128 [00:59<00:07,  1.96it/s] 90%|████████▉ | 115/128 [00:59<00:06,  1.95it/s] 91%|█████████ | 116/128 [01:00<00:06,  1.93it/s] 91%|█████████▏| 117/128 [01:00<00:05,  1.94it/s] 92%|█████████▏| 118/128 [01:01<00:05,  1.93it/s] 93%|█████████▎| 119/128 [01:01<00:04,  2.01it/s] 94%|█████████▍| 120/128 [01:02<00:04,  1.98it/s] 95%|█████████▍| 121/128 [01:02<00:03,  1.96it/s] 95%|█████████▌| 122/128 [01:03<00:02,  2.01it/s] 96%|█████████▌| 123/128 [01:03<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:04<00:02,  1.95it/s] 98%|█████████▊| 125/128 [01:04<00:01,  1.94it/s] 98%|█████████▊| 126/128 [01:05<00:01,  1.91it/s] 99%|█████████▉| 127/128 [01:05<00:00,  1.92it/s]100%|██████████| 128/128 [01:06<00:00,  1.90it/s]100%|██████████| 128/128 [01:06<00:00,  1.93it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.57s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.40s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.96s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.83s/it]
[2024-01-18 07:27:44,986] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 45%|████▍     | 57/128 [00:00<00:00, 562.22it/s]100%|██████████| 128/128 [00:00<00:00, 645.53it/s]100%|██████████| 128/128 [00:00<00:00, 632.24it/s]
[2024-01-18 07:27:45,318] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.17it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<01:02,  1.99it/s]  3%|▎         | 4/128 [00:02<01:03,  1.95it/s]  4%|▍         | 5/128 [00:02<01:00,  2.02it/s]  5%|▍         | 6/128 [00:03<01:01,  1.98it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:57,  2.07it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:54,  2.15it/s]  9%|▊         | 11/128 [00:05<00:53,  2.18it/s]  9%|▉         | 12/128 [00:05<00:54,  2.11it/s] 10%|█         | 13/128 [00:06<00:54,  2.12it/s] 11%|█         | 14/128 [00:06<00:55,  2.06it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.09it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.10it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.05it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.02it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.08it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.13it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.07it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.12it/s] 18%|█▊        | 23/128 [00:11<00:49,  2.13it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.06it/s] 20%|█▉        | 25/128 [00:11<00:47,  2.16it/s] 20%|██        | 26/128 [00:12<00:49,  2.07it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:50,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.96it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.04it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.01it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.00it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.07it/s] 29%|██▉       | 37/128 [00:17<00:42,  2.12it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.04it/s] 30%|███       | 39/128 [00:19<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.05it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.97it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.04it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.02it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.97it/s] 36%|███▌      | 46/128 [00:22<00:40,  2.02it/s] 37%|███▋      | 47/128 [00:22<00:40,  1.99it/s] 38%|███▊      | 48/128 [00:23<00:42,  1.86it/s] 38%|███▊      | 49/128 [00:24<00:41,  1.88it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.98it/s] 40%|███▉      | 51/128 [00:25<00:39,  1.96it/s] 41%|████      | 52/128 [00:25<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.00it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.04it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.06it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.09it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.01it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.99it/s] 49%|████▉     | 63/128 [00:31<00:32,  1.97it/s] 50%|█████     | 64/128 [00:31<00:32,  1.94it/s] 51%|█████     | 65/128 [00:32<00:32,  1.91it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.95it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.03it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.00it/s] 55%|█████▍    | 70/128 [00:34<00:27,  2.11it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.05it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.07it/s] 57%|█████▋    | 73/128 [00:36<00:29,  1.85it/s] 58%|█████▊    | 74/128 [00:36<00:28,  1.92it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:37<00:25,  2.02it/s] 60%|██████    | 77/128 [00:38<00:25,  1.98it/s] 61%|██████    | 78/128 [00:38<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:40<00:24,  1.90it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.89it/s] 66%|██████▌   | 84/128 [00:41<00:23,  1.90it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.99it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.95it/s] 70%|██████▉   | 89/128 [00:44<00:20,  1.95it/s] 70%|███████   | 90/128 [00:44<00:19,  1.99it/s] 71%|███████   | 91/128 [00:45<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.09it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.05it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.02it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.94it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.02it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.06it/s] 80%|████████  | 103/128 [00:51<00:12,  2.08it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.09it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.99it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.98it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.94it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.01it/s] 86%|████████▌ | 110/128 [00:54<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.09it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.10it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.04it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.05it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.01it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.07it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.12it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.12it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.06it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:02<00:01,  1.98it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.96it/s]100%|██████████| 128/128 [01:03<00:00,  2.08it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
[2024-01-18 07:28:48,802] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:00,  2.11it/s]  2%|▏         | 2/128 [00:00<01:03,  1.99it/s]  2%|▏         | 3/128 [00:01<01:03,  1.96it/s]  3%|▎         | 4/128 [00:02<01:04,  1.92it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:03<01:02,  1.95it/s]  5%|▌         | 7/128 [00:03<01:00,  2.00it/s]  6%|▋         | 8/128 [00:03<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:55,  2.11it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:55,  2.08it/s] 10%|█         | 13/128 [00:06<00:54,  2.09it/s] 11%|█         | 14/128 [00:06<00:56,  2.03it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.08it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.03it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.06it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.10it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.10it/s] 18%|█▊        | 23/128 [00:11<00:49,  2.10it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.04it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.14it/s] 20%|██        | 26/128 [00:12<00:49,  2.05it/s] 21%|██        | 27/128 [00:13<00:50,  2.00it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.94it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.03it/s] 24%|██▍       | 31/128 [00:15<00:48,  1.99it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.96it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:46,  1.98it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:18<00:43,  2.10it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.02it/s] 30%|███       | 39/128 [00:19<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.03it/s] 32%|███▏      | 41/128 [00:20<00:43,  2.00it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.95it/s] 34%|███▎      | 43/128 [00:21<00:41,  2.02it/s] 34%|███▍      | 44/128 [00:21<00:42,  2.00it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.96it/s] 36%|███▌      | 46/128 [00:22<00:40,  2.01it/s] 37%|███▋      | 47/128 [00:23<00:40,  1.98it/s] 38%|███▊      | 48/128 [00:23<00:43,  1.85it/s] 38%|███▊      | 49/128 [00:24<00:42,  1.87it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.96it/s] 40%|███▉      | 51/128 [00:25<00:39,  1.95it/s] 41%|████      | 52/128 [00:25<00:36,  2.07it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.02it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.99it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.03it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:28<00:34,  2.07it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.00it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.00it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.96it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:33,  1.90it/s] 52%|█████▏    | 66/128 [00:32<00:32,  1.91it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.91it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.99it/s] 54%|█████▍    | 69/128 [00:34<00:29,  1.97it/s] 55%|█████▍    | 70/128 [00:34<00:27,  2.08it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.03it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.06it/s] 57%|█████▋    | 73/128 [00:36<00:29,  1.84it/s] 58%|█████▊    | 74/128 [00:36<00:28,  1.91it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:37<00:25,  2.01it/s] 60%|██████    | 77/128 [00:38<00:25,  1.97it/s] 61%|██████    | 78/128 [00:39<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:41<00:24,  1.90it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.89it/s] 66%|██████▌   | 84/128 [00:42<00:23,  1.89it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.97it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.94it/s] 70%|██████▉   | 89/128 [00:44<00:20,  1.94it/s] 70%|███████   | 90/128 [00:45<00:19,  1.99it/s] 71%|███████   | 91/128 [00:45<00:18,  2.02it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.08it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.97it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.04it/s] 75%|███████▌  | 96/128 [00:48<00:15,  2.01it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.94it/s] 77%|███████▋  | 99/128 [00:49<00:15,  1.93it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.01it/s] 79%|███████▉  | 101/128 [00:50<00:13,  1.99it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.05it/s] 80%|████████  | 103/128 [00:51<00:12,  2.07it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.09it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.93it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.01it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.02it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.00it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.04it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.00it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.06it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.12it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.12it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.06it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:02<00:02,  1.98it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.97it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.96it/s]100%|██████████| 128/128 [01:03<00:00,  2.08it/s]100%|██████████| 128/128 [01:03<00:00,  2.00it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.19s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.34s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.98s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.80s/it]
[2024-01-18 07:30:46,944] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 67/128 [00:00<00:00, 669.58it/s]100%|██████████| 128/128 [00:00<00:00, 678.51it/s]
[2024-01-18 07:30:47,263] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.18it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:01<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:02<00:59,  2.04it/s]  5%|▌         | 7/128 [00:03<01:00,  2.02it/s]  6%|▋         | 8/128 [00:03<00:56,  2.13it/s]  7%|▋         | 9/128 [00:04<00:55,  2.14it/s]  8%|▊         | 10/128 [00:04<00:54,  2.17it/s]  9%|▊         | 11/128 [00:05<00:53,  2.20it/s]  9%|▉         | 12/128 [00:05<00:52,  2.21it/s] 10%|█         | 13/128 [00:06<00:53,  2.13it/s] 11%|█         | 14/128 [00:06<00:55,  2.07it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.04it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.97it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.04it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.07it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.02it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.15it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.08it/s] 20%|██        | 26/128 [00:12<00:50,  2.04it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.03it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.00it/s] 24%|██▍       | 31/128 [00:15<00:48,  1.98it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.94it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.93it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:46,  1.99it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.97it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.96it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:45,  1.96it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.93it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.03it/s] 35%|███▌      | 45/128 [00:22<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.96it/s] 37%|███▋      | 47/128 [00:23<00:40,  2.01it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.02it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.09it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.04it/s] 41%|████      | 52/128 [00:25<00:37,  2.01it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.06it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.02it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.00it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.95it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.95it/s] 49%|████▉     | 63/128 [00:31<00:35,  1.83it/s] 50%|█████     | 64/128 [00:31<00:34,  1.86it/s] 51%|█████     | 65/128 [00:32<00:33,  1.88it/s] 52%|█████▏    | 66/128 [00:32<00:32,  1.89it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.07it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.01it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.96it/s] 56%|█████▋    | 72/128 [00:35<00:26,  2.08it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.09it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.05it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.89it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.89it/s] 60%|██████    | 77/128 [00:38<00:27,  1.88it/s] 61%|██████    | 78/128 [00:39<00:26,  1.90it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:41<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.10it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.05it/s] 70%|███████   | 90/128 [00:44<00:18,  2.07it/s] 71%|███████   | 91/128 [00:45<00:17,  2.08it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.05it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.89it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.91it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.97it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.00it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.04it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.04it/s] 80%|████████  | 103/128 [00:51<00:11,  2.14it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.07it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.03it/s] 83%|████████▎ | 106/128 [00:52<00:10,  2.00it/s] 84%|████████▎ | 107/128 [00:53<00:09,  2.11it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.19it/s] 85%|████████▌ | 109/128 [00:54<00:08,  2.17it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.09it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:55<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.11it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.04it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.10it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.04it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.10it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.11it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.05it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.07it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.02it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.05it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.97it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.96it/s] 98%|█████████▊| 126/128 [01:02<00:01,  1.94it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]
[2024-01-18 07:31:51,007] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.13it/s]  2%|▏         | 2/128 [00:00<01:02,  2.02it/s]  2%|▏         | 3/128 [00:01<01:03,  1.97it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:02,  1.95it/s]  5%|▍         | 6/128 [00:03<01:00,  2.01it/s]  5%|▌         | 7/128 [00:03<01:00,  1.99it/s]  6%|▋         | 8/128 [00:03<00:57,  2.10it/s]  7%|▋         | 9/128 [00:04<00:56,  2.11it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:54,  2.17it/s]  9%|▉         | 12/128 [00:05<00:53,  2.18it/s] 10%|█         | 13/128 [00:06<00:54,  2.10it/s] 11%|█         | 14/128 [00:06<00:55,  2.04it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.01it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.99it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.95it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.94it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.02it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.04it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.01it/s] 17%|█▋        | 22/128 [00:10<00:53,  1.99it/s] 18%|█▊        | 23/128 [00:11<00:53,  1.96it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.04it/s] 20%|██        | 26/128 [00:12<00:50,  2.01it/s] 21%|██        | 27/128 [00:13<00:50,  1.99it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.01it/s] 23%|██▎       | 30/128 [00:14<00:49,  1.98it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.96it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.92it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.91it/s] 27%|██▋       | 34/128 [00:16<00:49,  1.91it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.97it/s] 28%|██▊       | 36/128 [00:17<00:47,  1.95it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.95it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.94it/s] 30%|███       | 39/128 [00:19<00:45,  1.95it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:20<00:47,  1.83it/s] 33%|███▎      | 42/128 [00:21<00:45,  1.91it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.90it/s] 34%|███▍      | 44/128 [00:22<00:42,  1.99it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.95it/s] 37%|███▋      | 47/128 [00:23<00:40,  2.00it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:25<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.03it/s] 41%|████      | 52/128 [00:26<00:37,  2.00it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.97it/s] 42%|████▏     | 54/128 [00:27<00:36,  2.02it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.05it/s] 44%|████▍     | 56/128 [00:28<00:35,  2.01it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.94it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.94it/s] 49%|████▉     | 63/128 [00:31<00:35,  1.82it/s] 50%|█████     | 64/128 [00:32<00:34,  1.85it/s] 51%|█████     | 65/128 [00:32<00:33,  1.88it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.89it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.95it/s] 53%|█████▎    | 68/128 [00:34<00:28,  2.07it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.01it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.96it/s] 56%|█████▋    | 72/128 [00:36<00:26,  2.07it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.09it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.05it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.89it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.88it/s] 60%|██████    | 77/128 [00:38<00:27,  1.88it/s] 61%|██████    | 78/128 [00:39<00:26,  1.90it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:41<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.09it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.04it/s] 70%|███████   | 90/128 [00:45<00:18,  2.06it/s] 71%|███████   | 91/128 [00:45<00:17,  2.08it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:47<00:16,  2.04it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.88it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.90it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.95it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.00it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.04it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.03it/s] 80%|████████  | 103/128 [00:51<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.05it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.02it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.99it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.10it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.18it/s] 85%|████████▌ | 109/128 [00:54<00:08,  2.16it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.08it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.02it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.10it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.09it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.04it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.09it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.10it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.04it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.06it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.02it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.05it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:02<00:02,  1.97it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.95it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.94it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.02it/s]100%|██████████| 128/128 [01:04<00:00,  1.97it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.15s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.20s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.54s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.18s/it]
[2024-01-18 07:33:50,627] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 41%|████▏     | 53/128 [00:00<00:00, 528.56it/s] 95%|█████████▌| 122/128 [00:00<00:00, 620.44it/s]100%|██████████| 128/128 [00:00<00:00, 610.12it/s]
[2024-01-18 07:33:50,968] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.28it/s]  2%|▏         | 2/128 [00:00<01:01,  2.06it/s]  2%|▏         | 3/128 [00:01<01:03,  1.98it/s]  3%|▎         | 4/128 [00:01<01:02,  1.97it/s]  4%|▍         | 5/128 [00:02<01:00,  2.04it/s]  5%|▍         | 6/128 [00:02<01:00,  2.01it/s]  5%|▌         | 7/128 [00:03<00:58,  2.06it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:55,  2.14it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:53,  2.17it/s]  9%|▉         | 12/128 [00:05<00:52,  2.19it/s] 10%|█         | 13/128 [00:06<00:54,  2.11it/s] 11%|█         | 14/128 [00:06<00:55,  2.06it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.01it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.05it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.89it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.01it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.02it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.06it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.16it/s] 20%|██        | 26/128 [00:12<00:51,  1.96it/s] 21%|██        | 27/128 [00:13<00:51,  1.95it/s] 22%|██▏       | 28/128 [00:13<00:51,  1.95it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.08it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.03it/s] 24%|██▍       | 31/128 [00:15<00:48,  1.99it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.94it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.00it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.99it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.06it/s] 30%|███       | 39/128 [00:19<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:20<00:43,  2.02it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.98it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.95it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.03it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.09it/s] 41%|████      | 52/128 [00:25<00:37,  2.05it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.98it/s] 43%|████▎     | 55/128 [00:27<00:37,  1.97it/s] 44%|████▍     | 56/128 [00:27<00:37,  1.94it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.93it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.94it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.92it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.93it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:31,  1.99it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.05it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.11it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.03it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.98it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.97it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.95it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.08it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.01it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.96it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.93it/s] 60%|██████    | 77/128 [00:38<00:26,  1.91it/s] 61%|██████    | 78/128 [00:38<00:26,  1.90it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:40<00:23,  1.97it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.96it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.95it/s] 66%|██████▌   | 84/128 [00:41<00:22,  2.00it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.01it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.98it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.06it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.08it/s] 70%|███████   | 90/128 [00:44<00:18,  2.02it/s] 71%|███████   | 91/128 [00:45<00:17,  2.07it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.01it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:47<00:18,  1.85it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.88it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.89it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.90it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.99it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:50<00:14,  1.99it/s] 79%|███████▉  | 101/128 [00:50<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:51<00:13,  1.95it/s] 80%|████████  | 103/128 [00:51<00:12,  1.94it/s] 81%|████████▏ | 104/128 [00:52<00:13,  1.82it/s] 82%|████████▏ | 105/128 [00:52<00:12,  1.85it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.87it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.07it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:55<00:08,  1.97it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.05it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.07it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.01it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.07it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.11it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.12it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.04it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.08it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.03it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.98it/s]100%|██████████| 128/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:04<00:00,  2.00it/s]
[2024-01-18 07:34:55,054] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.25it/s]  2%|▏         | 2/128 [00:00<01:01,  2.03it/s]  2%|▏         | 3/128 [00:01<01:03,  1.96it/s]  3%|▎         | 4/128 [00:02<01:03,  1.95it/s]  4%|▍         | 5/128 [00:02<01:01,  2.01it/s]  5%|▍         | 6/128 [00:03<01:01,  1.99it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:56,  2.11it/s]  8%|▊         | 10/128 [00:04<00:55,  2.11it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:54,  2.14it/s] 10%|█         | 13/128 [00:06<00:55,  2.08it/s] 11%|█         | 14/128 [00:06<00:56,  2.02it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.97it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.01it/s] 13%|█▎        | 17/128 [00:08<00:59,  1.86it/s] 14%|█▍        | 18/128 [00:08<00:57,  1.93it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.98it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.05it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.02it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.05it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.00it/s] 19%|█▉        | 24/128 [00:11<00:51,  2.04it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.14it/s] 20%|██        | 26/128 [00:12<00:52,  1.94it/s] 21%|██        | 27/128 [00:13<00:52,  1.93it/s] 22%|██▏       | 28/128 [00:13<00:51,  1.93it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.97it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.96it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.93it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.01it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.98it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.97it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.04it/s] 30%|███       | 39/128 [00:19<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:20<00:47,  1.85it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.93it/s] 33%|███▎      | 42/128 [00:21<00:45,  1.91it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.91it/s] 34%|███▍      | 44/128 [00:22<00:44,  1.90it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.91it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.92it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.92it/s] 38%|███▊      | 48/128 [00:24<00:39,  2.00it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.05it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.06it/s] 41%|████      | 52/128 [00:26<00:37,  2.03it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.99it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.96it/s] 43%|████▎     | 55/128 [00:27<00:37,  1.95it/s] 44%|████▍     | 56/128 [00:28<00:37,  1.92it/s] 45%|████▍     | 57/128 [00:28<00:37,  1.92it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.97it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.90it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.91it/s] 50%|█████     | 64/128 [00:32<00:33,  1.92it/s] 51%|█████     | 65/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.94it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:34<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.01it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.95it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.94it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.06it/s] 58%|█████▊    | 74/128 [00:37<00:27,  2.00it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.95it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.92it/s] 60%|██████    | 77/128 [00:38<00:26,  1.90it/s] 61%|██████    | 78/128 [00:39<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:40<00:26,  1.88it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.96it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.94it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.94it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.96it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.95it/s] 68%|██████▊   | 87/128 [00:44<00:21,  1.94it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.02it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.05it/s] 70%|███████   | 90/128 [00:45<00:19,  2.00it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:46<00:18,  2.00it/s] 73%|███████▎  | 93/128 [00:47<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:47<00:18,  1.85it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.87it/s] 75%|███████▌  | 96/128 [00:48<00:17,  1.88it/s] 76%|███████▌  | 97/128 [00:49<00:16,  1.90it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:50<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:50<00:14,  1.99it/s] 79%|███████▉  | 101/128 [00:51<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:51<00:13,  1.95it/s] 80%|████████  | 103/128 [00:52<00:12,  1.94it/s] 81%|████████▏ | 104/128 [00:52<00:13,  1.82it/s] 82%|████████▏ | 105/128 [00:53<00:12,  1.85it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.86it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.06it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.96it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.99it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.03it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.98it/s] 93%|█████████▎| 119/128 [01:00<00:04,  2.03it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.08it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.09it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:02<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.02it/s] 98%|█████████▊| 125/128 [01:03<00:01,  2.07it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.97it/s]100%|██████████| 128/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.19s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.21s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.00s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.78s/it]
[2024-01-18 07:36:53,897] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 54%|█████▍    | 69/128 [00:00<00:00, 680.93it/s]100%|██████████| 128/128 [00:00<00:00, 683.00it/s]
[2024-01-18 07:36:54,213] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.17it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<01:02,  1.99it/s]  3%|▎         | 4/128 [00:01<01:02,  1.98it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:03<01:01,  1.97it/s]  5%|▌         | 7/128 [00:03<00:59,  2.02it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:56,  2.09it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:56,  2.07it/s]  9%|▉         | 12/128 [00:05<00:55,  2.10it/s] 10%|█         | 13/128 [00:06<00:53,  2.14it/s] 11%|█         | 14/128 [00:06<00:54,  2.08it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.04it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.00it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.97it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.05it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.01it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.12it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.07it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.09it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.05it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.15it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.18it/s] 20%|██        | 26/128 [00:12<00:48,  2.09it/s] 21%|██        | 27/128 [00:13<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:49,  1.99it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.04it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.10it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.03it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.97it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.13it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.05it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.02it/s] 30%|███       | 39/128 [00:19<00:44,  2.00it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.98it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.03it/s] 34%|███▎      | 43/128 [00:21<00:42,  2.00it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.99it/s] 35%|███▌      | 45/128 [00:22<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.95it/s] 37%|███▋      | 47/128 [00:23<00:39,  2.04it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.00it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.04it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.16it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.16it/s] 41%|████      | 52/128 [00:25<00:36,  2.09it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.11it/s] 42%|████▏     | 54/128 [00:26<00:34,  2.12it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.16it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.07it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:28<00:35,  2.00it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.04it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.04it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.99it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.96it/s] 50%|█████     | 64/128 [00:31<00:32,  1.96it/s] 51%|█████     | 65/128 [00:31<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:32<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.04it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.09it/s] 54%|█████▍    | 69/128 [00:33<00:29,  2.02it/s] 55%|█████▍    | 70/128 [00:34<00:29,  2.00it/s] 55%|█████▌    | 71/128 [00:34<00:29,  1.96it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.01it/s] 57%|█████▋    | 73/128 [00:35<00:27,  1.98it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.02it/s] 59%|█████▊    | 75/128 [00:36<00:28,  1.87it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.87it/s] 60%|██████    | 77/128 [00:38<00:27,  1.87it/s] 61%|██████    | 78/128 [00:38<00:26,  1.88it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.89it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.95it/s] 64%|██████▍   | 82/128 [00:40<00:22,  2.01it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.04it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.10it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.00it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.98it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.09it/s] 70%|███████   | 90/128 [00:44<00:17,  2.13it/s] 71%|███████   | 91/128 [00:44<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.08it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.99it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:48<00:13,  2.10it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.10it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.04it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.00it/s] 80%|████████  | 103/128 [00:50<00:12,  1.98it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:51<00:11,  1.92it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.98it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.05it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.07it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.02it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.12it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.08it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.13it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.13it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.07it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.02it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.05it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.97it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.08it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:01,  2.00it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.03it/s]100%|██████████| 128/128 [01:03<00:00,  1.98it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
[2024-01-18 07:37:57,451] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.12it/s]  2%|▏         | 2/128 [00:00<01:03,  2.00it/s]  2%|▏         | 3/128 [00:01<01:03,  1.95it/s]  3%|▎         | 4/128 [00:02<01:03,  1.95it/s]  4%|▍         | 5/128 [00:02<01:03,  1.94it/s]  5%|▍         | 6/128 [00:03<01:02,  1.94it/s]  5%|▌         | 7/128 [00:03<01:00,  1.99it/s]  6%|▋         | 8/128 [00:04<00:59,  2.03it/s]  7%|▋         | 9/128 [00:04<00:57,  2.06it/s]  8%|▊         | 10/128 [00:04<00:56,  2.11it/s]  9%|▊         | 11/128 [00:05<00:57,  2.04it/s]  9%|▉         | 12/128 [00:05<00:56,  2.06it/s] 10%|█         | 13/128 [00:06<00:54,  2.11it/s] 11%|█         | 14/128 [00:06<00:55,  2.05it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.01it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.97it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.95it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.02it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.98it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.05it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.01it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.04it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.01it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.11it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.15it/s] 20%|██        | 26/128 [00:12<00:49,  2.06it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.95it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.00it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.06it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.00it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.94it/s] 27%|██▋       | 35/128 [00:17<00:46,  1.99it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.10it/s] 29%|██▉       | 37/128 [00:18<00:45,  2.02it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:45,  1.97it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.92it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.00it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:40,  2.01it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.98it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.14it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.13it/s] 41%|████      | 52/128 [00:25<00:36,  2.07it/s] 41%|████▏     | 53/128 [00:26<00:35,  2.08it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.10it/s] 43%|████▎     | 55/128 [00:27<00:34,  2.14it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.03it/s] 47%|████▋     | 60/128 [00:29<00:34,  2.00it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.03it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.98it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:32,  1.94it/s] 51%|█████     | 65/128 [00:32<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.01it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.98it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.95it/s] 56%|█████▋    | 72/128 [00:35<00:28,  2.00it/s] 57%|█████▋    | 73/128 [00:36<00:27,  1.97it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.96it/s] 59%|█████▊    | 75/128 [00:37<00:29,  1.82it/s] 59%|█████▉    | 76/128 [00:38<00:28,  1.83it/s] 60%|██████    | 77/128 [00:38<00:27,  1.84it/s] 61%|██████    | 78/128 [00:39<00:26,  1.85it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.86it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.86it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.98it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.03it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.09it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.09it/s] 70%|███████   | 90/128 [00:44<00:17,  2.12it/s] 71%|███████   | 91/128 [00:45<00:18,  2.05it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.07it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.92it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.93it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.92it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.06it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.03it/s] 80%|███████▉  | 102/128 [00:51<00:13,  1.99it/s] 80%|████████  | 103/128 [00:51<00:12,  1.96it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.92it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.98it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.05it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.07it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.02it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.12it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.08it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.13it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.12it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.07it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.01it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.05it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.97it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.08it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:01,  2.00it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.03it/s]100%|██████████| 128/128 [01:03<00:00,  1.99it/s]100%|██████████| 128/128 [01:03<00:00,  2.00it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.20s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.07s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.84s/it]
[2024-01-18 07:39:55,579] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 43%|████▎     | 55/128 [00:00<00:00, 542.75it/s] 98%|█████████▊| 126/128 [00:00<00:00, 635.73it/s]100%|██████████| 128/128 [00:00<00:00, 622.31it/s]
[2024-01-18 07:39:55,914] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.18it/s]  2%|▏         | 2/128 [00:00<01:02,  2.01it/s]  2%|▏         | 3/128 [00:01<00:58,  2.12it/s]  3%|▎         | 4/128 [00:01<01:00,  2.05it/s]  4%|▍         | 5/128 [00:02<00:58,  2.09it/s]  5%|▍         | 6/128 [00:02<01:00,  2.03it/s]  5%|▌         | 7/128 [00:03<00:58,  2.07it/s]  6%|▋         | 8/128 [00:03<00:59,  2.03it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:54,  2.17it/s]  9%|▊         | 11/128 [00:05<00:55,  2.09it/s]  9%|▉         | 12/128 [00:05<00:54,  2.14it/s] 10%|█         | 13/128 [00:06<00:52,  2.17it/s] 11%|█         | 14/128 [00:06<00:54,  2.08it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.10it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.14it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.08it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.04it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.99it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.12it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.16it/s] 18%|█▊        | 23/128 [00:10<00:48,  2.19it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:11<00:48,  2.12it/s] 20%|██        | 26/128 [00:12<00:47,  2.16it/s] 21%|██        | 27/128 [00:12<00:46,  2.18it/s] 22%|██▏       | 28/128 [00:13<00:47,  2.11it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.16it/s] 24%|██▍       | 31/128 [00:14<00:43,  2.24it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.12it/s] 26%|██▌       | 33/128 [00:15<00:45,  2.07it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.02it/s] 27%|██▋       | 35/128 [00:16<00:46,  2.00it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.98it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.06it/s] 30%|██▉       | 38/128 [00:18<00:41,  2.16it/s] 30%|███       | 39/128 [00:18<00:43,  2.07it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.09it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.04it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.00it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.04it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.10it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.02it/s] 36%|███▌      | 46/128 [00:22<00:39,  2.09it/s] 37%|███▋      | 47/128 [00:22<00:39,  2.04it/s] 38%|███▊      | 48/128 [00:23<00:42,  1.89it/s] 38%|███▊      | 49/128 [00:23<00:41,  1.91it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.97it/s] 40%|███▉      | 51/128 [00:24<00:38,  2.02it/s] 41%|████      | 52/128 [00:25<00:37,  2.05it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.08it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:26<00:36,  2.01it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.04it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.07it/s] 45%|████▌     | 58/128 [00:27<00:33,  2.09it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.04it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.06it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.08it/s] 48%|████▊     | 62/128 [00:29<00:30,  2.13it/s] 49%|████▉     | 63/128 [00:30<00:31,  2.04it/s] 50%|█████     | 64/128 [00:30<00:30,  2.07it/s] 51%|█████     | 65/128 [00:31<00:31,  2.01it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:32<00:30,  1.97it/s] 53%|█████▎    | 68/128 [00:32<00:30,  1.95it/s] 54%|█████▍    | 69/128 [00:33<00:29,  2.00it/s] 55%|█████▍    | 70/128 [00:33<00:29,  1.98it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.10it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.05it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.07it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.01it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.99it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:24,  2.05it/s] 61%|██████    | 78/128 [00:37<00:25,  1.99it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.95it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:39<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.90it/s] 66%|██████▌   | 84/128 [00:41<00:23,  1.90it/s] 66%|██████▋   | 85/128 [00:41<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.96it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.04it/s] 69%|██████▉   | 88/128 [00:43<00:21,  1.89it/s] 70%|██████▉   | 89/128 [00:43<00:19,  1.96it/s] 70%|███████   | 90/128 [00:44<00:19,  1.95it/s] 71%|███████   | 91/128 [00:44<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.08it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.03it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.99it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.03it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.06it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.97it/s] 78%|███████▊  | 100/128 [00:49<00:14,  1.96it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.01it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.07it/s] 80%|████████  | 103/128 [00:50<00:11,  2.19it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.11it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.01it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.99it/s] 84%|████████▍ | 108/128 [00:52<00:10,  1.97it/s] 85%|████████▌ | 109/128 [00:53<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:54<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.03it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.00it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:56<00:06,  1.99it/s] 91%|█████████▏| 117/128 [00:57<00:05,  1.97it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.02it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.05it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.10it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.11it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.11it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.11it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.11it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.08it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.12it/s]100%|██████████| 128/128 [01:02<00:00,  2.16it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
[2024-01-18 07:40:58,492] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.13it/s]  2%|▏         | 2/128 [00:01<01:03,  1.97it/s]  2%|▏         | 3/128 [00:01<00:59,  2.09it/s]  3%|▎         | 4/128 [00:01<01:01,  2.02it/s]  4%|▍         | 5/128 [00:02<00:59,  2.06it/s]  5%|▍         | 6/128 [00:02<01:00,  2.00it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<01:00,  2.00it/s]  7%|▋         | 9/128 [00:04<00:58,  2.04it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:56,  2.07it/s]  9%|▉         | 12/128 [00:05<00:54,  2.11it/s] 10%|█         | 13/128 [00:06<00:54,  2.12it/s] 11%|█         | 14/128 [00:06<00:55,  2.04it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.11it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.03it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.01it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.96it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.08it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.13it/s] 18%|█▊        | 23/128 [00:11<00:48,  2.15it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.07it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.09it/s] 20%|██        | 26/128 [00:12<00:47,  2.13it/s] 21%|██        | 27/128 [00:13<00:46,  2.16it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.08it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.13it/s] 24%|██▍       | 31/128 [00:14<00:43,  2.21it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.09it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.04it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.00it/s] 27%|██▋       | 35/128 [00:16<00:47,  1.97it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.96it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.03it/s] 30%|██▉       | 38/128 [00:18<00:42,  2.13it/s] 30%|███       | 39/128 [00:18<00:43,  2.04it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.07it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.02it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:20<00:42,  2.02it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.08it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:22<00:39,  2.07it/s] 37%|███▋      | 47/128 [00:22<00:40,  2.02it/s] 38%|███▊      | 48/128 [00:23<00:42,  1.87it/s] 38%|███▊      | 49/128 [00:23<00:41,  1.89it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.95it/s] 40%|███▉      | 51/128 [00:24<00:38,  2.00it/s] 41%|████      | 52/128 [00:25<00:37,  2.04it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.02it/s] 43%|████▎     | 55/128 [00:26<00:36,  1.99it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.05it/s] 45%|████▌     | 58/128 [00:28<00:33,  2.07it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.05it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.07it/s] 48%|████▊     | 62/128 [00:30<00:31,  2.11it/s] 49%|████▉     | 63/128 [00:30<00:32,  2.02it/s] 50%|█████     | 64/128 [00:31<00:31,  2.05it/s] 51%|█████     | 65/128 [00:31<00:31,  1.99it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:32<00:31,  1.95it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.94it/s] 54%|█████▍    | 69/128 [00:33<00:29,  1.99it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.96it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.07it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.03it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.05it/s] 58%|█████▊    | 74/128 [00:36<00:27,  2.00it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.97it/s] 60%|██████    | 77/128 [00:37<00:25,  2.04it/s] 61%|██████    | 78/128 [00:38<00:25,  1.98it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.92it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.90it/s] 64%|██████▍   | 82/128 [00:40<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.90it/s] 66%|██████▌   | 84/128 [00:41<00:23,  1.90it/s] 66%|██████▋   | 85/128 [00:41<00:21,  1.96it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.96it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:43<00:21,  1.88it/s] 70%|██████▉   | 89/128 [00:44<00:20,  1.94it/s] 70%|███████   | 90/128 [00:44<00:19,  1.94it/s] 71%|███████   | 91/128 [00:44<00:18,  2.02it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.05it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.07it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.02it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.98it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.02it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.05it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.97it/s] 78%|███████▊  | 100/128 [00:49<00:14,  1.96it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.06it/s] 80%|████████  | 103/128 [00:50<00:11,  2.19it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.10it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:52<00:10,  2.01it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.99it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.97it/s] 85%|████████▌ | 109/128 [00:53<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:54<00:08,  1.98it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.00it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:57<00:06,  1.99it/s] 91%|█████████▏| 117/128 [00:57<00:05,  1.97it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.01it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.04it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.09it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.10it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.10it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.11it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.11it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.05it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.07it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.09it/s]100%|██████████| 128/128 [01:03<00:00,  2.13it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.95s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.54s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.12s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.00s/it]
[2024-01-18 07:42:56,575] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 53%|█████▎    | 68/128 [00:00<00:00, 678.37it/s]100%|██████████| 128/128 [00:00<00:00, 676.43it/s]
[2024-01-18 07:42:56,902] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:05,  1.95it/s]  2%|▏         | 2/128 [00:00<01:00,  2.07it/s]  2%|▏         | 3/128 [00:01<01:02,  2.01it/s]  3%|▎         | 4/128 [00:01<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:02<01:00,  2.03it/s]  5%|▌         | 7/128 [00:03<00:58,  2.07it/s]  6%|▋         | 8/128 [00:03<00:56,  2.13it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:56,  2.09it/s]  9%|▊         | 11/128 [00:05<00:54,  2.14it/s]  9%|▉         | 12/128 [00:05<00:53,  2.15it/s] 10%|█         | 13/128 [00:06<00:55,  2.08it/s] 11%|█         | 14/128 [00:06<00:55,  2.04it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.01it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.99it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.98it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.97it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.96it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.04it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.10it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.12it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.05it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.11it/s] 20%|█▉        | 25/128 [00:12<00:46,  2.22it/s] 20%|██        | 26/128 [00:12<00:48,  2.11it/s] 21%|██        | 27/128 [00:13<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.08it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.13it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.13it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.05it/s] 26%|██▌       | 33/128 [00:16<00:47,  2.00it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.97it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.04it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.99it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.98it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.95it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.94it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.94it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:45,  1.77it/s] 38%|███▊      | 48/128 [00:23<00:44,  1.81it/s] 38%|███▊      | 49/128 [00:24<00:41,  1.90it/s] 39%|███▉      | 50/128 [00:24<00:40,  1.91it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.00it/s] 41%|████      | 52/128 [00:25<00:36,  2.07it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.99it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.07it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.00it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.92it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.91it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.92it/s] 50%|█████     | 64/128 [00:31<00:33,  1.90it/s] 51%|█████     | 65/128 [00:32<00:32,  1.91it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.05it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.08it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.03it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.95it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.03it/s] 59%|█████▊    | 75/128 [00:37<00:26,  2.00it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.96it/s] 60%|██████    | 77/128 [00:38<00:26,  1.96it/s] 61%|██████    | 78/128 [00:38<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.92it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.98it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.96it/s] 70%|███████   | 90/128 [00:45<00:18,  2.04it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.00it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:47<00:17,  2.00it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.92it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.97it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.10it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.04it/s] 80%|████████  | 103/128 [00:51<00:12,  2.01it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.98it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.97it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.84it/s] 84%|████████▎ | 107/128 [00:53<00:11,  1.86it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.87it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.94it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.93it/s] 87%|████████▋ | 111/128 [00:55<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.97it/s] 88%|████████▊ | 113/128 [00:56<00:07,  1.96it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.02it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.05it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.10it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.10it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.06it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.07it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.03it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.01it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.07it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.99it/s]100%|██████████| 128/128 [01:04<00:00,  1.97it/s]100%|██████████| 128/128 [01:04<00:00,  2.00it/s]
[2024-01-18 07:44:00,991] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:06,  1.91it/s]  2%|▏         | 2/128 [00:00<01:01,  2.03it/s]  2%|▏         | 3/128 [00:01<01:03,  1.98it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:03,  1.94it/s]  5%|▍         | 6/128 [00:03<01:01,  2.00it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:04<00:57,  2.06it/s]  9%|▊         | 11/128 [00:05<00:55,  2.10it/s]  9%|▉         | 12/128 [00:05<00:54,  2.11it/s] 10%|█         | 13/128 [00:06<00:56,  2.05it/s] 11%|█         | 14/128 [00:06<00:56,  2.01it/s] 12%|█▏        | 15/128 [00:07<00:56,  1.99it/s] 12%|█▎        | 16/128 [00:07<00:57,  1.96it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.94it/s] 14%|█▍        | 18/128 [00:09<00:57,  1.93it/s] 15%|█▍        | 19/128 [00:09<00:56,  1.92it/s] 16%|█▌        | 20/128 [00:09<00:53,  2.01it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.06it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.02it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.08it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.19it/s] 20%|██        | 26/128 [00:12<00:49,  2.08it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.11it/s] 24%|██▍       | 31/128 [00:15<00:45,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.03it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.96it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.95it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.02it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.97it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.94it/s] 30%|███       | 39/128 [00:19<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.93it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.93it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.93it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.91it/s] 37%|███▋      | 47/128 [00:23<00:46,  1.75it/s] 38%|███▊      | 48/128 [00:24<00:44,  1.80it/s] 38%|███▊      | 49/128 [00:24<00:41,  1.89it/s] 39%|███▉      | 50/128 [00:25<00:40,  1.90it/s] 40%|███▉      | 51/128 [00:25<00:38,  1.99it/s] 41%|████      | 52/128 [00:26<00:37,  2.03it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.99it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.97it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.04it/s] 44%|████▍     | 56/128 [00:28<00:35,  2.01it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.97it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.92it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.90it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.91it/s] 50%|█████     | 64/128 [00:32<00:33,  1.90it/s] 51%|█████     | 65/128 [00:32<00:32,  1.91it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:34<00:29,  2.05it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.07it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.03it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.95it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.03it/s] 59%|█████▊    | 75/128 [00:37<00:26,  2.00it/s] 59%|█████▉    | 76/128 [00:38<00:26,  1.96it/s] 60%|██████    | 77/128 [00:38<00:26,  1.95it/s] 61%|██████    | 78/128 [00:39<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.92it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.98it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.96it/s] 70%|███████   | 90/128 [00:45<00:18,  2.04it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.00it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.04it/s] 73%|███████▎  | 94/128 [00:47<00:16,  2.00it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.92it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.97it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.04it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.10it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.04it/s] 80%|████████  | 103/128 [00:51<00:12,  2.01it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.98it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.97it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.84it/s] 84%|████████▎ | 107/128 [00:54<00:11,  1.86it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.86it/s] 85%|████████▌ | 109/128 [00:55<00:09,  1.93it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.93it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.96it/s] 88%|████████▊ | 113/128 [00:57<00:07,  1.96it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.05it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.01it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.04it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.09it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.10it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.05it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.07it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:02<00:02,  2.00it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.99it/s]100%|██████████| 128/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.20s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.21s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.09s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.85s/it]
[2024-01-18 07:45:59,748] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 42%|████▏     | 54/128 [00:00<00:00, 534.98it/s] 96%|█████████▌| 123/128 [00:00<00:00, 620.52it/s]100%|██████████| 128/128 [00:00<00:00, 610.25it/s]
[2024-01-18 07:46:00,087] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.28it/s]  2%|▏         | 2/128 [00:00<01:01,  2.06it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:01<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<00:59,  2.08it/s]  5%|▍         | 6/128 [00:02<00:59,  2.03it/s]  5%|▌         | 7/128 [00:03<00:58,  2.07it/s]  6%|▋         | 8/128 [00:03<00:55,  2.18it/s]  7%|▋         | 9/128 [00:04<00:54,  2.18it/s]  8%|▊         | 10/128 [00:04<00:56,  2.10it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:53,  2.16it/s] 10%|█         | 13/128 [00:06<00:52,  2.18it/s] 11%|█         | 14/128 [00:06<00:54,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.12it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.06it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.02it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.98it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.03it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.06it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.03it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.09it/s] 18%|█▊        | 23/128 [00:11<00:49,  2.11it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.05it/s] 20%|█▉        | 25/128 [00:11<00:48,  2.11it/s] 20%|██        | 26/128 [00:12<00:49,  2.04it/s] 21%|██        | 27/128 [00:12<00:48,  2.07it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:13<00:48,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.09it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.10it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.12it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.04it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 35/128 [00:16<00:47,  1.97it/s] 28%|██▊       | 36/128 [00:17<00:47,  1.96it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.08it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.01it/s] 30%|███       | 39/128 [00:18<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.06it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.02it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.98it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.05it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.02it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.97it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.01it/s] 38%|███▊      | 49/128 [00:23<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.03it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.06it/s] 41%|████      | 52/128 [00:25<00:35,  2.11it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.02it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.05it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.08it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.10it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.03it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.01it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.98it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.02it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.98it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:31<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.03it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.99it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.06it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.05it/s] 56%|█████▋    | 72/128 [00:35<00:29,  1.89it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.96it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.01it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.04it/s] 59%|█████▉    | 76/128 [00:37<00:25,  2.00it/s] 60%|██████    | 77/128 [00:37<00:26,  1.95it/s] 61%|██████    | 78/128 [00:38<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.93it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:40<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.04it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.01it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.07it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.02it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:43<00:19,  1.97it/s] 70%|███████   | 90/128 [00:44<00:19,  1.95it/s] 71%|███████   | 91/128 [00:44<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.00it/s] 73%|███████▎  | 93/128 [00:45<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.02it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.04it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.88it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.89it/s] 77%|███████▋  | 99/128 [00:49<00:15,  1.89it/s] 78%|███████▊  | 100/128 [00:49<00:14,  1.98it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.05it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.10it/s] 80%|████████  | 103/128 [00:50<00:11,  2.14it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.07it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.02it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.97it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.95it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.02it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.05it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.00it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.11it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.06it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.08it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.03it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.16it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.04it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.98it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.06it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  2.12it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]
[2024-01-18 07:47:03,277] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:57,  2.22it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<01:03,  1.97it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:00,  2.04it/s]  5%|▍         | 6/128 [00:02<01:00,  2.00it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<00:55,  2.15it/s]  7%|▋         | 9/128 [00:04<00:55,  2.14it/s]  8%|▊         | 10/128 [00:04<00:57,  2.07it/s]  9%|▊         | 11/128 [00:05<00:56,  2.08it/s]  9%|▉         | 12/128 [00:05<00:54,  2.12it/s] 10%|█         | 13/128 [00:06<00:53,  2.15it/s] 11%|█         | 14/128 [00:06<00:54,  2.08it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.09it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.04it/s] 13%|█▎        | 17/128 [00:08<00:55,  2.00it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.01it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.04it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.00it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.09it/s] 19%|█▉        | 24/128 [00:11<00:51,  2.03it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.09it/s] 20%|██        | 26/128 [00:12<00:50,  2.02it/s] 21%|██        | 27/128 [00:13<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.04it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.07it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.10it/s] 26%|██▌       | 33/128 [00:16<00:47,  2.02it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.97it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.95it/s] 28%|██▊       | 36/128 [00:17<00:47,  1.94it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.06it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:45,  1.97it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.04it/s] 32%|███▏      | 41/128 [00:20<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.96it/s] 34%|███▎      | 43/128 [00:21<00:41,  2.03it/s] 34%|███▍      | 44/128 [00:21<00:42,  2.00it/s] 35%|███▌      | 45/128 [00:22<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.96it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:23<00:40,  2.00it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.97it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.01it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.04it/s] 41%|████      | 52/128 [00:25<00:36,  2.10it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.00it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.04it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.07it/s] 45%|████▍     | 57/128 [00:28<00:34,  2.08it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.99it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.97it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.01it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.94it/s] 50%|█████     | 64/128 [00:31<00:33,  1.92it/s] 51%|█████     | 65/128 [00:32<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.98it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.05it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.04it/s] 56%|█████▋    | 72/128 [00:35<00:29,  1.89it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.95it/s] 58%|█████▊    | 74/128 [00:36<00:27,  2.00it/s] 59%|█████▊    | 75/128 [00:37<00:26,  2.03it/s] 59%|█████▉    | 76/128 [00:37<00:26,  2.00it/s] 60%|██████    | 77/128 [00:38<00:26,  1.95it/s] 61%|██████    | 78/128 [00:38<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:40<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.91it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.04it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.06it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.97it/s] 70%|███████   | 90/128 [00:44<00:19,  1.95it/s] 71%|███████   | 91/128 [00:45<00:18,  2.02it/s] 72%|███████▏  | 92/128 [00:45<00:18,  1.99it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.01it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.04it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.88it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.89it/s] 77%|███████▋  | 99/128 [00:49<00:15,  1.88it/s] 78%|███████▊  | 100/128 [00:49<00:14,  1.98it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.05it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.09it/s] 80%|████████  | 103/128 [00:51<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.07it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.02it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.97it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.94it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.02it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.05it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.00it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.05it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.02it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.15it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.07it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.03it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.98it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.06it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.01it/s]100%|██████████| 128/128 [01:03<00:00,  2.12it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.16s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.22s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.02s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.80s/it]
[2024-01-18 07:49:00,947] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 67/128 [00:00<00:00, 666.71it/s]100%|██████████| 128/128 [00:00<00:00, 669.87it/s]
[2024-01-18 07:49:01,273] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.29it/s]  2%|▏         | 2/128 [00:00<01:00,  2.07it/s]  2%|▏         | 3/128 [00:01<00:59,  2.11it/s]  3%|▎         | 4/128 [00:01<01:00,  2.05it/s]  4%|▍         | 5/128 [00:02<01:01,  2.01it/s]  5%|▍         | 6/128 [00:02<01:01,  1.97it/s]  5%|▌         | 7/128 [00:03<01:01,  1.96it/s]  6%|▋         | 8/128 [00:03<00:58,  2.05it/s]  7%|▋         | 9/128 [00:04<00:57,  2.08it/s]  8%|▊         | 10/128 [00:04<00:56,  2.11it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:55,  2.08it/s] 10%|█         | 13/128 [00:06<00:56,  2.04it/s] 11%|█         | 14/128 [00:06<00:56,  2.01it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.00it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.04it/s] 13%|█▎        | 17/128 [00:08<00:55,  1.99it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.03it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.07it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.09it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.09it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.18it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.11it/s] 20%|██        | 26/128 [00:12<00:48,  2.12it/s] 21%|██        | 27/128 [00:13<00:47,  2.12it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.04it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.15it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.14it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.00it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.97it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.09it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:17<00:45,  2.01it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:45,  1.98it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.95it/s] 32%|███▏      | 41/128 [00:20<00:43,  2.00it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.03it/s] 34%|███▍      | 44/128 [00:21<00:42,  2.00it/s] 35%|███▌      | 45/128 [00:22<00:44,  1.86it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.92it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.98it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.03it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.09it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.03it/s] 41%|████      | 52/128 [00:25<00:37,  2.00it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.00it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.98it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.97it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.95it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.94it/s] 47%|████▋     | 60/128 [00:29<00:35,  1.92it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.91it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.91it/s] 50%|█████     | 64/128 [00:31<00:33,  1.92it/s] 51%|█████     | 65/128 [00:32<00:30,  2.04it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.01it/s] 52%|█████▏    | 67/128 [00:33<00:28,  2.14it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:34<00:27,  2.12it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.03it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.09it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.04it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.98it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.94it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.92it/s] 60%|██████    | 77/128 [00:38<00:26,  1.92it/s] 61%|██████    | 78/128 [00:38<00:26,  1.92it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:40<00:22,  2.03it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.04it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.06it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.08it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.04it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.09it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.13it/s] 70%|███████   | 90/128 [00:44<00:18,  2.04it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.97it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.94it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.03it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.03it/s] 80%|████████  | 103/128 [00:51<00:12,  2.00it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.95it/s] 83%|████████▎ | 106/128 [00:52<00:11,  2.00it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.06it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.11it/s] 85%|████████▌ | 109/128 [00:54<00:08,  2.11it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.06it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.10it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.13it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.13it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.13it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.06it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.05it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.02it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.05it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.01it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.04it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.07it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.12it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.06it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.07it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
[2024-01-18 07:50:04,545] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:57,  2.22it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<01:00,  2.07it/s]  3%|▎         | 4/128 [00:01<01:01,  2.01it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:03<01:02,  1.94it/s]  5%|▌         | 7/128 [00:03<01:02,  1.94it/s]  6%|▋         | 8/128 [00:03<00:59,  2.02it/s]  7%|▋         | 9/128 [00:04<00:58,  2.05it/s]  8%|▊         | 10/128 [00:04<00:56,  2.07it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:56,  2.06it/s] 10%|█         | 13/128 [00:06<00:57,  2.01it/s] 11%|█         | 14/128 [00:06<00:57,  1.99it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.97it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.01it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.96it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.01it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.04it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.07it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.02it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.05it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.07it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.12it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.06it/s] 20%|██        | 26/128 [00:12<00:49,  2.08it/s] 21%|██        | 27/128 [00:13<00:48,  2.09it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:14<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.12it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.03it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 35/128 [00:17<00:44,  2.07it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.03it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.99it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.97it/s] 30%|███       | 39/128 [00:19<00:45,  1.96it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.93it/s] 32%|███▏      | 41/128 [00:20<00:43,  1.98it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.97it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:22<00:45,  1.82it/s] 36%|███▌      | 46/128 [00:22<00:43,  1.90it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.89it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.96it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.04it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.00it/s] 41%|████      | 52/128 [00:25<00:38,  1.97it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.96it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.99it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.97it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.95it/s] 45%|████▌     | 58/128 [00:28<00:36,  1.94it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.93it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.91it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.92it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.90it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.90it/s] 50%|█████     | 64/128 [00:32<00:33,  1.91it/s] 51%|█████     | 65/128 [00:32<00:31,  2.03it/s] 52%|█████▏    | 66/128 [00:33<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:33<00:28,  2.14it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.09it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.01it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.08it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.02it/s] 57%|█████▋    | 73/128 [00:36<00:27,  1.99it/s] 58%|█████▊    | 74/128 [00:37<00:27,  1.97it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.85it/s] 59%|█████▉    | 76/128 [00:38<00:28,  1.85it/s] 60%|██████    | 77/128 [00:38<00:27,  1.87it/s] 61%|██████    | 78/128 [00:39<00:26,  1.88it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.89it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:41<00:22,  2.02it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.99it/s] 66%|██████▌   | 84/128 [00:42<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.05it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.07it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.09it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.12it/s] 70%|███████   | 90/128 [00:45<00:18,  2.04it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.97it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.03it/s] 79%|███████▉  | 101/128 [00:50<00:13,  1.99it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.03it/s] 80%|████████  | 103/128 [00:51<00:12,  2.00it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.95it/s] 83%|████████▎ | 106/128 [00:53<00:11,  2.00it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.06it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.11it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.11it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.06it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.05it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.11it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.11it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.05it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.02it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.04it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.01it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.04it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.01it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.04it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.07it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.12it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.06it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.07it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]100%|██████████| 128/128 [01:03<00:00,  2.00it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.20s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.06s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.83s/it]
[2024-01-18 07:52:02,645] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 39%|███▉      | 50/128 [00:00<00:00, 495.81it/s] 93%|█████████▎| 119/128 [00:00<00:00, 608.30it/s]100%|██████████| 128/128 [00:00<00:00, 594.79it/s]
[2024-01-18 07:52:02,989] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.98it/s]  2%|▏         | 2/128 [00:00<00:56,  2.23it/s]  2%|▏         | 3/128 [00:01<00:59,  2.10it/s]  3%|▎         | 4/128 [00:01<01:00,  2.05it/s]  4%|▍         | 5/128 [00:02<01:00,  2.02it/s]  5%|▍         | 6/128 [00:02<00:58,  2.10it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<00:57,  2.08it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:54,  2.15it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:53,  2.15it/s] 10%|█         | 13/128 [00:06<00:54,  2.09it/s] 11%|█         | 14/128 [00:06<00:55,  2.05it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.00it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.04it/s] 13%|█▎        | 17/128 [00:08<00:55,  2.01it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.07it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.16it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.05it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.08it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.19it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.08it/s] 20%|██        | 26/128 [00:12<00:49,  2.05it/s] 21%|██        | 27/128 [00:12<00:48,  2.08it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.13it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.13it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  2.00it/s] 26%|██▌       | 33/128 [00:15<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.01it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.08it/s] 28%|██▊       | 36/128 [00:17<00:48,  1.92it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.91it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.92it/s] 30%|███       | 39/128 [00:19<00:46,  1.93it/s] 31%|███▏      | 40/128 [00:19<00:48,  1.82it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.91it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.90it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.91it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.91it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.97it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.07it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.10it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.03it/s] 41%|████      | 52/128 [00:25<00:37,  2.00it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.05it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.00it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.99it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.98it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.91it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.91it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.01it/s] 52%|█████▏    | 67/128 [00:33<00:28,  2.11it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.04it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.01it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.02it/s] 56%|█████▋    | 72/128 [00:35<00:28,  2.00it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.06it/s] 58%|█████▊    | 74/128 [00:36<00:28,  1.90it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.89it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.88it/s] 60%|██████    | 77/128 [00:38<00:27,  1.88it/s] 61%|██████    | 78/128 [00:38<00:26,  1.87it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.88it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.88it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.96it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.94it/s] 66%|██████▌   | 84/128 [00:42<00:22,  2.00it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.96it/s] 68%|██████▊   | 87/128 [00:43<00:21,  1.95it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.00it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.04it/s] 70%|███████   | 90/128 [00:44<00:18,  2.06it/s] 71%|███████   | 91/128 [00:45<00:18,  2.02it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.99it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.95it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.93it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.93it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.03it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.08it/s] 80%|████████  | 103/128 [00:51<00:12,  2.00it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.96it/s] 82%|████████▏ | 105/128 [00:52<00:12,  1.84it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.02it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.99it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.97it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.96it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.06it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.08it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.09it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.10it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.00it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.98it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.97it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.04it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.00it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.98it/s]100%|██████████| 128/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:04<00:00,  2.00it/s]
[2024-01-18 07:53:07,028] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.94it/s]  2%|▏         | 2/128 [00:00<00:57,  2.19it/s]  2%|▏         | 3/128 [00:01<01:00,  2.06it/s]  3%|▎         | 4/128 [00:01<01:01,  2.01it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:02<00:59,  2.06it/s]  5%|▌         | 7/128 [00:03<01:00,  2.01it/s]  6%|▋         | 8/128 [00:03<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:55,  2.11it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:54,  2.11it/s] 10%|█         | 13/128 [00:06<00:55,  2.06it/s] 11%|█         | 14/128 [00:06<00:56,  2.01it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.97it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.01it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.98it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.04it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.13it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.06it/s] 17%|█▋        | 22/128 [00:10<00:52,  2.02it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.05it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.16it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.05it/s] 20%|██        | 26/128 [00:12<00:50,  2.02it/s] 21%|██        | 27/128 [00:13<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.10it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.10it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.97it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.93it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.05it/s] 28%|██▊       | 36/128 [00:17<00:48,  1.89it/s] 29%|██▉       | 37/128 [00:18<00:48,  1.88it/s] 30%|██▉       | 38/128 [00:18<00:47,  1.89it/s] 30%|███       | 39/128 [00:19<00:46,  1.90it/s] 31%|███▏      | 40/128 [00:19<00:49,  1.80it/s] 32%|███▏      | 41/128 [00:20<00:46,  1.88it/s] 33%|███▎      | 42/128 [00:21<00:45,  1.87it/s] 34%|███▎      | 43/128 [00:21<00:45,  1.88it/s] 34%|███▍      | 44/128 [00:22<00:44,  1.90it/s] 35%|███▌      | 45/128 [00:22<00:44,  1.89it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.95it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.93it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.05it/s] 39%|███▉      | 50/128 [00:25<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.00it/s] 41%|████      | 52/128 [00:26<00:38,  1.98it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.96it/s] 42%|████▏     | 54/128 [00:27<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.98it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.96it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.95it/s] 45%|████▌     | 58/128 [00:29<00:35,  2.00it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.93it/s] 48%|████▊     | 61/128 [00:30<00:35,  1.90it/s] 48%|████▊     | 62/128 [00:31<00:35,  1.89it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.89it/s] 50%|█████     | 64/128 [00:32<00:33,  1.91it/s] 51%|█████     | 65/128 [00:32<00:32,  1.91it/s] 52%|█████▏    | 66/128 [00:33<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.10it/s] 53%|█████▎    | 68/128 [00:34<00:29,  2.03it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.00it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.95it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.98it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.04it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.88it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.88it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.86it/s] 60%|██████    | 77/128 [00:38<00:27,  1.86it/s] 61%|██████    | 78/128 [00:39<00:26,  1.86it/s] 62%|██████▏   | 79/128 [00:40<00:26,  1.86it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.86it/s] 63%|██████▎   | 81/128 [00:41<00:25,  1.88it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.94it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.95it/s] 68%|██████▊   | 87/128 [00:44<00:21,  1.94it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.03it/s] 70%|███████   | 90/128 [00:45<00:18,  2.05it/s] 71%|███████   | 91/128 [00:46<00:18,  2.01it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.98it/s] 73%|███████▎  | 93/128 [00:47<00:18,  1.94it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.92it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.91it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.91it/s] 76%|███████▌  | 97/128 [00:49<00:15,  1.97it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:50<00:14,  1.98it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.04it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.01it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.06it/s] 80%|████████  | 103/128 [00:52<00:12,  1.99it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:53<00:12,  1.83it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.97it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.01it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.98it/s] 85%|████████▌ | 109/128 [00:55<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.95it/s] 87%|████████▋ | 111/128 [00:56<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.06it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.08it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.02it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.08it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.09it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.02it/s] 93%|█████████▎| 119/128 [01:00<00:04,  2.00it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.97it/s] 95%|█████████▍| 121/128 [01:01<00:03,  1.96it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.95it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 125/128 [01:03<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:03<00:01,  2.00it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.98it/s]100%|██████████| 128/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.66s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.42s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.06s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.91s/it]
[2024-01-18 07:55:06,195] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 55%|█████▍    | 70/128 [00:00<00:00, 694.91it/s]100%|██████████| 128/128 [00:00<00:00, 687.51it/s]
[2024-01-18 07:55:06,517] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.27it/s]  2%|▏         | 2/128 [00:00<01:01,  2.03it/s]  2%|▏         | 3/128 [00:01<00:59,  2.09it/s]  3%|▎         | 4/128 [00:01<01:01,  2.03it/s]  4%|▍         | 5/128 [00:02<01:01,  2.00it/s]  5%|▍         | 6/128 [00:02<01:01,  1.98it/s]  5%|▌         | 7/128 [00:03<00:58,  2.06it/s]  6%|▋         | 8/128 [00:03<00:56,  2.12it/s]  7%|▋         | 9/128 [00:04<00:53,  2.21it/s]  8%|▊         | 10/128 [00:04<00:53,  2.20it/s]  9%|▊         | 11/128 [00:05<00:52,  2.22it/s]  9%|▉         | 12/128 [00:05<00:54,  2.12it/s] 10%|█         | 13/128 [00:06<00:53,  2.13it/s] 11%|█         | 14/128 [00:06<00:55,  2.07it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.09it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.04it/s] 13%|█▎        | 17/128 [00:08<00:55,  1.99it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.98it/s] 15%|█▍        | 19/128 [00:09<00:51,  2.10it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.14it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.14it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.08it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.13it/s] 19%|█▉        | 24/128 [00:11<00:46,  2.25it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.21it/s] 20%|██        | 26/128 [00:12<00:47,  2.13it/s] 21%|██        | 27/128 [00:12<00:47,  2.14it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.08it/s] 23%|██▎       | 29/128 [00:13<00:48,  2.03it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.10it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  2.00it/s] 26%|██▌       | 33/128 [00:15<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.96it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.01it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.05it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.01it/s] 30%|███       | 39/128 [00:18<00:43,  2.05it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.07it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.05it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.07it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.09it/s] 35%|███▌      | 45/128 [00:21<00:40,  2.04it/s] 36%|███▌      | 46/128 [00:22<00:39,  2.07it/s] 37%|███▋      | 47/128 [00:22<00:40,  2.00it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.98it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.05it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.13it/s] 41%|████      | 52/128 [00:25<00:36,  2.07it/s] 41%|████▏     | 53/128 [00:25<00:37,  2.02it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.99it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.06it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.08it/s] 45%|████▍     | 57/128 [00:27<00:32,  2.17it/s] 45%|████▌     | 58/128 [00:27<00:33,  2.09it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.04it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.07it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.02it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.96it/s] 50%|█████     | 64/128 [00:31<00:33,  1.92it/s] 51%|█████     | 65/128 [00:31<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:32<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.09it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.11it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.03it/s] 56%|█████▋    | 72/128 [00:34<00:26,  2.09it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.02it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.95it/s] 60%|██████    | 77/128 [00:37<00:26,  1.93it/s] 61%|██████    | 78/128 [00:38<00:25,  1.98it/s] 62%|██████▏   | 79/128 [00:38<00:24,  1.96it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:41<00:22,  1.95it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.94it/s] 68%|██████▊   | 87/128 [00:42<00:21,  1.93it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.94it/s] 70%|██████▉   | 89/128 [00:43<00:19,  1.99it/s] 70%|███████   | 90/128 [00:44<00:19,  1.97it/s] 71%|███████   | 91/128 [00:44<00:17,  2.08it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:45<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.02it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.00it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.98it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.95it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.94it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.00it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.03it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.06it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.15it/s] 80%|████████  | 103/128 [00:50<00:11,  2.22it/s] 81%|████████▏ | 104/128 [00:50<00:10,  2.22it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.10it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.02it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.06it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.01it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.06it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.08it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.09it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.14it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.14it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.06it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.01it/s] 93%|█████████▎| 119/128 [00:58<00:04,  1.98it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.02it/s] 95%|█████████▍| 121/128 [00:59<00:03,  1.99it/s] 95%|█████████▌| 122/128 [00:59<00:03,  1.97it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.04it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.00it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.04it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.11it/s]100%|██████████| 128/128 [01:02<00:00,  2.15it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 07:56:09,167] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:57,  2.23it/s]  2%|▏         | 2/128 [00:00<01:02,  2.00it/s]  2%|▏         | 3/128 [00:01<01:00,  2.05it/s]  3%|▎         | 4/128 [00:01<01:01,  2.00it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:03<01:02,  1.95it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:54,  2.18it/s]  8%|▊         | 10/128 [00:04<00:54,  2.16it/s]  9%|▊         | 11/128 [00:05<00:53,  2.18it/s]  9%|▉         | 12/128 [00:05<00:55,  2.10it/s] 10%|█         | 13/128 [00:06<00:54,  2.10it/s] 11%|█         | 14/128 [00:06<00:55,  2.04it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.97it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.94it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.06it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.10it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.05it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.10it/s] 19%|█▉        | 24/128 [00:11<00:46,  2.22it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.18it/s] 20%|██        | 26/128 [00:12<00:48,  2.10it/s] 21%|██        | 27/128 [00:12<00:47,  2.11it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.05it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.01it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.07it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.94it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.99it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.03it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:43,  2.03it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.06it/s] 32%|███▏      | 41/128 [00:20<00:43,  2.00it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.03it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.05it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.07it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.02it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.94it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.00it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.03it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.09it/s] 41%|████      | 52/128 [00:25<00:37,  2.04it/s] 41%|████▏     | 53/128 [00:25<00:37,  2.00it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.97it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.05it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.06it/s] 45%|████▍     | 57/128 [00:27<00:32,  2.16it/s] 45%|████▌     | 58/128 [00:28<00:33,  2.08it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.03it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.06it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.01it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:33,  1.92it/s] 51%|█████     | 65/128 [00:31<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.01it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.09it/s] 55%|█████▍    | 70/128 [00:34<00:27,  2.10it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.03it/s] 56%|█████▋    | 72/128 [00:35<00:26,  2.08it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.01it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.95it/s] 60%|██████    | 77/128 [00:37<00:26,  1.92it/s] 61%|██████    | 78/128 [00:38<00:25,  1.98it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.96it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:42<00:22,  1.95it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.94it/s] 68%|██████▊   | 87/128 [00:43<00:21,  1.93it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.93it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.99it/s] 70%|███████   | 90/128 [00:44<00:19,  1.97it/s] 71%|███████   | 91/128 [00:44<00:17,  2.08it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.03it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.00it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.98it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.94it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.00it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.03it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.06it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.15it/s] 80%|████████  | 103/128 [00:50<00:11,  2.22it/s] 81%|████████▏ | 104/128 [00:51<00:10,  2.22it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.10it/s] 83%|████████▎ | 106/128 [00:52<00:10,  2.03it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.06it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.01it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.06it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.08it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.09it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.04it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.14it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.13it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.06it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.01it/s] 93%|█████████▎| 119/128 [00:58<00:04,  1.98it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.02it/s] 95%|█████████▍| 121/128 [00:59<00:03,  1.99it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.97it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.04it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.00it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.00it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.11it/s]100%|██████████| 128/128 [01:03<00:00,  2.14it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.82s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.50s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.12s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.99s/it]
[2024-01-18 07:58:06,931] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 42%|████▏     | 54/128 [00:00<00:00, 534.66it/s] 96%|█████████▌| 123/128 [00:00<00:00, 619.64it/s]100%|██████████| 128/128 [00:00<00:00, 607.75it/s]
[2024-01-18 07:58:07,271] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.29it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<01:02,  1.99it/s]  3%|▎         | 4/128 [00:01<01:02,  1.98it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:03<01:03,  1.93it/s]  5%|▌         | 7/128 [00:03<01:02,  1.94it/s]  6%|▋         | 8/128 [00:04<01:02,  1.92it/s]  7%|▋         | 9/128 [00:04<00:57,  2.06it/s]  8%|▊         | 10/128 [00:04<00:56,  2.09it/s]  9%|▊         | 11/128 [00:05<00:55,  2.11it/s]  9%|▉         | 12/128 [00:05<00:56,  2.06it/s] 10%|█         | 13/128 [00:06<00:56,  2.03it/s] 11%|█         | 14/128 [00:06<00:57,  1.98it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.98it/s] 12%|█▎        | 16/128 [00:08<00:57,  1.95it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.93it/s] 14%|█▍        | 18/128 [00:09<00:57,  1.92it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.05it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.07it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.09it/s] 18%|█▊        | 23/128 [00:11<00:49,  2.11it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.05it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.16it/s] 20%|██        | 26/128 [00:12<00:48,  2.08it/s] 21%|██        | 27/128 [00:13<00:50,  2.02it/s] 22%|██▏       | 28/128 [00:13<00:50,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:49,  1.98it/s] 23%|██▎       | 30/128 [00:14<00:49,  1.97it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  2.00it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:17<00:48,  1.93it/s] 28%|██▊       | 36/128 [00:17<00:47,  1.94it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.92it/s] 30%|██▉       | 38/128 [00:19<00:47,  1.91it/s] 30%|███       | 39/128 [00:19<00:46,  1.91it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.92it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.92it/s] 33%|███▎      | 42/128 [00:21<00:47,  1.81it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.90it/s] 34%|███▍      | 44/128 [00:22<00:42,  1.97it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.94it/s] 36%|███▌      | 46/128 [00:23<00:40,  2.03it/s] 37%|███▋      | 47/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.96it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.94it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.03it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.00it/s] 41%|████      | 52/128 [00:26<00:38,  1.99it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.95it/s] 42%|████▏     | 54/128 [00:27<00:36,  2.00it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.04it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.99it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.97it/s] 45%|████▌     | 58/128 [00:29<00:34,  2.01it/s] 46%|████▌     | 59/128 [00:29<00:33,  2.08it/s] 47%|████▋     | 60/128 [00:30<00:32,  2.09it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.02it/s] 48%|████▊     | 62/128 [00:31<00:33,  2.00it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.96it/s] 50%|█████     | 64/128 [00:32<00:32,  1.95it/s] 51%|█████     | 65/128 [00:32<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:33<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:34<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.09it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.03it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.96it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.93it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.05it/s] 59%|█████▊    | 75/128 [00:37<00:26,  2.01it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.87it/s] 60%|██████    | 77/128 [00:38<00:27,  1.87it/s] 61%|██████    | 78/128 [00:39<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.88it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.90it/s] 64%|██████▍   | 82/128 [00:41<00:24,  1.89it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.04it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.99it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.99it/s] 70%|███████   | 90/128 [00:45<00:18,  2.06it/s] 71%|███████   | 91/128 [00:45<00:18,  2.02it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.97it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.96it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.92it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.92it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.07it/s] 78%|███████▊  | 100/128 [00:50<00:12,  2.17it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.08it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.10it/s] 80%|████████  | 103/128 [00:51<00:11,  2.10it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.04it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.01it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.96it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.94it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.99it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.97it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:55<00:08,  1.98it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.05it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.97it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.04it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.01it/s] 93%|█████████▎| 119/128 [00:59<00:04,  1.98it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.96it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.93it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.99it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.03it/s] 97%|█████████▋| 124/128 [01:02<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.97it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.98it/s]100%|██████████| 128/128 [01:04<00:00,  2.02it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
[2024-01-18 07:59:11,550] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.23it/s]  2%|▏         | 2/128 [00:00<01:03,  2.00it/s]  2%|▏         | 3/128 [00:01<01:03,  1.96it/s]  3%|▎         | 4/128 [00:02<01:03,  1.95it/s]  4%|▍         | 5/128 [00:02<01:03,  1.94it/s]  5%|▍         | 6/128 [00:03<01:03,  1.91it/s]  5%|▌         | 7/128 [00:03<01:03,  1.92it/s]  6%|▋         | 8/128 [00:04<01:03,  1.90it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:05<00:57,  2.06it/s]  9%|▊         | 11/128 [00:05<00:56,  2.08it/s]  9%|▉         | 12/128 [00:06<00:56,  2.04it/s] 10%|█         | 13/128 [00:06<00:57,  2.00it/s] 11%|█         | 14/128 [00:07<00:58,  1.96it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.95it/s] 12%|█▎        | 16/128 [00:08<00:58,  1.93it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.91it/s] 14%|█▍        | 18/128 [00:09<00:58,  1.89it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.03it/s] 16%|█▌        | 20/128 [00:10<00:51,  2.09it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:11<00:51,  2.06it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.08it/s] 19%|█▉        | 24/128 [00:12<00:51,  2.03it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.13it/s] 20%|██        | 26/128 [00:12<00:49,  2.06it/s] 21%|██        | 27/128 [00:13<00:50,  1.99it/s] 22%|██▏       | 28/128 [00:14<00:50,  1.98it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.97it/s] 23%|██▎       | 30/128 [00:15<00:50,  1.95it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.00it/s] 25%|██▌       | 32/128 [00:16<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.94it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:48,  1.91it/s] 28%|██▊       | 36/128 [00:18<00:48,  1.92it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.91it/s] 30%|██▉       | 38/128 [00:19<00:47,  1.89it/s] 30%|███       | 39/128 [00:19<00:47,  1.89it/s] 31%|███▏      | 40/128 [00:20<00:46,  1.90it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.90it/s] 33%|███▎      | 42/128 [00:21<00:47,  1.79it/s] 34%|███▎      | 43/128 [00:21<00:45,  1.88it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.95it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.93it/s] 36%|███▌      | 46/128 [00:23<00:40,  2.01it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.97it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.94it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.93it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.01it/s] 40%|███▉      | 51/128 [00:25<00:38,  1.98it/s] 41%|████      | 52/128 [00:26<00:38,  1.97it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.93it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.98it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.02it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.97it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.95it/s] 45%|████▌     | 58/128 [00:29<00:35,  2.00it/s] 46%|████▌     | 59/128 [00:29<00:33,  2.06it/s] 47%|████▋     | 60/128 [00:30<00:33,  2.02it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.97it/s] 48%|████▊     | 62/128 [00:31<00:33,  1.96it/s] 49%|████▉     | 63/128 [00:32<00:33,  1.93it/s] 50%|█████     | 64/128 [00:32<00:33,  1.93it/s] 51%|█████     | 65/128 [00:33<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:34<00:31,  1.95it/s] 53%|█████▎    | 68/128 [00:34<00:29,  2.06it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.08it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.01it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.99it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.95it/s] 57%|█████▋    | 73/128 [00:37<00:28,  1.92it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.04it/s] 59%|█████▊    | 75/128 [00:38<00:26,  2.01it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.86it/s] 60%|██████    | 77/128 [00:39<00:27,  1.87it/s] 61%|██████    | 78/128 [00:39<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:40<00:26,  1.88it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.87it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:41<00:24,  1.89it/s] 65%|██████▍   | 83/128 [00:42<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:43<00:21,  2.04it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:45<00:19,  1.99it/s] 70%|███████   | 90/128 [00:45<00:18,  2.06it/s] 71%|███████   | 91/128 [00:46<00:18,  2.01it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.97it/s] 73%|███████▎  | 93/128 [00:47<00:17,  1.96it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.92it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.92it/s] 76%|███████▌  | 97/128 [00:49<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.97it/s] 77%|███████▋  | 99/128 [00:50<00:13,  2.08it/s] 78%|███████▊  | 100/128 [00:50<00:12,  2.17it/s] 79%|███████▉  | 101/128 [00:51<00:12,  2.09it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.10it/s] 80%|████████  | 103/128 [00:52<00:11,  2.10it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.04it/s] 82%|████████▏ | 105/128 [00:53<00:11,  2.01it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.96it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.94it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.99it/s] 85%|████████▌ | 109/128 [00:55<00:09,  1.98it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.97it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.01it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.96it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.04it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.98it/s] 93%|█████████▎| 119/128 [01:00<00:04,  1.96it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.95it/s] 95%|█████████▍| 121/128 [01:01<00:03,  1.93it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.98it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:02<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:03<00:01,  1.97it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.98it/s]100%|██████████| 128/128 [01:04<00:00,  2.02it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.19s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.22s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.94s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.74s/it]
[2024-01-18 08:01:10,340] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 67/128 [00:00<00:00, 668.28it/s]100%|██████████| 128/128 [00:00<00:00, 679.61it/s]
[2024-01-18 08:01:10,665] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:05,  1.95it/s]  2%|▏         | 2/128 [00:01<01:05,  1.92it/s]  2%|▏         | 3/128 [00:01<01:04,  1.93it/s]  3%|▎         | 4/128 [00:02<01:03,  1.94it/s]  4%|▍         | 5/128 [00:02<01:01,  2.01it/s]  5%|▍         | 6/128 [00:03<01:01,  1.99it/s]  5%|▌         | 7/128 [00:03<01:01,  1.97it/s]  6%|▋         | 8/128 [00:04<01:00,  1.97it/s]  7%|▋         | 9/128 [00:04<00:57,  2.06it/s]  8%|▊         | 10/128 [00:04<00:55,  2.11it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:53,  2.16it/s] 10%|█         | 13/128 [00:06<00:55,  2.09it/s] 11%|█         | 14/128 [00:06<00:56,  2.03it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.00it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.97it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.94it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.95it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.01it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.10it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.03it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.07it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.09it/s] 20%|██        | 26/128 [00:12<00:49,  2.04it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.04it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:48,  1.99it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.95it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.93it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:48,  1.93it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.06it/s] 29%|██▉       | 37/128 [00:18<00:45,  2.00it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:45,  1.97it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.02it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.98it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.05it/s] 35%|███▌      | 45/128 [00:22<00:41,  1.99it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.98it/s] 37%|███▋      | 47/128 [00:23<00:40,  2.02it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.02it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.05it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.11it/s] 41%|████      | 52/128 [00:25<00:37,  2.04it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.07it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.02it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.99it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.96it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.95it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.94it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:29<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.92it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.92it/s] 49%|████▉     | 63/128 [00:31<00:35,  1.82it/s] 50%|█████     | 64/128 [00:32<00:34,  1.85it/s] 51%|█████     | 65/128 [00:32<00:33,  1.88it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.95it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.00it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.11it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.05it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.97it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.04it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.00it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.86it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.86it/s] 60%|██████    | 77/128 [00:38<00:27,  1.86it/s] 61%|██████    | 78/128 [00:39<00:26,  1.87it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.87it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.87it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.88it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.98it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.97it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.95it/s] 66%|██████▋   | 85/128 [00:42<00:22,  1.94it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.95it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.04it/s] 70%|███████   | 90/128 [00:45<00:18,  2.00it/s] 71%|███████   | 91/128 [00:45<00:18,  2.04it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:47<00:16,  2.05it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.89it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.90it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.05it/s] 80%|████████  | 103/128 [00:51<00:12,  2.01it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.97it/s] 82%|████████▏ | 105/128 [00:52<00:12,  1.84it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.87it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.04it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.06it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:55<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.97it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.08it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.09it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.04it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.09it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.13it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.06it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.02it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.05it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.07it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:02<00:02,  2.00it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.05it/s]100%|██████████| 128/128 [01:04<00:00,  2.00it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
[2024-01-18 08:02:14,889] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:06,  1.92it/s]  2%|▏         | 2/128 [00:01<01:06,  1.89it/s]  2%|▏         | 3/128 [00:01<01:05,  1.91it/s]  3%|▎         | 4/128 [00:02<01:04,  1.92it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:03<01:02,  1.96it/s]  5%|▌         | 7/128 [00:03<01:02,  1.95it/s]  6%|▋         | 8/128 [00:04<01:01,  1.95it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:05<00:56,  2.09it/s]  9%|▊         | 11/128 [00:05<00:55,  2.09it/s]  9%|▉         | 12/128 [00:05<00:54,  2.13it/s] 10%|█         | 13/128 [00:06<00:55,  2.06it/s] 11%|█         | 14/128 [00:06<00:56,  2.00it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.98it/s] 12%|█▎        | 16/128 [00:08<00:57,  1.94it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.92it/s] 14%|█▍        | 18/128 [00:09<00:57,  1.93it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.98it/s] 16%|█▌        | 20/128 [00:10<00:52,  2.05it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.02it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.01it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.05it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:50,  2.02it/s] 21%|██        | 27/128 [00:13<00:50,  1.99it/s] 22%|██▏       | 28/128 [00:14<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.02it/s] 23%|██▎       | 30/128 [00:14<00:49,  1.99it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.97it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.93it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.91it/s] 27%|██▋       | 34/128 [00:17<00:49,  1.91it/s] 27%|██▋       | 35/128 [00:17<00:48,  1.92it/s] 28%|██▊       | 36/128 [00:18<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.99it/s] 30%|██▉       | 38/128 [00:19<00:45,  1.97it/s] 30%|███       | 39/128 [00:19<00:45,  1.95it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.91it/s] 33%|███▎      | 42/128 [00:21<00:43,  1.98it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:22<00:42,  2.00it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.96it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.94it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.99it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.03it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.09it/s] 41%|████      | 52/128 [00:26<00:37,  2.02it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.05it/s] 42%|████▏     | 54/128 [00:27<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.98it/s] 44%|████▍     | 56/128 [00:28<00:37,  1.94it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.93it/s] 45%|████▌     | 58/128 [00:29<00:36,  1.93it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.94it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.93it/s] 48%|████▊     | 61/128 [00:30<00:35,  1.91it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.91it/s] 49%|████▉     | 63/128 [00:31<00:35,  1.81it/s] 50%|█████     | 64/128 [00:32<00:34,  1.84it/s] 51%|█████     | 65/128 [00:33<00:33,  1.87it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.94it/s] 52%|█████▏    | 67/128 [00:33<00:30,  1.99it/s] 53%|█████▎    | 68/128 [00:34<00:28,  2.10it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.04it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.01it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.97it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.96it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.03it/s] 58%|█████▊    | 74/128 [00:37<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.85it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.86it/s] 60%|██████    | 77/128 [00:39<00:27,  1.85it/s] 61%|██████    | 78/128 [00:39<00:26,  1.86it/s] 62%|██████▏   | 79/128 [00:40<00:26,  1.87it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.87it/s] 63%|██████▎   | 81/128 [00:41<00:25,  1.88it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:42<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.95it/s] 66%|██████▋   | 85/128 [00:43<00:22,  1.94it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.94it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.04it/s] 70%|███████   | 90/128 [00:45<00:19,  1.99it/s] 71%|███████   | 91/128 [00:46<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:47<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:47<00:16,  2.05it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.88it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.90it/s] 76%|███████▌  | 97/128 [00:49<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.95it/s] 77%|███████▋  | 99/128 [00:50<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.05it/s] 80%|████████  | 103/128 [00:52<00:12,  2.01it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.96it/s] 82%|████████▏ | 105/128 [00:53<00:12,  1.84it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.86it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.03it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.06it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.96it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.08it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.08it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.03it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.09it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.12it/s] 93%|█████████▎| 119/128 [01:00<00:04,  2.05it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.02it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.04it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.06it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:02<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:03<00:01,  2.05it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:04<00:00,  2.05it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.22s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.59s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.26s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.04s/it]
[2024-01-18 08:04:14,428] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 39%|███▉      | 50/128 [00:00<00:00, 498.74it/s] 95%|█████████▍| 121/128 [00:00<00:00, 618.70it/s]100%|██████████| 128/128 [00:00<00:00, 602.34it/s]
[2024-01-18 08:04:14,769] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.28it/s]  2%|▏         | 2/128 [00:00<01:01,  2.04it/s]  2%|▏         | 3/128 [00:01<00:58,  2.14it/s]  3%|▎         | 4/128 [00:01<01:00,  2.05it/s]  4%|▍         | 5/128 [00:02<01:01,  2.01it/s]  5%|▍         | 6/128 [00:02<01:01,  1.97it/s]  5%|▌         | 7/128 [00:03<01:01,  1.97it/s]  6%|▋         | 8/128 [00:03<01:01,  1.96it/s]  7%|▋         | 9/128 [00:04<00:58,  2.02it/s]  8%|▊         | 10/128 [00:04<00:55,  2.13it/s]  9%|▊         | 11/128 [00:05<00:56,  2.07it/s]  9%|▉         | 12/128 [00:05<00:55,  2.09it/s] 10%|█         | 13/128 [00:06<00:56,  2.05it/s] 11%|█         | 14/128 [00:06<00:56,  2.02it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.98it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.97it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.97it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.05it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.00it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.02it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.13it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.17it/s] 20%|██        | 26/128 [00:12<00:48,  2.10it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:14<00:49,  1.98it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.03it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.06it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.02it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:50,  1.85it/s] 27%|██▋       | 35/128 [00:17<00:49,  1.88it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.98it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.97it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.98it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.97it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.02it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.99it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:22<00:41,  2.02it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.97it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.96it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.08it/s] 39%|███▉      | 50/128 [00:24<00:35,  2.17it/s] 40%|███▉      | 51/128 [00:25<00:35,  2.16it/s] 41%|████      | 52/128 [00:25<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.03it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.99it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.97it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.96it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.96it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.95it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.03it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.00it/s] 48%|████▊     | 61/128 [00:30<00:33,  1.98it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.93it/s] 50%|█████     | 64/128 [00:31<00:33,  1.94it/s] 51%|█████     | 65/128 [00:32<00:31,  2.01it/s] 52%|█████▏    | 66/128 [00:32<00:29,  2.08it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.03it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.14it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.06it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.03it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.97it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.94it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.02it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.99it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.95it/s] 60%|██████    | 77/128 [00:38<00:26,  1.93it/s] 61%|██████    | 78/128 [00:38<00:25,  1.98it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.95it/s] 62%|██████▎   | 80/128 [00:39<00:24,  2.00it/s] 63%|██████▎   | 81/128 [00:40<00:23,  2.03it/s] 64%|██████▍   | 82/128 [00:40<00:22,  2.06it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.09it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:43<00:19,  2.06it/s] 69%|██████▉   | 88/128 [00:43<00:18,  2.16it/s] 70%|██████▉   | 89/128 [00:44<00:17,  2.18it/s] 70%|███████   | 90/128 [00:44<00:18,  2.09it/s] 71%|███████   | 91/128 [00:45<00:18,  2.04it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.07it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.94it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.97it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.09it/s] 78%|███████▊  | 100/128 [00:49<00:12,  2.17it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.09it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.10it/s] 80%|████████  | 103/128 [00:50<00:11,  2.14it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.07it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.00it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.97it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.95it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.07it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.08it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.09it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.10it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.12it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.07it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.02it/s] 91%|█████████▏| 117/128 [00:57<00:05,  1.99it/s] 92%|█████████▏| 118/128 [00:58<00:05,  1.95it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.03it/s] 94%|█████████▍| 120/128 [00:59<00:04,  1.99it/s] 95%|█████████▍| 121/128 [00:59<00:03,  1.97it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.94it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.02it/s] 98%|█████████▊| 125/128 [01:01<00:01,  1.99it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.10it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.04it/s]100%|██████████| 128/128 [01:03<00:00,  2.06it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
[2024-01-18 08:05:18,087] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.23it/s]  2%|▏         | 2/128 [00:00<01:02,  2.00it/s]  2%|▏         | 3/128 [00:01<00:59,  2.09it/s]  3%|▎         | 4/128 [00:01<01:01,  2.01it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:03<01:03,  1.93it/s]  5%|▌         | 7/128 [00:03<01:02,  1.93it/s]  6%|▋         | 8/128 [00:04<01:02,  1.92it/s]  7%|▋         | 9/128 [00:04<01:00,  1.98it/s]  8%|▊         | 10/128 [00:04<00:56,  2.09it/s]  9%|▊         | 11/128 [00:05<00:57,  2.03it/s]  9%|▉         | 12/128 [00:05<00:56,  2.06it/s] 10%|█         | 13/128 [00:06<00:57,  2.01it/s] 11%|█         | 14/128 [00:06<00:57,  1.98it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.02it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.99it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.94it/s] 14%|█▍        | 18/128 [00:09<00:56,  1.94it/s] 15%|█▍        | 19/128 [00:09<00:56,  1.94it/s] 16%|█▌        | 20/128 [00:10<00:53,  2.01it/s] 16%|█▋        | 21/128 [00:10<00:54,  1.96it/s] 17%|█▋        | 22/128 [00:11<00:52,  2.03it/s] 18%|█▊        | 23/128 [00:11<00:52,  1.99it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.09it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.13it/s] 20%|██        | 26/128 [00:12<00:49,  2.06it/s] 21%|██        | 27/128 [00:13<00:50,  1.99it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.95it/s] 23%|██▎       | 30/128 [00:14<00:49,  2.00it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.94it/s] 27%|██▋       | 34/128 [00:17<00:51,  1.82it/s] 27%|██▋       | 35/128 [00:17<00:50,  1.85it/s] 28%|██▊       | 36/128 [00:18<00:47,  1.95it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.93it/s] 30%|██▉       | 38/128 [00:19<00:46,  1.93it/s] 30%|███       | 39/128 [00:19<00:44,  1.98it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:21<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:22<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.93it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.05it/s] 39%|███▉      | 50/128 [00:25<00:36,  2.14it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.13it/s] 41%|████      | 52/128 [00:26<00:37,  2.05it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.00it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.97it/s] 43%|████▎     | 55/128 [00:27<00:37,  1.95it/s] 44%|████▍     | 56/128 [00:28<00:37,  1.94it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.93it/s] 45%|████▌     | 58/128 [00:29<00:36,  1.92it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.94it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.91it/s] 50%|█████     | 64/128 [00:32<00:33,  1.91it/s] 51%|█████     | 65/128 [00:32<00:31,  1.99it/s] 52%|█████▏    | 66/128 [00:33<00:30,  2.05it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.01it/s] 53%|█████▎    | 68/128 [00:34<00:28,  2.12it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.06it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.99it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.96it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.92it/s] 58%|█████▊    | 74/128 [00:37<00:26,  2.00it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:38<00:26,  1.93it/s] 60%|██████    | 77/128 [00:38<00:26,  1.91it/s] 61%|██████    | 78/128 [00:39<00:25,  1.97it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.93it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.98it/s] 63%|██████▎   | 81/128 [00:40<00:23,  2.02it/s] 64%|██████▍   | 82/128 [00:41<00:22,  2.04it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.03it/s] 67%|██████▋   | 86/128 [00:43<00:21,  2.00it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.08it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.12it/s] 70%|███████   | 90/128 [00:45<00:18,  2.05it/s] 71%|███████   | 91/128 [00:45<00:18,  2.01it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.96it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.93it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.92it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.97it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.07it/s] 78%|███████▊  | 100/128 [00:50<00:12,  2.16it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.08it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.09it/s] 80%|████████  | 103/128 [00:51<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.06it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.98it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.96it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.94it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.06it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.07it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.08it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.97it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.08it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.05it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.00it/s] 91%|█████████▏| 117/128 [00:58<00:05,  1.97it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.94it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.01it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.98it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.96it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.93it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.01it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.98it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.09it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.03it/s]100%|██████████| 128/128 [01:04<00:00,  2.05it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.16s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.21s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.99s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.77s/it]
[2024-01-18 08:07:16,394] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 55%|█████▍    | 70/128 [00:00<00:00, 689.05it/s]100%|██████████| 128/128 [00:00<00:00, 691.80it/s]
[2024-01-18 08:07:16,716] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:51,  2.45it/s]  2%|▏         | 2/128 [00:00<01:00,  2.09it/s]  2%|▏         | 3/128 [00:01<01:01,  2.03it/s]  3%|▎         | 4/128 [00:01<00:59,  2.08it/s]  4%|▍         | 5/128 [00:02<01:00,  2.03it/s]  5%|▍         | 6/128 [00:02<00:59,  2.06it/s]  5%|▌         | 7/128 [00:03<00:57,  2.12it/s]  6%|▋         | 8/128 [00:03<00:56,  2.12it/s]  7%|▋         | 9/128 [00:04<00:55,  2.13it/s]  8%|▊         | 10/128 [00:04<00:54,  2.17it/s]  9%|▊         | 11/128 [00:05<00:53,  2.20it/s]  9%|▉         | 12/128 [00:05<00:53,  2.18it/s] 10%|█         | 13/128 [00:06<00:52,  2.21it/s] 11%|█         | 14/128 [00:06<00:53,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.12it/s] 12%|█▎        | 16/128 [00:07<00:51,  2.16it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.06it/s] 14%|█▍        | 18/128 [00:08<00:52,  2.09it/s] 15%|█▍        | 19/128 [00:08<00:51,  2.10it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.19it/s] 16%|█▋        | 21/128 [00:09<00:49,  2.18it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.19it/s] 18%|█▊        | 23/128 [00:10<00:47,  2.21it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.19it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.21it/s] 20%|██        | 26/128 [00:12<00:48,  2.12it/s] 21%|██        | 27/128 [00:12<00:48,  2.07it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.04it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.14it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.14it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.05it/s] 26%|██▌       | 33/128 [00:15<00:47,  2.02it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.06it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.02it/s] 29%|██▉       | 37/128 [00:17<00:42,  2.13it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.05it/s] 30%|███       | 39/128 [00:18<00:44,  2.00it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:19<00:45,  1.93it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.93it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.93it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.93it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.03it/s] 38%|███▊      | 49/128 [00:23<00:37,  2.09it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.10it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.14it/s] 41%|████      | 52/128 [00:24<00:35,  2.14it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.13it/s] 42%|████▏     | 54/128 [00:25<00:34,  2.13it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.21it/s] 44%|████▍     | 56/128 [00:26<00:32,  2.21it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.13it/s] 45%|████▌     | 58/128 [00:27<00:33,  2.07it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.05it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.08it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.00it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.98it/s] 50%|█████     | 64/128 [00:30<00:32,  1.94it/s] 51%|█████     | 65/128 [00:31<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.94it/s] 52%|█████▏    | 67/128 [00:32<00:30,  1.99it/s] 53%|█████▎    | 68/128 [00:32<00:30,  1.98it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.12it/s] 55%|█████▍    | 70/128 [00:33<00:28,  2.06it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.08it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.00it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.11it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.04it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.06it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.02it/s] 60%|██████    | 77/128 [00:37<00:25,  1.97it/s] 61%|██████    | 78/128 [00:37<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:40<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.04it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.10it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.04it/s] 69%|██████▉   | 88/128 [00:42<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.07it/s] 70%|███████   | 90/128 [00:43<00:17,  2.11it/s] 71%|███████   | 91/128 [00:44<00:17,  2.11it/s] 72%|███████▏  | 92/128 [00:44<00:16,  2.12it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.06it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.08it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.02it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.05it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.00it/s] 77%|███████▋  | 98/128 [00:47<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.04it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.07it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.11it/s] 80%|███████▉  | 102/128 [00:49<00:11,  2.19it/s] 80%|████████  | 103/128 [00:49<00:11,  2.17it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.18it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.16it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.06it/s] 84%|████████▎ | 107/128 [00:51<00:10,  2.02it/s] 84%|████████▍ | 108/128 [00:52<00:10,  1.99it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.02it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.08it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.09it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.10it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.05it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.16it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.15it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.17it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.15it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.17it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.19it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.16it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.14it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.07it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.11it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.09it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.17it/s]100%|██████████| 128/128 [01:01<00:00,  2.16it/s]100%|██████████| 128/128 [01:01<00:00,  2.07it/s]
[2024-01-18 08:08:18,514] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.24it/s]  2%|▏         | 2/128 [00:00<01:02,  2.00it/s]  2%|▏         | 3/128 [00:01<01:03,  1.97it/s]  3%|▎         | 4/128 [00:01<01:01,  2.02it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:03<01:02,  1.96it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:55,  2.12it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:54,  2.14it/s] 10%|█         | 13/128 [00:06<00:53,  2.16it/s] 11%|█         | 14/128 [00:06<00:54,  2.08it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.09it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.12it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.03it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.05it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.07it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.16it/s] 16%|█▋        | 21/128 [00:10<00:49,  2.15it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.16it/s] 18%|█▊        | 23/128 [00:10<00:48,  2.18it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.16it/s] 20%|█▉        | 25/128 [00:11<00:47,  2.18it/s] 20%|██        | 26/128 [00:12<00:48,  2.10it/s] 21%|██        | 27/128 [00:12<00:49,  2.04it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.07it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.11it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.03it/s] 26%|██▌       | 33/128 [00:15<00:47,  2.00it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.99it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.10it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.02it/s] 30%|███       | 39/128 [00:18<00:44,  1.98it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:19<00:45,  1.91it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.92it/s] 34%|███▎      | 43/128 [00:20<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.92it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.97it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.02it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.07it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.09it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.13it/s] 41%|████      | 52/128 [00:25<00:35,  2.12it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.08it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.16it/s] 44%|████▍     | 56/128 [00:27<00:33,  2.18it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.10it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.05it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.01it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.04it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.06it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.90it/s] 49%|████▉     | 63/128 [00:30<00:34,  1.90it/s] 50%|█████     | 64/128 [00:31<00:33,  1.89it/s] 51%|█████     | 65/128 [00:31<00:33,  1.90it/s] 52%|█████▏    | 66/128 [00:32<00:32,  1.91it/s] 52%|█████▏    | 67/128 [00:32<00:30,  1.97it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.96it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.11it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.05it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.08it/s] 56%|█████▋    | 72/128 [00:35<00:28,  2.00it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.11it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.03it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.00it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:26,  1.94it/s] 61%|██████    | 78/128 [00:38<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.05it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.10it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.05it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.07it/s] 70%|███████   | 90/128 [00:44<00:17,  2.12it/s] 71%|███████   | 91/128 [00:44<00:17,  2.12it/s] 72%|███████▏  | 92/128 [00:45<00:16,  2.12it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.06it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.08it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.03it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.05it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.01it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.05it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.07it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.12it/s] 80%|███████▉  | 102/128 [00:50<00:11,  2.20it/s] 80%|████████  | 103/128 [00:50<00:11,  2.17it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.16it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.15it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.05it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.02it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.99it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.03it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.09it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.10it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.11it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.06it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:56<00:05,  2.17it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.16it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.18it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.16it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.18it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.20it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.17it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.15it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.08it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.12it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.04it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.10it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.14it/s]100%|██████████| 128/128 [01:02<00:00,  2.14it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.17s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.66s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.54s/it]
[2024-01-18 08:10:14,249] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 42%|████▏     | 54/128 [00:00<00:00, 535.35it/s] 97%|█████████▋| 124/128 [00:00<00:00, 629.50it/s]100%|██████████| 128/128 [00:00<00:00, 613.30it/s]
[2024-01-18 08:10:14,588] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.98it/s]  2%|▏         | 2/128 [00:01<01:04,  1.95it/s]  2%|▏         | 3/128 [00:01<01:04,  1.95it/s]  3%|▎         | 4/128 [00:02<01:04,  1.92it/s]  4%|▍         | 5/128 [00:02<01:01,  2.00it/s]  5%|▍         | 6/128 [00:03<01:01,  1.98it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:04<01:00,  1.97it/s]  7%|▋         | 9/128 [00:04<00:58,  2.05it/s]  8%|▊         | 10/128 [00:04<00:56,  2.08it/s]  9%|▊         | 11/128 [00:05<00:55,  2.10it/s]  9%|▉         | 12/128 [00:05<00:54,  2.12it/s] 10%|█         | 13/128 [00:06<00:55,  2.06it/s] 11%|█         | 14/128 [00:06<00:56,  2.01it/s] 12%|█▏        | 15/128 [00:07<00:56,  1.99it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.97it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.95it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.00it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.05it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.04it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:12<00:46,  2.21it/s] 20%|██        | 26/128 [00:12<00:48,  2.10it/s] 21%|██        | 27/128 [00:13<00:49,  2.06it/s] 22%|██▏       | 28/128 [00:13<00:50,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.98it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.09it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.11it/s] 26%|██▌       | 33/128 [00:16<00:46,  2.03it/s] 27%|██▋       | 34/128 [00:16<00:47,  2.00it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.01it/s] 29%|██▉       | 37/128 [00:18<00:42,  2.15it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.95it/s] 30%|███       | 39/128 [00:19<00:46,  1.93it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.92it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.90it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.95it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:23<00:43,  1.83it/s] 38%|███▊      | 49/128 [00:24<00:42,  1.86it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.96it/s] 40%|███▉      | 51/128 [00:25<00:39,  1.95it/s] 41%|████      | 52/128 [00:25<00:39,  1.94it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.94it/s] 42%|████▏     | 54/128 [00:27<00:38,  1.94it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.99it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.97it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.00it/s] 48%|████▊     | 62/128 [00:31<00:33,  1.96it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.96it/s] 50%|█████     | 64/128 [00:32<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:34,  1.82it/s] 52%|█████▏    | 66/128 [00:33<00:33,  1.85it/s] 52%|█████▏    | 67/128 [00:33<00:32,  1.87it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.94it/s] 54%|█████▍    | 69/128 [00:34<00:30,  1.94it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.06it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.97it/s] 57%|█████▋    | 73/128 [00:36<00:29,  1.85it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.87it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.90it/s] 59%|█████▉    | 76/128 [00:38<00:25,  2.06it/s] 60%|██████    | 77/128 [00:38<00:25,  2.01it/s] 61%|██████    | 78/128 [00:39<00:26,  1.86it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.87it/s] 62%|██████▎   | 80/128 [00:40<00:27,  1.78it/s] 63%|██████▎   | 81/128 [00:41<00:25,  1.82it/s] 64%|██████▍   | 82/128 [00:41<00:25,  1.84it/s] 65%|██████▍   | 83/128 [00:42<00:24,  1.85it/s] 66%|██████▌   | 84/128 [00:42<00:23,  1.87it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.96it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.98it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.02it/s] 70%|██████▉   | 89/128 [00:45<00:19,  1.99it/s] 70%|███████   | 90/128 [00:45<00:18,  2.03it/s] 71%|███████   | 91/128 [00:46<00:18,  2.05it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.08it/s] 73%|███████▎  | 93/128 [00:47<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.99it/s] 74%|███████▍  | 95/128 [00:48<00:16,  1.98it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.96it/s] 76%|███████▌  | 97/128 [00:49<00:16,  1.93it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.93it/s] 77%|███████▋  | 99/128 [00:50<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:50<00:14,  1.98it/s] 79%|███████▉  | 101/128 [00:51<00:12,  2.09it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.10it/s] 80%|████████  | 103/128 [00:51<00:11,  2.10it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.05it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.99it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.94it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.94it/s] 85%|████████▌ | 109/128 [00:55<00:09,  1.94it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.99it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.97it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.01it/s] 88%|████████▊ | 113/128 [00:57<00:07,  1.99it/s] 89%|████████▉ | 114/128 [00:57<00:07,  1.96it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.08it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.01it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.12it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.05it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.10it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.10it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.11it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.05it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.10it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.10it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.04it/s]100%|██████████| 128/128 [01:04<00:00,  2.00it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
[2024-01-18 08:11:18,984] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.95it/s]  2%|▏         | 2/128 [00:01<01:05,  1.93it/s]  2%|▏         | 3/128 [00:01<01:05,  1.92it/s]  3%|▎         | 4/128 [00:02<01:05,  1.90it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:03<01:02,  1.94it/s]  5%|▌         | 7/128 [00:03<01:02,  1.94it/s]  6%|▋         | 8/128 [00:04<01:01,  1.94it/s]  7%|▋         | 9/128 [00:04<00:58,  2.02it/s]  8%|▊         | 10/128 [00:05<00:57,  2.05it/s]  9%|▊         | 11/128 [00:05<00:56,  2.07it/s]  9%|▉         | 12/128 [00:05<00:55,  2.09it/s] 10%|█         | 13/128 [00:06<00:56,  2.03it/s] 11%|█         | 14/128 [00:07<00:57,  1.98it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.96it/s] 12%|█▎        | 16/128 [00:08<00:57,  1.95it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.93it/s] 14%|█▍        | 18/128 [00:09<00:55,  1.98it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.02it/s] 16%|█▌        | 20/128 [00:10<00:52,  2.06it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.02it/s] 17%|█▋        | 22/128 [00:11<00:51,  2.05it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.02it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.07it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.18it/s] 20%|██        | 26/128 [00:12<00:49,  2.08it/s] 21%|██        | 27/128 [00:13<00:49,  2.04it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.98it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.96it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.08it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.09it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.10it/s] 26%|██▌       | 33/128 [00:16<00:47,  2.01it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:46,  2.00it/s] 29%|██▉       | 37/128 [00:18<00:42,  2.14it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.93it/s] 30%|███       | 39/128 [00:19<00:46,  1.92it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.93it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.91it/s] 33%|███▎      | 42/128 [00:21<00:45,  1.89it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.95it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.92it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:24<00:43,  1.82it/s] 38%|███▊      | 49/128 [00:24<00:42,  1.84it/s] 39%|███▉      | 50/128 [00:25<00:40,  1.95it/s] 40%|███▉      | 51/128 [00:25<00:39,  1.94it/s] 41%|████      | 52/128 [00:26<00:39,  1.93it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.93it/s] 42%|████▏     | 54/128 [00:27<00:38,  1.92it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.98it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.96it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:33,  1.99it/s] 48%|████▊     | 62/128 [00:31<00:33,  1.96it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.95it/s] 50%|█████     | 64/128 [00:32<00:33,  1.92it/s] 51%|█████     | 65/128 [00:33<00:34,  1.81it/s] 52%|█████▏    | 66/128 [00:33<00:33,  1.84it/s] 52%|█████▏    | 67/128 [00:34<00:32,  1.86it/s] 53%|█████▎    | 68/128 [00:34<00:31,  1.94it/s] 54%|█████▍    | 69/128 [00:35<00:30,  1.93it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.06it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.99it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.97it/s] 57%|█████▋    | 73/128 [00:37<00:29,  1.84it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.87it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.89it/s] 59%|█████▉    | 76/128 [00:38<00:25,  2.05it/s] 60%|██████    | 77/128 [00:39<00:25,  2.00it/s] 61%|██████    | 78/128 [00:39<00:26,  1.86it/s] 62%|██████▏   | 79/128 [00:40<00:26,  1.86it/s] 62%|██████▎   | 80/128 [00:40<00:27,  1.77it/s] 63%|██████▎   | 81/128 [00:41<00:25,  1.82it/s] 64%|██████▍   | 82/128 [00:41<00:25,  1.83it/s] 65%|██████▍   | 83/128 [00:42<00:24,  1.84it/s] 66%|██████▌   | 84/128 [00:42<00:23,  1.88it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:45<00:19,  1.98it/s] 70%|███████   | 90/128 [00:45<00:18,  2.02it/s] 71%|███████   | 91/128 [00:46<00:18,  2.05it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.07it/s] 73%|███████▎  | 93/128 [00:47<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.99it/s] 74%|███████▍  | 95/128 [00:48<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:49<00:16,  1.93it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.93it/s] 77%|███████▋  | 99/128 [00:50<00:14,  1.98it/s] 78%|███████▊  | 100/128 [00:50<00:14,  1.97it/s] 79%|███████▉  | 101/128 [00:51<00:12,  2.08it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.09it/s] 80%|████████  | 103/128 [00:52<00:12,  2.04it/s] 81%|████████▏ | 104/128 [00:52<00:11,  2.00it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.96it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.95it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.92it/s] 84%|████████▍ | 108/128 [00:55<00:10,  1.92it/s] 85%|████████▌ | 109/128 [00:55<00:09,  1.93it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.96it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.01it/s] 88%|████████▊ | 113/128 [00:57<00:07,  1.98it/s] 89%|████████▉ | 114/128 [00:58<00:07,  1.96it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.08it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.01it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.11it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.06it/s] 93%|█████████▎| 119/128 [01:00<00:04,  2.11it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.05it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.07it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.07it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.09it/s] 98%|█████████▊| 125/128 [01:03<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:04<00:00,  2.03it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]100%|██████████| 128/128 [01:04<00:00,  1.97it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:07<00:15,  7.58s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:11<00:05,  5.64s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  4.54s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.03s/it]
[2024-01-18 08:13:18,661] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 53%|█████▎    | 68/128 [00:00<00:00, 673.49it/s]100%|██████████| 128/128 [00:00<00:00, 672.11it/s]
[2024-01-18 08:13:18,990] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.27it/s]  2%|▏         | 2/128 [00:00<01:01,  2.06it/s]  2%|▏         | 3/128 [00:01<01:01,  2.02it/s]  3%|▎         | 4/128 [00:01<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<01:03,  1.95it/s]  5%|▍         | 6/128 [00:02<00:59,  2.05it/s]  5%|▌         | 7/128 [00:03<00:59,  2.02it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:58,  2.04it/s]  8%|▊         | 10/128 [00:04<00:56,  2.08it/s]  9%|▊         | 11/128 [00:05<00:53,  2.18it/s]  9%|▉         | 12/128 [00:05<00:53,  2.17it/s] 10%|█         | 13/128 [00:06<00:53,  2.16it/s] 11%|█         | 14/128 [00:06<00:52,  2.15it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.08it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.13it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.05it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.02it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.09it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.12it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.13it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.14it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.17it/s] 20%|█▉        | 25/128 [00:11<00:49,  2.08it/s] 20%|██        | 26/128 [00:12<00:48,  2.10it/s] 21%|██        | 27/128 [00:12<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.05it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.02it/s] 26%|██▌       | 33/128 [00:15<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.18it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.08it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.04it/s] 30%|███       | 39/128 [00:18<00:42,  2.07it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.03it/s] 32%|███▏      | 41/128 [00:19<00:43,  1.98it/s] 33%|███▎      | 42/128 [00:20<00:41,  2.05it/s] 34%|███▎      | 43/128 [00:20<00:42,  2.01it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.08it/s] 35%|███▌      | 45/128 [00:21<00:40,  2.04it/s] 36%|███▌      | 46/128 [00:22<00:40,  2.01it/s] 37%|███▋      | 47/128 [00:22<00:40,  1.99it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:23<00:37,  2.09it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.04it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.14it/s] 41%|████      | 52/128 [00:25<00:35,  2.14it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.02it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.05it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.02it/s] 45%|████▍     | 57/128 [00:27<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.97it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.06it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.03it/s] 48%|████▊     | 62/128 [00:30<00:32,  2.00it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.97it/s] 50%|█████     | 64/128 [00:31<00:32,  1.96it/s] 51%|█████     | 65/128 [00:31<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:32<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.07it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.02it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.13it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.06it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.98it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.05it/s] 58%|█████▊    | 74/128 [00:36<00:25,  2.10it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.05it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:25,  1.97it/s] 61%|██████    | 78/128 [00:38<00:25,  1.96it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.96it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.95it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.95it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.94it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.99it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.09it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.05it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.10it/s] 70%|███████   | 90/128 [00:44<00:18,  2.05it/s] 71%|███████   | 91/128 [00:44<00:17,  2.07it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:45<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.97it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.94it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.94it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.94it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.10it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.11it/s] 80%|████████  | 103/128 [00:50<00:11,  2.11it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.12it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.03it/s] 83%|████████▎ | 106/128 [00:51<00:11,  1.99it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.11it/s] 85%|████████▌ | 109/128 [00:53<00:08,  2.11it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.05it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.07it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.01it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.11it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.12it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.05it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.12it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.12it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.05it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.02it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.00it/s] 95%|█████████▌| 122/128 [00:59<00:03,  1.97it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.96it/s] 97%|█████████▋| 124/128 [01:00<00:02,  1.95it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:01<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.03it/s]100%|██████████| 128/128 [01:02<00:00,  1.97it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 08:14:21,760] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.23it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<01:02,  1.99it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:04,  1.92it/s]  5%|▍         | 6/128 [00:02<01:00,  2.01it/s]  5%|▌         | 7/128 [00:03<01:00,  1.99it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:59,  2.01it/s]  8%|▊         | 10/128 [00:04<00:57,  2.05it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:54,  2.14it/s] 10%|█         | 13/128 [00:06<00:53,  2.13it/s] 11%|█         | 14/128 [00:06<00:53,  2.12it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.05it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.10it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.03it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.06it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.10it/s] 18%|█▊        | 23/128 [00:11<00:49,  2.10it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.14it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.05it/s] 20%|██        | 26/128 [00:12<00:49,  2.07it/s] 21%|██        | 27/128 [00:13<00:50,  2.02it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.98it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.02it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.01it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.15it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.06it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.02it/s] 30%|███       | 39/128 [00:19<00:43,  2.05it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.01it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.96it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.03it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.99it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.03it/s] 35%|███▌      | 45/128 [00:22<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.98it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.06it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.12it/s] 41%|████      | 52/128 [00:25<00:35,  2.12it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.03it/s] 42%|████▏     | 54/128 [00:26<00:37,  2.00it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.03it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.99it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.96it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.95it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.04it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.00it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.98it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:33,  1.94it/s] 51%|█████     | 65/128 [00:32<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.05it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.00it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.11it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.04it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.96it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.03it/s] 58%|█████▊    | 74/128 [00:36<00:25,  2.08it/s] 59%|█████▊    | 75/128 [00:37<00:26,  2.02it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.86it/s] 60%|██████    | 77/128 [00:38<00:27,  1.88it/s] 61%|██████    | 78/128 [00:38<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.97it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.07it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.00it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.03it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.09it/s] 70%|███████   | 90/128 [00:44<00:18,  2.03it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.96it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.93it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.93it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.98it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.07it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.08it/s] 80%|████████  | 103/128 [00:51<00:11,  2.09it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.10it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.02it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.11it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.05it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.00it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:55<00:08,  1.98it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.09it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.04it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.00it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.07it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.08it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.03it/s] 94%|█████████▍| 120/128 [00:59<00:04,  2.00it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.98it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.95it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.95it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:02<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.03it/s]100%|██████████| 128/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:06<00:13,  6.81s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:11<00:05,  5.34s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.68s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.73s/it]
[2024-01-18 08:16:22,278] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 41%|████      | 52/128 [00:00<00:00, 512.81it/s] 95%|█████████▍| 121/128 [00:00<00:00, 615.22it/s]100%|██████████| 128/128 [00:00<00:00, 601.67it/s]
[2024-01-18 08:16:22,619] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:01<01:04,  1.95it/s]  2%|▏         | 3/128 [00:01<01:03,  1.96it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:00,  2.02it/s]  5%|▍         | 6/128 [00:03<01:00,  2.00it/s]  5%|▌         | 7/128 [00:03<01:00,  1.99it/s]  6%|▋         | 8/128 [00:04<01:00,  1.98it/s]  7%|▋         | 9/128 [00:04<00:57,  2.06it/s]  8%|▊         | 10/128 [00:04<00:54,  2.17it/s]  9%|▊         | 11/128 [00:05<00:54,  2.16it/s]  9%|▉         | 12/128 [00:05<00:56,  2.07it/s] 10%|█         | 13/128 [00:06<00:54,  2.09it/s] 11%|█         | 14/128 [00:06<00:56,  2.02it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.88it/s] 14%|█▍        | 18/128 [00:08<00:57,  1.90it/s] 15%|█▍        | 19/128 [00:09<00:56,  1.92it/s] 16%|█▌        | 20/128 [00:09<00:53,  2.02it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.00it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.05it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.02it/s] 19%|█▉        | 24/128 [00:11<00:51,  2.01it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.12it/s] 20%|██        | 26/128 [00:12<00:49,  2.06it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.05it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.10it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.03it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.96it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.08it/s] 29%|██▉       | 37/128 [00:18<00:45,  2.01it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:44,  1.98it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.96it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.04it/s] 34%|███▎      | 43/128 [00:21<00:42,  2.01it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.99it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.96it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.02it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.99it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.06it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.03it/s] 41%|████      | 52/128 [00:25<00:37,  2.00it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.99it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.97it/s] 43%|████▎     | 55/128 [00:27<00:37,  1.96it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.96it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.94it/s] 45%|████▌     | 58/128 [00:28<00:36,  1.94it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.99it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.98it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.95it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.92it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.92it/s] 50%|█████     | 64/128 [00:32<00:33,  1.91it/s] 51%|█████     | 65/128 [00:32<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.93it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.93it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.99it/s] 54%|█████▍    | 69/128 [00:34<00:30,  1.96it/s] 55%|█████▍    | 70/128 [00:35<00:30,  1.92it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.92it/s] 56%|█████▋    | 72/128 [00:36<00:29,  1.92it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.05it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.89it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.90it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.90it/s] 60%|██████    | 77/128 [00:38<00:26,  1.91it/s] 61%|██████    | 78/128 [00:39<00:26,  1.90it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.95it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.00it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.04it/s] 70%|███████   | 90/128 [00:45<00:19,  2.00it/s] 71%|███████   | 91/128 [00:45<00:18,  1.97it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.97it/s] 73%|███████▎  | 93/128 [00:46<00:18,  1.94it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.93it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.94it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:49<00:16,  1.91it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.07it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.08it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.03it/s] 79%|███████▉  | 101/128 [00:50<00:13,  1.99it/s] 80%|███████▉  | 102/128 [00:51<00:13,  1.98it/s] 80%|████████  | 103/128 [00:51<00:12,  1.95it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.94it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.94it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.07it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.03it/s] 89%|████████▉ | 114/128 [00:57<00:07,  1.98it/s] 90%|████████▉ | 115/128 [00:58<00:06,  1.95it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.93it/s] 91%|█████████▏| 117/128 [00:59<00:05,  1.98it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.02it/s] 93%|█████████▎| 119/128 [01:00<00:04,  1.97it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.05it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.09it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.06it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.99it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.96it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:04<00:00,  1.95it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
[2024-01-18 08:17:27,144] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:06,  1.92it/s]  2%|▏         | 2/128 [00:01<01:05,  1.92it/s]  2%|▏         | 3/128 [00:01<01:05,  1.92it/s]  3%|▎         | 4/128 [00:02<01:04,  1.92it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:03<01:02,  1.97it/s]  5%|▌         | 7/128 [00:03<01:01,  1.95it/s]  6%|▋         | 8/128 [00:04<01:01,  1.95it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:04<00:55,  2.13it/s]  9%|▊         | 11/128 [00:05<00:55,  2.13it/s]  9%|▉         | 12/128 [00:05<00:57,  2.03it/s] 10%|█         | 13/128 [00:06<00:55,  2.06it/s] 11%|█         | 14/128 [00:07<00:57,  1.99it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.02it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.99it/s] 13%|█▎        | 17/128 [00:08<00:59,  1.85it/s] 14%|█▍        | 18/128 [00:09<00:58,  1.87it/s] 15%|█▍        | 19/128 [00:09<00:57,  1.89it/s] 16%|█▌        | 20/128 [00:10<00:54,  1.98it/s] 16%|█▋        | 21/128 [00:10<00:54,  1.97it/s] 17%|█▋        | 22/128 [00:11<00:52,  2.01it/s] 18%|█▊        | 23/128 [00:11<00:52,  1.99it/s] 19%|█▉        | 24/128 [00:12<00:52,  1.98it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.09it/s] 20%|██        | 26/128 [00:13<00:50,  2.03it/s] 21%|██        | 27/128 [00:13<00:50,  2.00it/s] 22%|██▏       | 28/128 [00:14<00:50,  1.98it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.96it/s] 23%|██▎       | 30/128 [00:15<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.97it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.93it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.92it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.92it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.98it/s] 28%|██▊       | 36/128 [00:18<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.98it/s] 30%|██▉       | 38/128 [00:19<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:45,  1.95it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:21<00:42,  2.02it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.99it/s] 34%|███▍      | 44/128 [00:22<00:42,  1.97it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.94it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.92it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.92it/s] 38%|███▊      | 48/128 [00:24<00:39,  2.01it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.04it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.01it/s] 41%|████      | 52/128 [00:26<00:38,  1.98it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.97it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.95it/s] 43%|████▎     | 55/128 [00:27<00:37,  1.94it/s] 44%|████▍     | 56/128 [00:28<00:37,  1.94it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.93it/s] 45%|████▌     | 58/128 [00:29<00:36,  1.92it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.90it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.91it/s] 50%|█████     | 64/128 [00:32<00:33,  1.90it/s] 51%|█████     | 65/128 [00:33<00:33,  1.91it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.92it/s] 52%|█████▏    | 67/128 [00:34<00:31,  1.92it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.98it/s] 54%|█████▍    | 69/128 [00:35<00:30,  1.94it/s] 55%|█████▍    | 70/128 [00:35<00:30,  1.91it/s] 55%|█████▌    | 71/128 [00:36<00:29,  1.91it/s] 56%|█████▋    | 72/128 [00:36<00:29,  1.91it/s] 57%|█████▋    | 73/128 [00:37<00:26,  2.04it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.88it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.89it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.89it/s] 60%|██████    | 77/128 [00:39<00:26,  1.90it/s] 61%|██████    | 78/128 [00:39<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.94it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.03it/s] 70%|███████   | 90/128 [00:45<00:19,  1.99it/s] 71%|███████   | 91/128 [00:46<00:18,  1.97it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.96it/s] 73%|███████▎  | 93/128 [00:47<00:18,  1.93it/s] 73%|███████▎  | 94/128 [00:48<00:17,  1.92it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.93it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.92it/s] 76%|███████▌  | 97/128 [00:49<00:16,  1.91it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.06it/s] 77%|███████▋  | 99/128 [00:50<00:13,  2.07it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.02it/s] 79%|███████▉  | 101/128 [00:51<00:13,  1.99it/s] 80%|███████▉  | 102/128 [00:52<00:13,  1.97it/s] 80%|████████  | 103/128 [00:52<00:12,  1.94it/s] 81%|████████▏ | 104/128 [00:53<00:12,  1.93it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:54<00:11,  1.91it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.99it/s] 84%|████████▍ | 108/128 [00:55<00:09,  2.06it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:56<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:56<00:08,  2.04it/s] 88%|████████▊ | 112/128 [00:57<00:07,  2.06it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.02it/s] 89%|████████▉ | 114/128 [00:58<00:07,  1.97it/s] 90%|████████▉ | 115/128 [00:58<00:06,  1.96it/s] 91%|█████████ | 116/128 [00:59<00:06,  1.93it/s] 91%|█████████▏| 117/128 [00:59<00:05,  1.99it/s] 92%|█████████▏| 118/128 [01:00<00:04,  2.02it/s] 93%|█████████▎| 119/128 [01:00<00:04,  1.97it/s] 94%|█████████▍| 120/128 [01:01<00:03,  2.04it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.09it/s] 95%|█████████▌| 122/128 [01:02<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:02<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:03<00:01,  2.06it/s] 98%|█████████▊| 125/128 [01:03<00:01,  1.99it/s] 98%|█████████▊| 126/128 [01:04<00:01,  1.97it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:05<00:00,  1.95it/s]100%|██████████| 128/128 [01:05<00:00,  1.97it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.56s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.43s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.35s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.11s/it]
[2024-01-18 08:19:28,179] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 50%|█████     | 64/128 [00:00<00:00, 635.63it/s]100%|██████████| 128/128 [00:00<00:00, 646.27it/s]
[2024-01-18 08:19:28,514] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.98it/s]  2%|▏         | 2/128 [00:00<01:00,  2.08it/s]  2%|▏         | 3/128 [00:01<01:02,  1.99it/s]  3%|▎         | 4/128 [00:01<00:59,  2.09it/s]  4%|▍         | 5/128 [00:02<01:00,  2.04it/s]  5%|▍         | 6/128 [00:02<01:01,  1.99it/s]  5%|▌         | 7/128 [00:03<00:56,  2.13it/s]  6%|▋         | 8/128 [00:03<00:58,  2.07it/s]  7%|▋         | 9/128 [00:04<00:58,  2.02it/s]  8%|▊         | 10/128 [00:04<00:59,  1.99it/s]  9%|▊         | 11/128 [00:05<00:58,  1.98it/s]  9%|▉         | 12/128 [00:05<00:59,  1.96it/s] 10%|█         | 13/128 [00:06<00:59,  1.94it/s] 11%|█         | 14/128 [00:07<01:04,  1.78it/s] 12%|█▏        | 15/128 [00:07<01:01,  1.83it/s] 12%|█▎        | 16/128 [00:08<01:03,  1.76it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.89it/s] 14%|█▍        | 18/128 [00:09<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.97it/s] 16%|█▌        | 20/128 [00:10<00:53,  2.02it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.00it/s] 17%|█▋        | 22/128 [00:11<00:53,  1.99it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.06it/s] 19%|█▉        | 24/128 [00:12<00:51,  2.02it/s] 20%|█▉        | 25/128 [00:12<00:51,  2.00it/s] 20%|██        | 26/128 [00:13<00:49,  2.04it/s] 21%|██        | 27/128 [00:13<00:50,  1.99it/s] 22%|██▏       | 28/128 [00:14<00:50,  1.98it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.98it/s] 23%|██▎       | 30/128 [00:15<00:50,  1.95it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.95it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.95it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.93it/s] 27%|██▋       | 34/128 [00:17<00:47,  1.99it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.96it/s] 28%|██▊       | 36/128 [00:18<00:46,  1.96it/s] 29%|██▉       | 37/128 [00:18<00:45,  2.01it/s] 30%|██▉       | 38/128 [00:19<00:45,  1.98it/s] 30%|███       | 39/128 [00:19<00:45,  1.95it/s] 31%|███▏      | 40/128 [00:20<00:43,  2.02it/s] 32%|███▏      | 41/128 [00:20<00:43,  1.98it/s] 33%|███▎      | 42/128 [00:21<00:43,  1.97it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.95it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.93it/s] 36%|███▌      | 46/128 [00:23<00:40,  2.02it/s] 37%|███▋      | 47/128 [00:23<00:40,  2.00it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.98it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.97it/s] 39%|███▉      | 50/128 [00:25<00:39,  1.96it/s] 40%|███▉      | 51/128 [00:25<00:39,  1.95it/s] 41%|████      | 52/128 [00:26<00:39,  1.94it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.94it/s] 42%|████▏     | 54/128 [00:27<00:38,  1.93it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.01it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.99it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.98it/s] 45%|████▌     | 58/128 [00:29<00:36,  1.94it/s] 46%|████▌     | 59/128 [00:30<00:38,  1.81it/s] 47%|████▋     | 60/128 [00:30<00:36,  1.85it/s] 48%|████▊     | 61/128 [00:31<00:35,  1.87it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.89it/s] 49%|████▉     | 63/128 [00:32<00:32,  1.98it/s] 50%|█████     | 64/128 [00:32<00:32,  1.97it/s] 51%|█████     | 65/128 [00:33<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.94it/s] 52%|█████▏    | 67/128 [00:34<00:31,  1.91it/s] 53%|█████▎    | 68/128 [00:34<00:31,  1.93it/s] 54%|█████▍    | 69/128 [00:35<00:29,  1.98it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.95it/s] 55%|█████▌    | 71/128 [00:36<00:31,  1.82it/s] 56%|█████▋    | 72/128 [00:36<00:30,  1.83it/s] 57%|█████▋    | 73/128 [00:37<00:31,  1.76it/s] 58%|█████▊    | 74/128 [00:38<00:30,  1.78it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.83it/s] 59%|█████▉    | 76/128 [00:39<00:27,  1.86it/s] 60%|██████    | 77/128 [00:39<00:26,  1.94it/s] 61%|██████    | 78/128 [00:40<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.93it/s] 62%|██████▎   | 80/128 [00:41<00:25,  1.92it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:42<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:42<00:22,  1.97it/s] 66%|██████▌   | 84/128 [00:43<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:43<00:22,  1.93it/s] 67%|██████▋   | 86/128 [00:44<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:44<00:22,  1.85it/s] 69%|██████▉   | 88/128 [00:45<00:21,  1.86it/s] 70%|██████▉   | 89/128 [00:45<00:20,  1.87it/s] 70%|███████   | 90/128 [00:46<00:20,  1.88it/s] 71%|███████   | 91/128 [00:46<00:19,  1.89it/s] 72%|███████▏  | 92/128 [00:47<00:18,  1.90it/s] 73%|███████▎  | 93/128 [00:47<00:17,  1.96it/s] 73%|███████▎  | 94/128 [00:48<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:48<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.94it/s] 76%|███████▌  | 97/128 [00:49<00:16,  1.91it/s] 77%|███████▋  | 98/128 [00:50<00:15,  1.90it/s] 77%|███████▋  | 99/128 [00:51<00:15,  1.89it/s] 78%|███████▊  | 100/128 [00:51<00:14,  1.88it/s] 79%|███████▉  | 101/128 [00:52<00:14,  1.90it/s] 80%|███████▉  | 102/128 [00:52<00:12,  2.03it/s] 80%|████████  | 103/128 [00:52<00:12,  2.05it/s] 81%|████████▏ | 104/128 [00:53<00:11,  2.02it/s] 82%|████████▏ | 105/128 [00:53<00:11,  2.05it/s] 83%|████████▎ | 106/128 [00:54<00:10,  2.01it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:55<00:09,  2.01it/s] 85%|████████▌ | 109/128 [00:56<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:56<00:09,  1.94it/s] 87%|████████▋ | 111/128 [00:57<00:08,  1.94it/s] 88%|████████▊ | 112/128 [00:57<00:08,  1.94it/s] 88%|████████▊ | 113/128 [00:58<00:07,  1.92it/s] 89%|████████▉ | 114/128 [00:58<00:07,  1.98it/s] 90%|████████▉ | 115/128 [00:59<00:06,  1.96it/s] 91%|█████████ | 116/128 [00:59<00:05,  2.03it/s] 91%|█████████▏| 117/128 [01:00<00:05,  1.98it/s] 92%|█████████▏| 118/128 [01:00<00:05,  1.95it/s] 93%|█████████▎| 119/128 [01:01<00:04,  1.99it/s] 94%|█████████▍| 120/128 [01:01<00:04,  1.97it/s] 95%|█████████▍| 121/128 [01:02<00:03,  1.96it/s] 95%|█████████▌| 122/128 [01:02<00:03,  1.95it/s] 96%|█████████▌| 123/128 [01:03<00:02,  1.93it/s] 97%|█████████▋| 124/128 [01:03<00:02,  1.91it/s] 98%|█████████▊| 125/128 [01:04<00:01,  1.92it/s] 98%|█████████▊| 126/128 [01:04<00:01,  1.93it/s] 99%|█████████▉| 127/128 [01:05<00:00,  1.90it/s]100%|██████████| 128/128 [01:05<00:00,  1.97it/s]100%|██████████| 128/128 [01:05<00:00,  1.95it/s]
[2024-01-18 08:20:34,270] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.95it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<01:03,  1.97it/s]  3%|▎         | 4/128 [00:01<01:00,  2.06it/s]  4%|▍         | 5/128 [00:02<01:00,  2.02it/s]  5%|▍         | 6/128 [00:03<01:01,  1.97it/s]  5%|▌         | 7/128 [00:03<00:57,  2.10it/s]  6%|▋         | 8/128 [00:03<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:59,  2.00it/s]  8%|▊         | 10/128 [00:04<00:59,  1.97it/s]  9%|▊         | 11/128 [00:05<00:59,  1.96it/s]  9%|▉         | 12/128 [00:06<00:59,  1.94it/s] 10%|█         | 13/128 [00:06<00:59,  1.92it/s] 11%|█         | 14/128 [00:07<01:04,  1.76it/s] 12%|█▏        | 15/128 [00:07<01:02,  1.81it/s] 12%|█▎        | 16/128 [00:08<01:04,  1.74it/s] 13%|█▎        | 17/128 [00:08<00:59,  1.86it/s] 14%|█▍        | 18/128 [00:09<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:56,  1.95it/s] 16%|█▌        | 20/128 [00:10<00:54,  2.00it/s] 16%|█▋        | 21/128 [00:10<00:54,  1.98it/s] 17%|█▋        | 22/128 [00:11<00:53,  1.97it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.04it/s] 19%|█▉        | 24/128 [00:12<00:51,  2.00it/s] 20%|█▉        | 25/128 [00:12<00:52,  1.98it/s] 20%|██        | 26/128 [00:13<00:50,  2.02it/s] 21%|██        | 27/128 [00:13<00:51,  1.98it/s] 22%|██▏       | 28/128 [00:14<00:50,  1.96it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.96it/s] 23%|██▎       | 30/128 [00:15<00:50,  1.93it/s] 24%|██▍       | 31/128 [00:15<00:50,  1.93it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.94it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.92it/s] 27%|██▋       | 34/128 [00:17<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.95it/s] 28%|██▊       | 36/128 [00:18<00:47,  1.95it/s] 29%|██▉       | 37/128 [00:18<00:45,  2.00it/s] 30%|██▉       | 38/128 [00:19<00:45,  1.97it/s] 30%|███       | 39/128 [00:19<00:45,  1.94it/s] 31%|███▏      | 40/128 [00:20<00:43,  2.01it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.97it/s] 33%|███▎      | 42/128 [00:21<00:43,  1.96it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:23<00:43,  1.92it/s] 36%|███▌      | 46/128 [00:23<00:40,  2.01it/s] 37%|███▋      | 47/128 [00:24<00:40,  1.99it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.98it/s] 38%|███▊      | 49/128 [00:25<00:40,  1.96it/s] 39%|███▉      | 50/128 [00:25<00:40,  1.95it/s] 40%|███▉      | 51/128 [00:26<00:39,  1.94it/s] 41%|████      | 52/128 [00:26<00:39,  1.93it/s] 41%|████▏     | 53/128 [00:27<00:38,  1.94it/s] 42%|████▏     | 54/128 [00:27<00:38,  1.92it/s] 43%|████▎     | 55/128 [00:28<00:36,  2.00it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.98it/s] 45%|████▍     | 57/128 [00:29<00:35,  1.97it/s] 45%|████▌     | 58/128 [00:29<00:36,  1.94it/s] 46%|████▌     | 59/128 [00:30<00:38,  1.81it/s] 47%|████▋     | 60/128 [00:30<00:36,  1.85it/s] 48%|████▊     | 61/128 [00:31<00:35,  1.87it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.89it/s] 49%|████▉     | 63/128 [00:32<00:32,  1.98it/s] 50%|█████     | 64/128 [00:32<00:32,  1.96it/s] 51%|█████     | 65/128 [00:33<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.94it/s] 52%|█████▏    | 67/128 [00:34<00:31,  1.91it/s] 53%|█████▎    | 68/128 [00:34<00:31,  1.92it/s] 54%|█████▍    | 69/128 [00:35<00:29,  1.97it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.94it/s] 55%|█████▌    | 71/128 [00:36<00:31,  1.82it/s] 56%|█████▋    | 72/128 [00:37<00:30,  1.83it/s] 57%|█████▋    | 73/128 [00:37<00:31,  1.75it/s] 58%|█████▊    | 74/128 [00:38<00:30,  1.78it/s] 59%|█████▊    | 75/128 [00:38<00:29,  1.83it/s] 59%|█████▉    | 76/128 [00:39<00:27,  1.86it/s] 60%|██████    | 77/128 [00:39<00:26,  1.93it/s] 61%|██████    | 78/128 [00:40<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.93it/s] 62%|██████▎   | 80/128 [00:41<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.90it/s] 64%|██████▍   | 82/128 [00:42<00:24,  1.90it/s] 65%|██████▍   | 83/128 [00:42<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:43<00:22,  1.95it/s] 66%|██████▋   | 85/128 [00:43<00:22,  1.93it/s] 67%|██████▋   | 86/128 [00:44<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:45<00:22,  1.84it/s] 69%|██████▉   | 88/128 [00:45<00:21,  1.85it/s] 70%|██████▉   | 89/128 [00:46<00:20,  1.86it/s] 70%|███████   | 90/128 [00:46<00:20,  1.87it/s] 71%|███████   | 91/128 [00:47<00:19,  1.89it/s] 72%|███████▏  | 92/128 [00:47<00:18,  1.90it/s] 73%|███████▎  | 93/128 [00:48<00:17,  1.96it/s] 73%|███████▎  | 94/128 [00:48<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:49<00:17,  1.94it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:50<00:16,  1.90it/s] 77%|███████▋  | 98/128 [00:50<00:15,  1.89it/s] 77%|███████▋  | 99/128 [00:51<00:15,  1.88it/s] 78%|███████▊  | 100/128 [00:51<00:14,  1.87it/s] 79%|███████▉  | 101/128 [00:52<00:14,  1.89it/s] 80%|███████▉  | 102/128 [00:52<00:12,  2.02it/s] 80%|████████  | 103/128 [00:53<00:12,  2.05it/s] 81%|████████▏ | 104/128 [00:53<00:11,  2.01it/s] 82%|████████▏ | 105/128 [00:54<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:54<00:10,  2.00it/s] 84%|████████▎ | 107/128 [00:55<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:55<00:09,  2.00it/s] 85%|████████▌ | 109/128 [00:56<00:09,  1.95it/s] 86%|████████▌ | 110/128 [00:56<00:09,  1.94it/s] 87%|████████▋ | 111/128 [00:57<00:08,  1.94it/s] 88%|████████▊ | 112/128 [00:57<00:08,  1.94it/s] 88%|████████▊ | 113/128 [00:58<00:07,  1.92it/s] 89%|████████▉ | 114/128 [00:58<00:07,  1.97it/s] 90%|████████▉ | 115/128 [00:59<00:06,  1.95it/s] 91%|█████████ | 116/128 [00:59<00:05,  2.00it/s] 91%|█████████▏| 117/128 [01:00<00:05,  1.96it/s] 92%|█████████▏| 118/128 [01:00<00:05,  1.93it/s] 93%|█████████▎| 119/128 [01:01<00:04,  1.98it/s] 94%|█████████▍| 120/128 [01:01<00:04,  1.96it/s] 95%|█████████▍| 121/128 [01:02<00:03,  1.95it/s] 95%|█████████▌| 122/128 [01:02<00:03,  1.94it/s] 96%|█████████▌| 123/128 [01:03<00:02,  1.92it/s] 97%|█████████▋| 124/128 [01:04<00:02,  1.90it/s] 98%|█████████▊| 125/128 [01:04<00:01,  1.91it/s] 98%|█████████▊| 126/128 [01:05<00:01,  1.92it/s] 99%|█████████▉| 127/128 [01:05<00:00,  1.90it/s]100%|██████████| 128/128 [01:06<00:00,  1.96it/s]100%|██████████| 128/128 [01:06<00:00,  1.94it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.73s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:12<00:06,  6.37s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:18<00:00,  6.30s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:18<00:00,  6.15s/it]
[2024-01-18 08:22:38,701] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 42%|████▏     | 54/128 [00:00<00:00, 534.83it/s] 98%|█████████▊| 126/128 [00:00<00:00, 643.17it/s]100%|██████████| 128/128 [00:00<00:00, 624.51it/s]
[2024-01-18 08:22:39,035] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.97it/s]  2%|▏         | 2/128 [00:01<01:03,  1.98it/s]  2%|▏         | 3/128 [00:01<01:00,  2.06it/s]  3%|▎         | 4/128 [00:01<01:01,  2.02it/s]  4%|▍         | 5/128 [00:02<00:59,  2.08it/s]  5%|▍         | 6/128 [00:02<01:00,  2.02it/s]  5%|▌         | 7/128 [00:03<00:57,  2.10it/s]  6%|▋         | 8/128 [00:03<00:55,  2.15it/s]  7%|▋         | 9/128 [00:04<00:55,  2.15it/s]  8%|▊         | 10/128 [00:04<00:53,  2.19it/s]  9%|▊         | 11/128 [00:05<00:51,  2.26it/s]  9%|▉         | 12/128 [00:05<00:51,  2.23it/s] 10%|█         | 13/128 [00:06<00:51,  2.25it/s] 11%|█         | 14/128 [00:06<00:51,  2.22it/s] 12%|█▏        | 15/128 [00:06<00:50,  2.23it/s] 12%|█▎        | 16/128 [00:07<00:50,  2.21it/s] 13%|█▎        | 17/128 [00:07<00:52,  2.11it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.05it/s] 15%|█▍        | 19/128 [00:08<00:53,  2.02it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.14it/s] 16%|█▋        | 21/128 [00:09<00:51,  2.07it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.17it/s] 18%|█▊        | 23/128 [00:10<00:47,  2.19it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.19it/s] 20%|█▉        | 25/128 [00:11<00:44,  2.30it/s] 20%|██        | 26/128 [00:12<00:47,  2.16it/s] 21%|██        | 27/128 [00:12<00:48,  2.10it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.05it/s] 23%|██▎       | 29/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.09it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.04it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.10it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.03it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.06it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.09it/s] 29%|██▉       | 37/128 [00:17<00:41,  2.22it/s] 30%|██▉       | 38/128 [00:17<00:42,  2.10it/s] 30%|███       | 39/128 [00:18<00:43,  2.05it/s] 31%|███▏      | 40/128 [00:18<00:41,  2.11it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.04it/s] 33%|███▎      | 42/128 [00:19<00:42,  2.01it/s] 34%|███▎      | 43/128 [00:20<00:42,  1.99it/s] 34%|███▍      | 44/128 [00:20<00:42,  1.99it/s] 35%|███▌      | 45/128 [00:21<00:40,  2.04it/s] 36%|███▌      | 46/128 [00:21<00:40,  2.01it/s] 37%|███▋      | 47/128 [00:22<00:40,  1.99it/s] 38%|███▊      | 48/128 [00:22<00:39,  2.04it/s] 38%|███▊      | 49/128 [00:23<00:37,  2.10it/s] 39%|███▉      | 50/128 [00:23<00:36,  2.15it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.18it/s] 41%|████      | 52/128 [00:24<00:36,  2.10it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.05it/s] 42%|████▏     | 54/128 [00:25<00:35,  2.09it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.14it/s] 44%|████▍     | 56/128 [00:26<00:33,  2.15it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.07it/s] 45%|████▌     | 58/128 [00:27<00:34,  2.04it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.08it/s] 48%|████▊     | 61/128 [00:29<00:31,  2.14it/s] 48%|████▊     | 62/128 [00:29<00:33,  1.94it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.95it/s] 50%|█████     | 64/128 [00:30<00:32,  1.95it/s] 51%|█████     | 65/128 [00:31<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.95it/s] 52%|█████▏    | 67/128 [00:32<00:31,  1.94it/s] 53%|█████▎    | 68/128 [00:32<00:29,  2.03it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.13it/s] 55%|█████▍    | 70/128 [00:33<00:26,  2.22it/s] 55%|█████▌    | 71/128 [00:34<00:26,  2.13it/s] 56%|█████▋    | 72/128 [00:34<00:28,  1.95it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.93it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.96it/s] 60%|██████    | 77/128 [00:37<00:26,  1.93it/s] 61%|██████    | 78/128 [00:37<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.94it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.95it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.00it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.12it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.07it/s] 68%|██████▊   | 87/128 [00:42<00:19,  2.11it/s] 69%|██████▉   | 88/128 [00:42<00:19,  2.04it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.01it/s] 70%|███████   | 90/128 [00:43<00:17,  2.13it/s] 71%|███████   | 91/128 [00:44<00:17,  2.16it/s] 72%|███████▏  | 92/128 [00:44<00:16,  2.15it/s] 73%|███████▎  | 93/128 [00:44<00:16,  2.15it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.08it/s] 74%|███████▍  | 95/128 [00:45<00:15,  2.09it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.04it/s] 76%|███████▌  | 97/128 [00:46<00:15,  2.01it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.04it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.00it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.98it/s] 79%|███████▉  | 101/128 [00:48<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.15it/s] 80%|████████  | 103/128 [00:49<00:11,  2.22it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.13it/s] 82%|████████▏ | 105/128 [00:50<00:11,  2.06it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.08it/s] 84%|████████▎ | 107/128 [00:51<00:10,  2.04it/s] 84%|████████▍ | 108/128 [00:52<00:10,  1.99it/s] 85%|████████▌ | 109/128 [00:52<00:09,  1.97it/s] 86%|████████▌ | 110/128 [00:53<00:09,  1.96it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.09it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.11it/s] 88%|████████▊ | 113/128 [00:54<00:06,  2.15it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.15it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.09it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.10it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.14it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.18it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.09it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.18it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.20it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.19it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.11it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.12it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.11it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.03it/s]100%|██████████| 128/128 [01:01<00:00,  2.10it/s]100%|██████████| 128/128 [01:01<00:00,  2.07it/s]
[2024-01-18 08:23:40,797] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.93it/s]  2%|▏         | 2/128 [00:01<01:04,  1.94it/s]  2%|▏         | 3/128 [00:01<01:01,  2.02it/s]  3%|▎         | 4/128 [00:02<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<01:00,  2.05it/s]  5%|▍         | 6/128 [00:03<01:01,  1.99it/s]  5%|▌         | 7/128 [00:03<00:58,  2.07it/s]  6%|▋         | 8/128 [00:03<00:56,  2.12it/s]  7%|▋         | 9/128 [00:04<00:55,  2.13it/s]  8%|▊         | 10/128 [00:04<00:54,  2.16it/s]  9%|▊         | 11/128 [00:05<00:52,  2.23it/s]  9%|▉         | 12/128 [00:05<00:52,  2.20it/s] 10%|█         | 13/128 [00:06<00:51,  2.22it/s] 11%|█         | 14/128 [00:06<00:52,  2.19it/s] 12%|█▏        | 15/128 [00:07<00:51,  2.21it/s] 12%|█▎        | 16/128 [00:07<00:51,  2.19it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.09it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.03it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.00it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.12it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.05it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.11it/s] 18%|█▊        | 23/128 [00:10<00:48,  2.14it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.14it/s] 20%|█▉        | 25/128 [00:11<00:45,  2.25it/s] 20%|██        | 26/128 [00:12<00:47,  2.13it/s] 21%|██        | 27/128 [00:12<00:48,  2.07it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:13<00:49,  2.00it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.06it/s] 24%|██▍       | 31/128 [00:14<00:48,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.05it/s] 26%|██▌       | 33/128 [00:15<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.03it/s] 27%|██▋       | 35/128 [00:16<00:46,  1.99it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.06it/s] 29%|██▉       | 37/128 [00:17<00:41,  2.19it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.07it/s] 30%|███       | 39/128 [00:18<00:43,  2.03it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.08it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.01it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.97it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.02it/s] 38%|███▊      | 49/128 [00:23<00:37,  2.08it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.13it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.16it/s] 41%|████      | 52/128 [00:25<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.06it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.12it/s] 44%|████▍     | 56/128 [00:26<00:33,  2.12it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.05it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.06it/s] 48%|████▊     | 61/128 [00:29<00:31,  2.11it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.92it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.93it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:31<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:32<00:32,  1.93it/s] 52%|█████▏    | 67/128 [00:32<00:31,  1.92it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.00it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.11it/s] 55%|█████▍    | 70/128 [00:33<00:26,  2.20it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.11it/s] 56%|█████▋    | 72/128 [00:35<00:29,  1.93it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.91it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.97it/s] 59%|█████▊    | 75/128 [00:36<00:27,  1.95it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.94it/s] 60%|██████    | 77/128 [00:37<00:26,  1.92it/s] 61%|██████    | 78/128 [00:38<00:25,  1.92it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.92it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.10it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:42<00:19,  2.10it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.03it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.00it/s] 70%|███████   | 90/128 [00:44<00:18,  2.11it/s] 71%|███████   | 91/128 [00:44<00:17,  2.14it/s] 72%|███████▏  | 92/128 [00:45<00:16,  2.13it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.13it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.06it/s] 74%|███████▍  | 95/128 [00:46<00:15,  2.08it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.03it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.03it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.98it/s] 78%|███████▊  | 100/128 [00:49<00:14,  1.96it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.13it/s] 80%|████████  | 103/128 [00:50<00:11,  2.21it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.11it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.05it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.07it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.02it/s] 84%|████████▍ | 108/128 [00:52<00:10,  1.97it/s] 85%|████████▌ | 109/128 [00:53<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:53<00:09,  1.95it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.07it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.09it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.14it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.14it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.07it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.13it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.16it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.17it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.19it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.17it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.10it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.11it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.05it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.10it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.02it/s]100%|██████████| 128/128 [01:02<00:00,  2.09it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.29s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.76s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.43s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.20s/it]
[2024-01-18 08:25:38,582] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 50%|█████     | 64/128 [00:00<00:00, 637.68it/s]100%|██████████| 128/128 [00:00<00:00, 666.86it/s]
[2024-01-18 08:25:38,914] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:00<00:59,  2.13it/s]  2%|▏         | 3/128 [00:01<00:58,  2.15it/s]  3%|▎         | 4/128 [00:01<00:59,  2.07it/s]  4%|▍         | 5/128 [00:02<00:58,  2.10it/s]  5%|▍         | 6/128 [00:02<00:59,  2.06it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:57,  2.10it/s]  7%|▋         | 9/128 [00:04<00:55,  2.15it/s]  8%|▊         | 10/128 [00:04<00:54,  2.16it/s]  9%|▊         | 11/128 [00:05<00:52,  2.24it/s]  9%|▉         | 12/128 [00:05<00:52,  2.22it/s] 10%|█         | 13/128 [00:06<00:51,  2.23it/s] 11%|█         | 14/128 [00:06<00:53,  2.14it/s] 12%|█▏        | 15/128 [00:07<00:52,  2.14it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.09it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.92it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.06it/s] 15%|█▍        | 19/128 [00:08<00:51,  2.12it/s] 16%|█▌        | 20/128 [00:09<00:48,  2.25it/s] 16%|█▋        | 21/128 [00:09<00:47,  2.25it/s] 17%|█▋        | 22/128 [00:10<00:47,  2.22it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.13it/s] 19%|█▉        | 24/128 [00:11<00:46,  2.22it/s] 20%|█▉        | 25/128 [00:11<00:48,  2.14it/s] 20%|██        | 26/128 [00:12<00:47,  2.15it/s] 21%|██        | 27/128 [00:12<00:46,  2.15it/s] 22%|██▏       | 28/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.15it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.08it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.14it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.96it/s] 26%|██▌       | 33/128 [00:15<00:47,  2.00it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.97it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.10it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.03it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.01it/s] 30%|███       | 39/128 [00:18<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.98it/s] 32%|███▏      | 41/128 [00:19<00:46,  1.86it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.89it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.94it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.01it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.05it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.11it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.12it/s] 41%|████      | 52/128 [00:25<00:36,  2.06it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.03it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.07it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.13it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:28<00:35,  2.00it/s] 46%|████▌     | 59/128 [00:28<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.03it/s] 48%|████▊     | 61/128 [00:29<00:33,  1.98it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.98it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:32,  1.95it/s] 51%|█████     | 65/128 [00:31<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.03it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.01it/s] 53%|█████▎    | 68/128 [00:32<00:27,  2.15it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.09it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.11it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.06it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.01it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.05it/s] 58%|█████▊    | 74/128 [00:35<00:25,  2.11it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.06it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.00it/s] 60%|██████    | 77/128 [00:37<00:25,  1.98it/s] 61%|██████    | 78/128 [00:37<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:38<00:24,  2.01it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.97it/s] 63%|██████▎   | 81/128 [00:39<00:23,  1.96it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.95it/s] 65%|██████▍   | 83/128 [00:40<00:22,  2.01it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:41<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.06it/s] 68%|██████▊   | 87/128 [00:42<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.02it/s] 70%|███████   | 90/128 [00:43<00:18,  2.09it/s] 71%|███████   | 91/128 [00:44<00:18,  2.04it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.07it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.01it/s] 73%|███████▎  | 94/128 [00:45<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.95it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.94it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.13it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.17it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.16it/s] 80%|████████  | 103/128 [00:50<00:12,  2.08it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.13it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.13it/s] 83%|████████▎ | 106/128 [00:51<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.95it/s] 84%|████████▍ | 108/128 [00:52<00:10,  1.94it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.03it/s] 86%|████████▌ | 110/128 [00:53<00:09,  2.00it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.04it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.03it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.09it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.05it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.02it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.05it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.01it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.04it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.10it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.04it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:00<00:02,  1.98it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:01<00:01,  2.00it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.04it/s]100%|██████████| 128/128 [01:02<00:00,  2.06it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 08:26:41,559] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.93it/s]  2%|▏         | 2/128 [00:00<00:59,  2.10it/s]  2%|▏         | 3/128 [00:01<00:58,  2.12it/s]  3%|▎         | 4/128 [00:01<01:00,  2.04it/s]  4%|▍         | 5/128 [00:02<00:59,  2.08it/s]  5%|▍         | 6/128 [00:02<01:00,  2.03it/s]  5%|▌         | 7/128 [00:03<01:00,  2.00it/s]  6%|▋         | 8/128 [00:03<00:57,  2.07it/s]  7%|▋         | 9/128 [00:04<00:55,  2.13it/s]  8%|▊         | 10/128 [00:04<00:55,  2.13it/s]  9%|▊         | 11/128 [00:05<00:52,  2.21it/s]  9%|▉         | 12/128 [00:05<00:52,  2.19it/s] 10%|█         | 13/128 [00:06<00:52,  2.21it/s] 11%|█         | 14/128 [00:06<00:53,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.12it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.07it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.90it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.04it/s] 15%|█▍        | 19/128 [00:09<00:51,  2.10it/s] 16%|█▌        | 20/128 [00:09<00:48,  2.22it/s] 16%|█▋        | 21/128 [00:09<00:48,  2.23it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.20it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.11it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.20it/s] 20%|█▉        | 25/128 [00:11<00:48,  2.12it/s] 20%|██        | 26/128 [00:12<00:47,  2.13it/s] 21%|██        | 27/128 [00:12<00:47,  2.13it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.07it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.13it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.06it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.12it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.94it/s] 26%|██▌       | 33/128 [00:15<00:48,  1.94it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:16<00:46,  1.98it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.06it/s] 29%|██▉       | 37/128 [00:17<00:45,  2.00it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.98it/s] 30%|███       | 39/128 [00:18<00:45,  1.97it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:19<00:47,  1.84it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.87it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.95it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:21<00:43,  1.93it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.03it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.09it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.10it/s] 41%|████      | 52/128 [00:25<00:37,  2.05it/s] 41%|████▏     | 53/128 [00:25<00:37,  2.02it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.05it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.11it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.00it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:28<00:35,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:29<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.92it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.01it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.00it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.14it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.07it/s] 55%|█████▍    | 70/128 [00:34<00:27,  2.09it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.05it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.99it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.03it/s] 58%|█████▊    | 74/128 [00:36<00:25,  2.09it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.04it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.99it/s] 60%|██████    | 77/128 [00:37<00:25,  1.96it/s] 61%|██████    | 78/128 [00:38<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:38<00:24,  1.99it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.95it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.94it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.93it/s] 66%|██████▋   | 85/128 [00:42<00:22,  1.93it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.01it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.95it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.99it/s] 70%|███████   | 90/128 [00:44<00:18,  2.06it/s] 71%|███████   | 91/128 [00:44<00:18,  2.01it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:45<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.97it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.94it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.91it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.91it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.00it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.11it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.14it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.13it/s] 80%|████████  | 103/128 [00:50<00:12,  2.06it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.11it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.11it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.93it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.92it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:54<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.02it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.05it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:57<00:06,  2.00it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.04it/s] 92%|█████████▏| 118/128 [00:58<00:05,  1.99it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.06it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.02it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.08it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.03it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.96it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.01it/s] 98%|█████████▊| 126/128 [01:02<00:01,  1.98it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  1.99it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.23s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.18s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.10s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.86s/it]
[2024-01-18 08:28:39,153] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 44%|████▍     | 56/128 [00:00<00:00, 555.10it/s]100%|██████████| 128/128 [00:00<00:00, 646.27it/s]100%|██████████| 128/128 [00:00<00:00, 631.88it/s]
[2024-01-18 08:28:39,484] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.18it/s]  2%|▏         | 2/128 [00:00<01:02,  2.01it/s]  2%|▏         | 3/128 [00:01<00:57,  2.19it/s]  3%|▎         | 4/128 [00:01<00:55,  2.23it/s]  4%|▍         | 5/128 [00:02<00:55,  2.21it/s]  5%|▍         | 6/128 [00:02<00:55,  2.19it/s]  5%|▌         | 7/128 [00:03<00:57,  2.09it/s]  6%|▋         | 8/128 [00:03<00:56,  2.11it/s]  7%|▋         | 9/128 [00:04<00:55,  2.13it/s]  8%|▊         | 10/128 [00:04<00:53,  2.22it/s]  9%|▊         | 11/128 [00:05<00:52,  2.24it/s]  9%|▉         | 12/128 [00:05<00:50,  2.30it/s] 10%|█         | 13/128 [00:05<00:50,  2.30it/s] 11%|█         | 14/128 [00:06<00:52,  2.19it/s] 12%|█▏        | 15/128 [00:06<00:49,  2.26it/s] 12%|█▎        | 16/128 [00:07<00:50,  2.23it/s] 13%|█▎        | 17/128 [00:07<00:51,  2.14it/s] 14%|█▍        | 18/128 [00:08<00:51,  2.15it/s] 15%|█▍        | 19/128 [00:08<00:50,  2.15it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.13it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.14it/s] 18%|█▊        | 23/128 [00:10<00:48,  2.15it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.08it/s] 20%|█▉        | 25/128 [00:11<00:50,  2.04it/s] 20%|██        | 26/128 [00:12<00:49,  2.08it/s] 21%|██        | 27/128 [00:12<00:45,  2.21it/s] 22%|██▏       | 28/128 [00:12<00:47,  2.11it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:13<00:47,  2.05it/s] 24%|██▍       | 31/128 [00:14<00:48,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  2.00it/s] 26%|██▌       | 33/128 [00:15<00:45,  2.08it/s] 27%|██▋       | 34/128 [00:15<00:46,  2.04it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.07it/s] 28%|██▊       | 36/128 [00:16<00:43,  2.10it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.06it/s] 30%|██▉       | 38/128 [00:17<00:43,  2.09it/s] 30%|███       | 39/128 [00:18<00:41,  2.14it/s] 31%|███▏      | 40/128 [00:18<00:41,  2.14it/s] 32%|███▏      | 41/128 [00:19<00:41,  2.09it/s] 33%|███▎      | 42/128 [00:19<00:40,  2.14it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.06it/s] 34%|███▍      | 44/128 [00:20<00:40,  2.09it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.02it/s] 36%|███▌      | 46/128 [00:21<00:38,  2.14it/s] 37%|███▋      | 47/128 [00:22<00:37,  2.17it/s] 38%|███▊      | 48/128 [00:22<00:37,  2.11it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.04it/s] 39%|███▉      | 50/128 [00:23<00:38,  2.00it/s] 40%|███▉      | 51/128 [00:24<00:38,  1.99it/s] 41%|████      | 52/128 [00:24<00:36,  2.06it/s] 41%|████▏     | 53/128 [00:24<00:34,  2.16it/s] 42%|████▏     | 54/128 [00:25<00:34,  2.17it/s] 43%|████▎     | 55/128 [00:25<00:34,  2.10it/s] 44%|████▍     | 56/128 [00:26<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:26<00:33,  2.11it/s] 45%|████▌     | 58/128 [00:27<00:32,  2.12it/s] 46%|████▌     | 59/128 [00:27<00:33,  2.07it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.03it/s] 48%|████▊     | 61/128 [00:28<00:31,  2.10it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.06it/s] 49%|████▉     | 63/128 [00:29<00:32,  2.01it/s] 50%|█████     | 64/128 [00:30<00:32,  2.00it/s] 51%|█████     | 65/128 [00:30<00:31,  1.99it/s] 52%|█████▏    | 66/128 [00:31<00:30,  2.04it/s] 52%|█████▏    | 67/128 [00:31<00:29,  2.07it/s] 53%|█████▎    | 68/128 [00:32<00:28,  2.13it/s] 54%|█████▍    | 69/128 [00:32<00:28,  2.06it/s] 55%|█████▍    | 70/128 [00:33<00:26,  2.17it/s] 55%|█████▌    | 71/128 [00:33<00:27,  2.10it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.05it/s] 57%|█████▋    | 73/128 [00:34<00:27,  2.02it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:35<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.05it/s] 60%|██████    | 77/128 [00:36<00:25,  2.00it/s] 61%|██████    | 78/128 [00:37<00:25,  1.97it/s] 62%|██████▏   | 79/128 [00:37<00:25,  1.96it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.94it/s] 63%|██████▎   | 81/128 [00:38<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:39<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:40<00:21,  2.01it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.05it/s] 68%|██████▊   | 87/128 [00:41<00:19,  2.07it/s] 69%|██████▉   | 88/128 [00:42<00:18,  2.17it/s] 70%|██████▉   | 89/128 [00:42<00:18,  2.08it/s] 70%|███████   | 90/128 [00:43<00:18,  2.10it/s] 71%|███████   | 91/128 [00:43<00:17,  2.11it/s] 72%|███████▏  | 92/128 [00:44<00:16,  2.12it/s] 73%|███████▎  | 93/128 [00:44<00:16,  2.12it/s] 73%|███████▎  | 94/128 [00:44<00:15,  2.16it/s] 74%|███████▍  | 95/128 [00:45<00:15,  2.06it/s] 75%|███████▌  | 96/128 [00:45<00:15,  2.09it/s] 76%|███████▌  | 97/128 [00:46<00:15,  2.04it/s] 77%|███████▋  | 98/128 [00:46<00:14,  2.06it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.00it/s] 79%|███████▉  | 101/128 [00:48<00:13,  1.98it/s] 80%|███████▉  | 102/128 [00:49<00:13,  1.97it/s] 80%|████████  | 103/128 [00:49<00:11,  2.12it/s] 81%|████████▏ | 104/128 [00:49<00:10,  2.20it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.18it/s] 83%|████████▎ | 106/128 [00:50<00:10,  2.10it/s] 84%|████████▎ | 107/128 [00:51<00:09,  2.14it/s] 84%|████████▍ | 108/128 [00:51<00:09,  2.14it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.08it/s] 86%|████████▌ | 110/128 [00:52<00:08,  2.11it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.08it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.10it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.11it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.06it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.01it/s] 91%|█████████▏| 117/128 [00:56<00:05,  1.98it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.06it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.10it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.05it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.07it/s] 96%|█████████▌| 123/128 [00:58<00:02,  2.12it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.16it/s] 98%|█████████▊| 125/128 [00:59<00:01,  2.09it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:00<00:00,  2.00it/s]100%|██████████| 128/128 [01:01<00:00,  2.06it/s]100%|██████████| 128/128 [01:01<00:00,  2.08it/s]
[2024-01-18 08:29:40,932] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.13it/s]  2%|▏         | 2/128 [00:01<01:03,  1.97it/s]  2%|▏         | 3/128 [00:01<00:57,  2.16it/s]  3%|▎         | 4/128 [00:01<00:56,  2.19it/s]  4%|▍         | 5/128 [00:02<00:56,  2.17it/s]  5%|▍         | 6/128 [00:02<00:56,  2.16it/s]  5%|▌         | 7/128 [00:03<00:58,  2.06it/s]  6%|▋         | 8/128 [00:03<00:57,  2.08it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:53,  2.19it/s]  9%|▊         | 11/128 [00:05<00:53,  2.21it/s]  9%|▉         | 12/128 [00:05<00:51,  2.26it/s] 10%|█         | 13/128 [00:05<00:50,  2.26it/s] 11%|█         | 14/128 [00:06<00:52,  2.15it/s] 12%|█▏        | 15/128 [00:06<00:50,  2.23it/s] 12%|█▎        | 16/128 [00:07<00:50,  2.20it/s] 13%|█▎        | 17/128 [00:07<00:52,  2.11it/s] 14%|█▍        | 18/128 [00:08<00:51,  2.12it/s] 15%|█▍        | 19/128 [00:08<00:51,  2.12it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.06it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.11it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.12it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.05it/s] 20%|█▉        | 25/128 [00:11<00:51,  2.02it/s] 20%|██        | 26/128 [00:12<00:49,  2.05it/s] 21%|██        | 27/128 [00:12<00:46,  2.18it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.08it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.02it/s] 24%|██▍       | 31/128 [00:14<00:48,  1.99it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.97it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.05it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.01it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.07it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.03it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.06it/s] 30%|███       | 39/128 [00:18<00:42,  2.11it/s] 31%|███▏      | 40/128 [00:19<00:41,  2.12it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.06it/s] 33%|███▎      | 42/128 [00:19<00:40,  2.11it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.04it/s] 34%|███▍      | 44/128 [00:20<00:40,  2.06it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:21<00:38,  2.11it/s] 37%|███▋      | 47/128 [00:22<00:38,  2.12it/s] 38%|███▊      | 48/128 [00:22<00:38,  2.06it/s] 38%|███▊      | 49/128 [00:23<00:39,  2.00it/s] 39%|███▉      | 50/128 [00:23<00:39,  1.97it/s] 40%|███▉      | 51/128 [00:24<00:39,  1.96it/s] 41%|████      | 52/128 [00:24<00:37,  2.04it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.14it/s] 42%|████▏     | 54/128 [00:25<00:34,  2.14it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.08it/s] 44%|████▍     | 56/128 [00:26<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.09it/s] 45%|████▌     | 58/128 [00:27<00:33,  2.10it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.05it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.08it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.04it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.99it/s] 50%|█████     | 64/128 [00:30<00:32,  1.98it/s] 51%|█████     | 65/128 [00:31<00:31,  1.97it/s] 52%|█████▏    | 66/128 [00:31<00:30,  2.02it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.05it/s] 53%|█████▎    | 68/128 [00:32<00:28,  2.11it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.06it/s] 55%|█████▍    | 70/128 [00:33<00:26,  2.16it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.08it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.03it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.01it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.04it/s] 60%|██████    | 77/128 [00:37<00:25,  1.99it/s] 61%|██████    | 78/128 [00:37<00:25,  1.96it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.95it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:39<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.97it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.02it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:42<00:19,  2.06it/s] 69%|██████▉   | 88/128 [00:42<00:18,  2.12it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.04it/s] 70%|███████   | 90/128 [00:43<00:18,  2.07it/s] 71%|███████   | 91/128 [00:44<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.07it/s] 73%|███████▎  | 94/128 [00:45<00:15,  2.13it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.04it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.06it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.02it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.05it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.99it/s] 79%|███████▉  | 101/128 [00:49<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:49<00:13,  1.96it/s] 80%|████████  | 103/128 [00:50<00:11,  2.11it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.15it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.14it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.07it/s] 84%|████████▎ | 107/128 [00:51<00:09,  2.12it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.12it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.07it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.09it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.04it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.09it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.11it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.05it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.02it/s] 91%|█████████▏| 117/128 [00:56<00:05,  1.99it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.06it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.09it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.04it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.07it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.12it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.15it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.08it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:01<00:00,  1.99it/s]100%|██████████| 128/128 [01:02<00:00,  2.03it/s]100%|██████████| 128/128 [01:02<00:00,  2.06it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.20s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.15s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.09s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.84s/it]
[2024-01-18 08:31:37,069] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 54%|█████▍    | 69/128 [00:00<00:00, 682.27it/s]100%|██████████| 128/128 [00:00<00:00, 684.98it/s]
[2024-01-18 08:31:37,393] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.17it/s]  2%|▏         | 2/128 [00:00<01:01,  2.03it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:01<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:03<01:01,  1.98it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:54,  2.17it/s]  8%|▊         | 10/128 [00:04<00:56,  2.10it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:53,  2.16it/s] 10%|█         | 13/128 [00:06<00:53,  2.16it/s] 11%|█         | 14/128 [00:06<00:54,  2.10it/s] 12%|█▏        | 15/128 [00:07<00:51,  2.20it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.12it/s] 13%|█▎        | 17/128 [00:08<00:51,  2.14it/s] 14%|█▍        | 18/128 [00:08<00:52,  2.08it/s] 15%|█▍        | 19/128 [00:09<00:50,  2.14it/s] 16%|█▌        | 20/128 [00:09<00:48,  2.22it/s] 16%|█▋        | 21/128 [00:09<00:47,  2.24it/s] 17%|█▋        | 22/128 [00:10<00:47,  2.25it/s] 18%|█▊        | 23/128 [00:10<00:46,  2.26it/s] 19%|█▉        | 24/128 [00:11<00:46,  2.26it/s] 20%|█▉        | 25/128 [00:11<00:44,  2.31it/s] 20%|██        | 26/128 [00:12<00:46,  2.17it/s] 21%|██        | 27/128 [00:12<00:47,  2.11it/s] 22%|██▏       | 28/128 [00:13<00:48,  2.06it/s] 23%|██▎       | 29/128 [00:13<00:48,  2.02it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.13it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.02it/s] 26%|██▌       | 33/128 [00:15<00:47,  2.00it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.08it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.10it/s] 29%|██▉       | 37/128 [00:17<00:41,  2.19it/s] 30%|██▉       | 38/128 [00:17<00:43,  2.09it/s] 30%|███       | 39/128 [00:18<00:42,  2.11it/s] 31%|███▏      | 40/128 [00:18<00:42,  2.07it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:20<00:41,  2.02it/s] 35%|███▌      | 45/128 [00:21<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:21<00:40,  2.04it/s] 37%|███▋      | 47/128 [00:22<00:40,  2.02it/s] 38%|███▊      | 48/128 [00:22<00:38,  2.06it/s] 38%|███▊      | 49/128 [00:23<00:37,  2.09it/s] 39%|███▉      | 50/128 [00:23<00:37,  2.11it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.12it/s] 41%|████      | 52/128 [00:24<00:35,  2.14it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.08it/s] 42%|████▏     | 54/128 [00:25<00:34,  2.13it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.17it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.08it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.03it/s] 45%|████▌     | 58/128 [00:27<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:28<00:34,  1.99it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.04it/s] 48%|████▊     | 61/128 [00:29<00:33,  1.99it/s] 48%|████▊     | 62/128 [00:29<00:33,  1.98it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.98it/s] 50%|█████     | 64/128 [00:30<00:32,  1.95it/s] 51%|█████     | 65/128 [00:31<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:31<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.03it/s] 53%|█████▎    | 68/128 [00:32<00:28,  2.10it/s] 54%|█████▍    | 69/128 [00:33<00:26,  2.21it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.12it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.07it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.03it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.07it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.04it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.01it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.97it/s] 60%|██████    | 77/128 [00:37<00:26,  1.95it/s] 61%|██████    | 78/128 [00:37<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:38<00:24,  2.00it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.99it/s] 63%|██████▎   | 81/128 [00:39<00:23,  2.03it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.99it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.05it/s] 68%|██████▊   | 87/128 [00:42<00:19,  2.11it/s] 69%|██████▉   | 88/128 [00:42<00:19,  2.04it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.07it/s] 70%|███████   | 90/128 [00:43<00:18,  2.09it/s] 71%|███████   | 91/128 [00:43<00:16,  2.18it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.12it/s] 73%|███████▎  | 93/128 [00:44<00:16,  2.07it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.09it/s] 74%|███████▍  | 95/128 [00:45<00:16,  2.05it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.02it/s] 76%|███████▌  | 97/128 [00:46<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:47<00:15,  1.97it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.09it/s] 79%|███████▉  | 101/128 [00:48<00:12,  2.21it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.12it/s] 80%|████████  | 103/128 [00:49<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.13it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.13it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.05it/s] 84%|████████▎ | 107/128 [00:51<00:10,  2.02it/s] 84%|████████▍ | 108/128 [00:52<00:10,  1.99it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.06it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.16it/s] 87%|████████▋ | 111/128 [00:53<00:07,  2.19it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.17it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.08it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.12it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.16it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.09it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.13it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.17it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.19it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.11it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.12it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.12it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.07it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.13it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.16it/s]100%|██████████| 128/128 [01:01<00:00,  2.15it/s]100%|██████████| 128/128 [01:01<00:00,  2.08it/s]
[2024-01-18 08:32:38,981] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.14it/s]  2%|▏         | 2/128 [00:00<01:02,  2.00it/s]  2%|▏         | 3/128 [00:01<01:03,  1.97it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:03,  1.95it/s]  5%|▍         | 6/128 [00:03<01:02,  1.95it/s]  5%|▌         | 7/128 [00:03<01:02,  1.95it/s]  6%|▋         | 8/128 [00:04<00:59,  2.03it/s]  7%|▋         | 9/128 [00:04<00:55,  2.14it/s]  8%|▊         | 10/128 [00:04<00:57,  2.07it/s]  9%|▊         | 11/128 [00:05<00:56,  2.09it/s]  9%|▉         | 12/128 [00:05<00:54,  2.13it/s] 10%|█         | 13/128 [00:06<00:54,  2.13it/s] 11%|█         | 14/128 [00:06<00:54,  2.07it/s] 12%|█▏        | 15/128 [00:07<00:52,  2.17it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.09it/s] 13%|█▎        | 17/128 [00:08<00:52,  2.10it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.05it/s] 15%|█▍        | 19/128 [00:09<00:51,  2.11it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.19it/s] 16%|█▋        | 21/128 [00:10<00:48,  2.21it/s] 17%|█▋        | 22/128 [00:10<00:47,  2.21it/s] 18%|█▊        | 23/128 [00:10<00:47,  2.22it/s] 19%|█▉        | 24/128 [00:11<00:46,  2.23it/s] 20%|█▉        | 25/128 [00:11<00:45,  2.28it/s] 20%|██        | 26/128 [00:12<00:47,  2.14it/s] 21%|██        | 27/128 [00:12<00:48,  2.08it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:13<00:49,  2.00it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.10it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  2.00it/s] 26%|██▌       | 33/128 [00:15<00:47,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.05it/s] 27%|██▋       | 35/128 [00:16<00:46,  2.01it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.07it/s] 29%|██▉       | 37/128 [00:17<00:42,  2.12it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.03it/s] 30%|███       | 39/128 [00:18<00:43,  2.06it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.02it/s] 32%|███▏      | 41/128 [00:19<00:46,  1.88it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.89it/s] 34%|███▎      | 43/128 [00:20<00:44,  1.90it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.94it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:22<00:40,  1.98it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.02it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.05it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.09it/s] 41%|████      | 52/128 [00:25<00:36,  2.11it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.11it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.14it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.00it/s] 46%|████▌     | 59/128 [00:28<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.02it/s] 48%|████▊     | 61/128 [00:29<00:33,  1.97it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.96it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.96it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:31<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:33<00:26,  2.19it/s] 55%|█████▍    | 70/128 [00:34<00:27,  2.10it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.03it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.00it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.04it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.01it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.95it/s] 60%|██████    | 77/128 [00:37<00:26,  1.93it/s] 61%|██████    | 78/128 [00:38<00:25,  1.92it/s] 62%|██████▏   | 79/128 [00:38<00:24,  1.98it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.97it/s] 63%|██████▎   | 81/128 [00:39<00:23,  2.02it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.97it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.02it/s] 66%|██████▋   | 85/128 [00:41<00:21,  1.99it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:42<00:19,  2.09it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.03it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.06it/s] 70%|███████   | 90/128 [00:44<00:18,  2.08it/s] 71%|███████   | 91/128 [00:44<00:17,  2.13it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.07it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.06it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.03it/s] 75%|███████▌  | 96/128 [00:47<00:16,  2.00it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.01it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.20it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.11it/s] 80%|████████  | 103/128 [00:50<00:11,  2.11it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.12it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.12it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.03it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.01it/s] 84%|████████▍ | 108/128 [00:52<00:10,  1.98it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.05it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.14it/s] 87%|████████▋ | 111/128 [00:54<00:07,  2.18it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.16it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.07it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.09it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.10it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.14it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.07it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.12it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.16it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.18it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.10it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.10it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.11it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.06it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.12it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.15it/s]100%|██████████| 128/128 [01:02<00:00,  2.14it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:05<00:10,  5.10s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.54s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.33s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.17s/it]
[2024-01-18 08:34:36,369] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 41%|████▏     | 53/128 [00:00<00:00, 524.54it/s] 97%|█████████▋| 124/128 [00:00<00:00, 627.69it/s]100%|██████████| 128/128 [00:00<00:00, 615.33it/s]
[2024-01-18 08:34:36,704] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:00<00:59,  2.14it/s]  2%|▏         | 3/128 [00:01<00:58,  2.15it/s]  3%|▎         | 4/128 [00:01<00:59,  2.08it/s]  4%|▍         | 5/128 [00:02<01:01,  2.01it/s]  5%|▍         | 6/128 [00:02<00:58,  2.10it/s]  5%|▌         | 7/128 [00:03<00:58,  2.05it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:58,  2.05it/s]  8%|▊         | 10/128 [00:04<00:54,  2.16it/s]  9%|▊         | 11/128 [00:05<00:52,  2.24it/s]  9%|▉         | 12/128 [00:05<00:52,  2.22it/s] 10%|█         | 13/128 [00:06<00:53,  2.14it/s] 11%|█         | 14/128 [00:06<00:53,  2.15it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.08it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.04it/s] 13%|█▎        | 17/128 [00:08<00:55,  2.00it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.07it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.10it/s] 16%|█▋        | 21/128 [00:09<00:49,  2.15it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.09it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.11it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.16it/s] 20%|█▉        | 25/128 [00:11<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:48,  2.10it/s] 21%|██        | 27/128 [00:12<00:49,  2.06it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.14it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.08it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.04it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:15<00:47,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.04it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.10it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.15it/s] 29%|██▉       | 37/128 [00:17<00:46,  1.96it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.95it/s] 30%|███       | 39/128 [00:18<00:46,  1.93it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.92it/s] 32%|███▏      | 41/128 [00:19<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.95it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.95it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.93it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.92it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.93it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.10it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.05it/s] 41%|████      | 52/128 [00:25<00:37,  2.02it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:34,  2.16it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.09it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.02it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.09it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.05it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.00it/s] 48%|████▊     | 61/128 [00:29<00:33,  1.98it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.95it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:32,  1.96it/s] 51%|█████     | 65/128 [00:31<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.96it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.04it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.10it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.05it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:34<00:30,  1.87it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.97it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.96it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.04it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.99it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.95it/s] 60%|██████    | 77/128 [00:37<00:26,  1.95it/s] 61%|██████    | 78/128 [00:38<00:25,  1.95it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.95it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:40<00:23,  2.00it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.99it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.09it/s] 67%|██████▋   | 86/128 [00:42<00:19,  2.11it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.09it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.04it/s] 70%|███████   | 90/128 [00:44<00:18,  2.10it/s] 71%|███████   | 91/128 [00:44<00:17,  2.11it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.00it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.04it/s] 74%|███████▍  | 95/128 [00:46<00:15,  2.10it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.03it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.00it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.99it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.06it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.04it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.07it/s] 80%|████████  | 103/128 [00:50<00:11,  2.12it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.13it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:52<00:10,  2.01it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.04it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.15it/s] 85%|████████▌ | 109/128 [00:53<00:08,  2.14it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.08it/s] 87%|████████▋ | 111/128 [00:54<00:07,  2.13it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.05it/s] 88%|████████▊ | 113/128 [00:55<00:06,  2.15it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.09it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.14it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.08it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.18it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.17it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.09it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.03it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.00it/s] 95%|█████████▌| 122/128 [00:59<00:03,  1.98it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.97it/s] 97%|█████████▋| 124/128 [01:00<00:02,  1.96it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.08it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.10it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.14it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 08:35:39,421] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.93it/s]  2%|▏         | 2/128 [00:00<00:59,  2.10it/s]  2%|▏         | 3/128 [00:01<00:59,  2.11it/s]  3%|▎         | 4/128 [00:01<01:00,  2.05it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:02<00:58,  2.07it/s]  5%|▌         | 7/128 [00:03<00:59,  2.02it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:58,  2.02it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:52,  2.22it/s]  9%|▉         | 12/128 [00:05<00:52,  2.19it/s] 10%|█         | 13/128 [00:06<00:54,  2.11it/s] 11%|█         | 14/128 [00:06<00:53,  2.12it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.98it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.97it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.04it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.07it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.13it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.06it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.08it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.13it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.04it/s] 20%|██        | 26/128 [00:12<00:49,  2.07it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.06it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.97it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.01it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.05it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.11it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.93it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.93it/s] 30%|███       | 39/128 [00:19<00:46,  1.91it/s] 31%|███▏      | 40/128 [00:19<00:46,  1.90it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.92it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.93it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.91it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.91it/s] 36%|███▌      | 46/128 [00:22<00:43,  1.90it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.91it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.96it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.08it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.03it/s] 41%|████      | 52/128 [00:25<00:37,  2.01it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:26<00:34,  2.14it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.08it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.01it/s] 45%|████▍     | 57/128 [00:28<00:34,  2.07it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.03it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.99it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.97it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.94it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.94it/s] 50%|█████     | 64/128 [00:31<00:32,  1.94it/s] 51%|█████     | 65/128 [00:32<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.94it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.03it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.00it/s] 55%|█████▌    | 71/128 [00:35<00:30,  1.86it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.96it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.94it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.02it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:37<00:28,  1.85it/s] 60%|██████    | 77/128 [00:38<00:27,  1.87it/s] 61%|██████    | 78/128 [00:38<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.97it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.07it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.09it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.08it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.02it/s] 70%|███████   | 90/128 [00:44<00:18,  2.08it/s] 71%|███████   | 91/128 [00:45<00:17,  2.09it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.97it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.02it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.97it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.05it/s] 80%|████████  | 103/128 [00:51<00:11,  2.10it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.11it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.03it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.99it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.09it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.10it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.10it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.13it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.12it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.16it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.15it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.07it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.01it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.99it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.96it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.95it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.07it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.08it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.13it/s]100%|██████████| 128/128 [01:03<00:00,  2.04it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.11s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.10s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.07s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.81s/it]
[2024-01-18 08:37:36,755] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 53%|█████▎    | 68/128 [00:00<00:00, 674.69it/s]100%|██████████| 128/128 [00:00<00:00, 670.09it/s]
[2024-01-18 08:37:37,082] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.97it/s]  2%|▏         | 2/128 [00:00<01:00,  2.09it/s]  2%|▏         | 3/128 [00:01<01:01,  2.03it/s]  3%|▎         | 4/128 [00:01<01:02,  2.00it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:02<00:59,  2.04it/s]  5%|▌         | 7/128 [00:03<01:00,  2.01it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:04<00:56,  2.10it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:52,  2.19it/s] 10%|█         | 13/128 [00:06<00:54,  2.12it/s] 11%|█         | 14/128 [00:06<00:55,  2.07it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.03it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.01it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.97it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.05it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.09it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.14it/s] 16%|█▋        | 21/128 [00:10<00:49,  2.15it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.04it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:12<00:46,  2.20it/s] 20%|██        | 26/128 [00:12<00:48,  2.09it/s] 21%|██        | 27/128 [00:13<00:49,  2.04it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.15it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.02it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.06it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.16it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.07it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.01it/s] 30%|███       | 39/128 [00:18<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.98it/s] 32%|███▏      | 41/128 [00:20<00:47,  1.85it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.93it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.95it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.95it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.93it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.00it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.06it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.12it/s] 41%|████      | 52/128 [00:25<00:37,  2.05it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.08it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.10it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.14it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.06it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.03it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:28<00:34,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:31<00:35,  1.83it/s] 50%|█████     | 64/128 [00:31<00:34,  1.86it/s] 51%|█████     | 65/128 [00:32<00:33,  1.87it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.95it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.01it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.12it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.07it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.05it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.01it/s] 58%|█████▊    | 74/128 [00:36<00:25,  2.12it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.05it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.99it/s] 60%|██████    | 77/128 [00:38<00:25,  1.96it/s] 61%|██████    | 78/128 [00:38<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.99it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.03it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.08it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.04it/s] 70%|███████   | 90/128 [00:44<00:18,  2.09it/s] 71%|███████   | 91/128 [00:44<00:18,  2.04it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.07it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.06it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.00it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.98it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.03it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.09it/s] 77%|███████▋  | 99/128 [00:48<00:13,  2.10it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.11it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.12it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.13it/s] 80%|████████  | 103/128 [00:50<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.93it/s] 82%|████████▏ | 105/128 [00:51<00:11,  1.94it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.93it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.01it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.98it/s] 85%|████████▌ | 109/128 [00:53<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:54<00:09,  1.96it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.03it/s] 89%|████████▉ | 114/128 [00:56<00:07,  2.00it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.04it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.09it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.04it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.07it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.03it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.99it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.03it/s] 97%|█████████▋| 124/128 [01:01<00:02,  2.00it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:02<00:00,  1.99it/s]100%|██████████| 128/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
[2024-01-18 08:38:40,389] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.93it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<01:02,  1.99it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:03,  1.95it/s]  5%|▍         | 6/128 [00:03<01:00,  2.00it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:04<00:59,  2.03it/s]  7%|▋         | 9/128 [00:04<00:59,  2.00it/s]  8%|▊         | 10/128 [00:04<00:57,  2.07it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:54,  2.13it/s] 10%|█         | 13/128 [00:06<00:55,  2.07it/s] 11%|█         | 14/128 [00:06<00:56,  2.03it/s] 12%|█▏        | 15/128 [00:07<00:56,  1.99it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.97it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.94it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.02it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.05it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.05it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.01it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.07it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.17it/s] 20%|██        | 26/128 [00:12<00:49,  2.06it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.12it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.01it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.12it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.03it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.98it/s] 30%|███       | 39/128 [00:19<00:45,  1.96it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.95it/s] 32%|███▏      | 41/128 [00:20<00:47,  1.82it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.91it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.90it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.91it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.91it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.96it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.04it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.10it/s] 41%|████      | 52/128 [00:25<00:37,  2.02it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.05it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.08it/s] 43%|████▎     | 55/128 [00:27<00:34,  2.12it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.04it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.97it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:29<00:35,  1.93it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.91it/s] 49%|████▉     | 63/128 [00:31<00:35,  1.81it/s] 50%|█████     | 64/128 [00:32<00:34,  1.84it/s] 51%|█████     | 65/128 [00:32<00:33,  1.85it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.93it/s] 52%|█████▏    | 67/128 [00:33<00:30,  1.99it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.10it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.05it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.01it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.96it/s] 56%|█████▋    | 72/128 [00:36<00:27,  2.03it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:36<00:25,  2.11it/s] 59%|█████▊    | 75/128 [00:37<00:26,  2.03it/s] 59%|█████▉    | 76/128 [00:38<00:26,  1.98it/s] 60%|██████    | 77/128 [00:38<00:26,  1.95it/s] 61%|██████    | 78/128 [00:39<00:26,  1.92it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.93it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.98it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.02it/s] 66%|██████▌   | 84/128 [00:42<00:22,  2.00it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.07it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.00it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.98it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.03it/s] 70%|███████   | 90/128 [00:45<00:18,  2.08it/s] 71%|███████   | 91/128 [00:45<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.05it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.99it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.97it/s] 76%|███████▌  | 97/128 [00:48<00:15,  2.01it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.07it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.09it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.10it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.11it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.12it/s] 80%|████████  | 103/128 [00:51<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.93it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.98it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.97it/s] 86%|████████▌ | 110/128 [00:54<00:09,  1.97it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.02it/s] 89%|████████▉ | 114/128 [00:56<00:07,  2.00it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.08it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.04it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.06it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.02it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.98it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.03it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.99it/s]100%|██████████| 128/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:03<00:00,  2.00it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.74s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.38s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.29s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.08s/it]
[2024-01-18 08:40:39,063] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 41%|████▏     | 53/128 [00:00<00:00, 525.01it/s] 97%|█████████▋| 124/128 [00:00<00:00, 627.89it/s]100%|██████████| 128/128 [00:00<00:00, 613.65it/s]
[2024-01-18 08:40:39,401] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.30it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<00:58,  2.15it/s]  3%|▎         | 4/128 [00:01<00:59,  2.07it/s]  4%|▍         | 5/128 [00:02<01:00,  2.03it/s]  5%|▍         | 6/128 [00:02<01:01,  1.99it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:03<01:00,  1.97it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:04<00:54,  2.15it/s]  9%|▊         | 11/128 [00:05<00:56,  2.08it/s]  9%|▉         | 12/128 [00:05<00:54,  2.11it/s] 10%|█         | 13/128 [00:06<00:55,  2.07it/s] 11%|█         | 14/128 [00:06<00:56,  2.04it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.07it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.04it/s] 13%|█▎        | 17/128 [00:08<00:55,  1.99it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.99it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.06it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.01it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.04it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.15it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.18it/s] 20%|██        | 26/128 [00:12<00:48,  2.11it/s] 21%|██        | 27/128 [00:13<00:49,  2.04it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.00it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.05it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.03it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:50,  1.86it/s] 27%|██▋       | 35/128 [00:17<00:49,  1.89it/s] 28%|██▊       | 36/128 [00:17<00:46,  2.00it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.98it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.98it/s] 30%|███       | 39/128 [00:19<00:43,  2.03it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.99it/s] 32%|███▏      | 41/128 [00:20<00:43,  1.98it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.04it/s] 34%|███▎      | 43/128 [00:21<00:42,  2.01it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.98it/s] 35%|███▌      | 45/128 [00:22<00:40,  2.03it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:23<00:40,  1.98it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:37,  2.10it/s] 39%|███▉      | 50/128 [00:24<00:35,  2.19it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.18it/s] 41%|████      | 52/128 [00:25<00:36,  2.10it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.05it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.99it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.98it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.98it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.97it/s] 46%|████▌     | 59/128 [00:29<00:33,  2.05it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.02it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.00it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.99it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.95it/s] 50%|█████     | 64/128 [00:31<00:32,  1.96it/s] 51%|█████     | 65/128 [00:32<00:30,  2.04it/s] 52%|█████▏    | 66/128 [00:32<00:29,  2.10it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.05it/s] 53%|█████▎    | 68/128 [00:33<00:27,  2.16it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.08it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.05it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.02it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.99it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.96it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.04it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.01it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.97it/s] 60%|██████    | 77/128 [00:38<00:26,  1.94it/s] 61%|██████    | 78/128 [00:38<00:24,  2.00it/s] 62%|██████▏   | 79/128 [00:39<00:24,  1.97it/s] 62%|██████▎   | 80/128 [00:39<00:23,  2.02it/s] 63%|██████▎   | 81/128 [00:39<00:22,  2.05it/s] 64%|██████▍   | 82/128 [00:40<00:22,  2.08it/s] 65%|██████▍   | 83/128 [00:40<00:22,  2.02it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.05it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.11it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.06it/s] 68%|██████▊   | 87/128 [00:42<00:19,  2.08it/s] 69%|██████▉   | 88/128 [00:43<00:18,  2.17it/s] 70%|██████▉   | 89/128 [00:43<00:17,  2.19it/s] 70%|███████   | 90/128 [00:44<00:18,  2.10it/s] 71%|███████   | 91/128 [00:44<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.08it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:46<00:17,  2.00it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.96it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.01it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.99it/s] 77%|███████▋  | 99/128 [00:48<00:13,  2.11it/s] 78%|███████▊  | 100/128 [00:49<00:12,  2.19it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.10it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.12it/s] 80%|████████  | 103/128 [00:50<00:11,  2.16it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.08it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.01it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.08it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.10it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.11it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.11it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.13it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.09it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.04it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.01it/s] 92%|█████████▏| 118/128 [00:57<00:05,  1.96it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.04it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.01it/s] 95%|█████████▍| 121/128 [00:59<00:03,  1.98it/s] 95%|█████████▌| 122/128 [00:59<00:03,  1.95it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.04it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.01it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.11it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.05it/s]100%|██████████| 128/128 [01:02<00:00,  2.07it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 08:41:42,200] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.26it/s]  2%|▏         | 2/128 [00:00<01:02,  2.02it/s]  2%|▏         | 3/128 [00:01<00:59,  2.11it/s]  3%|▎         | 4/128 [00:01<01:01,  2.03it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:02<01:02,  1.95it/s]  5%|▌         | 7/128 [00:03<01:02,  1.94it/s]  6%|▋         | 8/128 [00:04<01:01,  1.94it/s]  7%|▋         | 9/128 [00:04<00:59,  2.00it/s]  8%|▊         | 10/128 [00:04<00:55,  2.11it/s]  9%|▊         | 11/128 [00:05<00:57,  2.04it/s]  9%|▉         | 12/128 [00:05<00:55,  2.07it/s] 10%|█         | 13/128 [00:06<00:56,  2.03it/s] 11%|█         | 14/128 [00:06<00:57,  2.00it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.04it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.00it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.96it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.95it/s] 16%|█▌        | 20/128 [00:09<00:53,  2.03it/s] 16%|█▋        | 21/128 [00:10<00:54,  1.98it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.04it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.00it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.11it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.14it/s] 20%|██        | 26/128 [00:12<00:49,  2.08it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.97it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.04it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.00it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:17<00:51,  1.84it/s] 27%|██▋       | 35/128 [00:17<00:49,  1.86it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.96it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.95it/s] 30%|██▉       | 38/128 [00:19<00:46,  1.95it/s] 30%|███       | 39/128 [00:19<00:44,  2.00it/s] 31%|███▏      | 40/128 [00:20<00:44,  1.96it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.96it/s] 33%|███▎      | 42/128 [00:21<00:42,  2.00it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.98it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.95it/s] 35%|███▌      | 45/128 [00:22<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:23<00:41,  1.96it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.94it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.07it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.16it/s] 40%|███▉      | 51/128 [00:25<00:35,  2.15it/s] 41%|████      | 52/128 [00:25<00:36,  2.07it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.02it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.99it/s] 43%|████▎     | 55/128 [00:27<00:37,  1.97it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.96it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.95it/s] 45%|████▌     | 58/128 [00:29<00:36,  1.94it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.98it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.97it/s] 48%|████▊     | 62/128 [00:31<00:33,  1.96it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.93it/s] 50%|█████     | 64/128 [00:32<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:31,  2.01it/s] 52%|█████▏    | 66/128 [00:33<00:29,  2.08it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.03it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.14it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.08it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.04it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.98it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.94it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.02it/s] 59%|█████▊    | 75/128 [00:37<00:26,  2.00it/s] 59%|█████▉    | 76/128 [00:38<00:26,  1.95it/s] 60%|██████    | 77/128 [00:38<00:26,  1.93it/s] 61%|██████    | 78/128 [00:39<00:25,  1.99it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.95it/s] 62%|██████▎   | 80/128 [00:40<00:23,  2.00it/s] 63%|██████▎   | 81/128 [00:40<00:23,  2.04it/s] 64%|██████▍   | 82/128 [00:40<00:22,  2.07it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.01it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.06it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:19,  2.05it/s] 69%|██████▉   | 88/128 [00:43<00:18,  2.11it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.14it/s] 70%|███████   | 90/128 [00:44<00:18,  2.07it/s] 71%|███████   | 91/128 [00:45<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.99it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:15,  2.00it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.10it/s] 78%|███████▊  | 100/128 [00:49<00:12,  2.19it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.10it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.11it/s] 80%|████████  | 103/128 [00:51<00:11,  2.15it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.08it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.01it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.08it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.10it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.11it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.06it/s] 88%|████████▊ | 112/128 [00:55<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.10it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.08it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.03it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.00it/s] 92%|█████████▏| 118/128 [00:58<00:05,  1.96it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.04it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.00it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.98it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.95it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.04it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.01it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.11it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.05it/s]100%|██████████| 128/128 [01:03<00:00,  2.08it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.10s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.10s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.03s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.78s/it]
[2024-01-18 08:43:39,486] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 53%|█████▎    | 68/128 [00:00<00:00, 677.73it/s]100%|██████████| 128/128 [00:00<00:00, 680.24it/s]
[2024-01-18 08:43:39,811] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.18it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<01:02,  2.01it/s]  3%|▎         | 4/128 [00:01<01:02,  1.99it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:03<01:01,  1.98it/s]  5%|▌         | 7/128 [00:03<01:01,  1.97it/s]  6%|▋         | 8/128 [00:03<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:54,  2.18it/s]  9%|▊         | 11/128 [00:05<00:52,  2.21it/s]  9%|▉         | 12/128 [00:05<00:52,  2.20it/s] 10%|█         | 13/128 [00:06<00:54,  2.12it/s] 11%|█         | 14/128 [00:06<00:53,  2.14it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.09it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.05it/s] 13%|█▎        | 17/128 [00:08<00:55,  2.00it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.05it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.02it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.14it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.08it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.10it/s] 18%|█▊        | 23/128 [00:11<00:49,  2.12it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.17it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.10it/s] 20%|██        | 26/128 [00:12<00:49,  2.05it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.07it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.03it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.97it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.05it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.08it/s] 29%|██▉       | 37/128 [00:17<00:45,  2.02it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:18<00:45,  1.96it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.03it/s] 34%|███▎      | 43/128 [00:20<00:42,  2.00it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.98it/s] 35%|███▌      | 45/128 [00:22<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:22<00:44,  1.85it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.95it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.14it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.15it/s] 41%|████      | 52/128 [00:25<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.07it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.13it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.08it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.03it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.00it/s] 46%|████▌     | 59/128 [00:28<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.97it/s] 48%|████▊     | 61/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.92it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.04it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.11it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.05it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.00it/s] 55%|█████▌    | 71/128 [00:34<00:29,  1.96it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.04it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:36<00:25,  2.15it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.06it/s] 59%|█████▉    | 76/128 [00:37<00:25,  2.01it/s] 60%|██████    | 77/128 [00:37<00:25,  2.00it/s] 61%|██████    | 78/128 [00:38<00:25,  1.98it/s] 62%|██████▏   | 79/128 [00:38<00:24,  1.98it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.96it/s] 63%|██████▎   | 81/128 [00:39<00:23,  1.96it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.95it/s] 65%|██████▍   | 83/128 [00:40<00:21,  2.08it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.04it/s] 66%|██████▋   | 85/128 [00:41<00:19,  2.15it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.07it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.07it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.12it/s] 70%|███████   | 90/128 [00:44<00:17,  2.21it/s] 71%|███████   | 91/128 [00:44<00:17,  2.12it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.06it/s] 74%|███████▍  | 95/128 [00:46<00:17,  1.90it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.91it/s] 76%|███████▌  | 97/128 [00:47<00:16,  1.92it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.99it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.06it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.10it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.11it/s] 80%|████████  | 103/128 [00:50<00:11,  2.20it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.09it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.05it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.99it/s] 84%|████████▎ | 107/128 [00:52<00:09,  2.11it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.15it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.08it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.10it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.09it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.05it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.05it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.08it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.10it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.00it/s] 94%|█████████▍| 120/128 [00:58<00:04,  1.98it/s] 95%|█████████▍| 121/128 [00:59<00:03,  1.96it/s] 95%|█████████▌| 122/128 [00:59<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.95it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.09it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.11it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.15it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.08it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 08:44:42,599] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:58,  2.15it/s]  2%|▏         | 2/128 [00:00<01:02,  2.02it/s]  2%|▏         | 3/128 [00:01<01:03,  1.98it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:02,  1.96it/s]  5%|▍         | 6/128 [00:03<01:02,  1.96it/s]  5%|▌         | 7/128 [00:03<01:02,  1.95it/s]  6%|▋         | 8/128 [00:04<00:59,  2.01it/s]  7%|▋         | 9/128 [00:04<00:58,  2.05it/s]  8%|▊         | 10/128 [00:04<00:54,  2.15it/s]  9%|▊         | 11/128 [00:05<00:53,  2.18it/s]  9%|▉         | 12/128 [00:05<00:53,  2.17it/s] 10%|█         | 13/128 [00:06<00:54,  2.09it/s] 11%|█         | 14/128 [00:06<00:54,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.98it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.02it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.99it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.05it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.09it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.13it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:50,  2.02it/s] 21%|██        | 27/128 [00:13<00:50,  2.00it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.98it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.04it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.01it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.96it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.94it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.06it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.99it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.97it/s] 30%|███       | 39/128 [00:19<00:45,  1.94it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.91it/s] 33%|███▎      | 42/128 [00:20<00:43,  2.00it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:22<00:44,  1.82it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.12it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.12it/s] 41%|████      | 52/128 [00:25<00:37,  2.05it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.05it/s] 43%|████▎     | 55/128 [00:27<00:34,  2.10it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.90it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.89it/s] 50%|█████     | 64/128 [00:31<00:33,  1.91it/s] 51%|█████     | 65/128 [00:32<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.09it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.03it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.98it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.94it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.02it/s] 57%|█████▋    | 73/128 [00:36<00:27,  1.98it/s] 58%|█████▊    | 74/128 [00:36<00:25,  2.12it/s] 59%|█████▊    | 75/128 [00:37<00:25,  2.04it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.98it/s] 60%|██████    | 77/128 [00:38<00:25,  1.97it/s] 61%|██████    | 78/128 [00:38<00:25,  1.96it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.96it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.94it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:41<00:21,  2.05it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.02it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.12it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.04it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.10it/s] 70%|███████   | 90/128 [00:44<00:17,  2.18it/s] 71%|███████   | 91/128 [00:45<00:17,  2.09it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.00it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.03it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.89it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.90it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.90it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.04it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.08it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.09it/s] 80%|████████  | 103/128 [00:51<00:11,  2.18it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.08it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.03it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.97it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.09it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.13it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.06it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.08it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.02it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.08it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.04it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.08it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.02it/s] 93%|█████████▎| 119/128 [00:59<00:04,  1.99it/s] 94%|█████████▍| 120/128 [00:59<00:04,  1.97it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.96it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.95it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.09it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.10it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.14it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.08it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.13s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.28s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.20s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.94s/it]
[2024-01-18 08:46:40,247] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 40%|███▉      | 51/128 [00:00<00:00, 501.06it/s] 93%|█████████▎| 119/128 [00:00<00:00, 605.53it/s]100%|██████████| 128/128 [00:00<00:00, 596.79it/s]
[2024-01-18 08:46:40,611] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:03,  1.99it/s]  2%|▏         | 2/128 [00:01<01:03,  1.98it/s]  2%|▏         | 3/128 [00:01<01:03,  1.96it/s]  3%|▎         | 4/128 [00:02<01:02,  1.97it/s]  4%|▍         | 5/128 [00:02<01:03,  1.95it/s]  5%|▍         | 6/128 [00:03<01:02,  1.96it/s]  5%|▌         | 7/128 [00:03<01:02,  1.94it/s]  6%|▋         | 8/128 [00:03<00:57,  2.08it/s]  7%|▋         | 9/128 [00:04<00:55,  2.13it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:56,  2.09it/s]  9%|▉         | 12/128 [00:05<00:56,  2.05it/s] 10%|█         | 13/128 [00:06<00:57,  2.01it/s] 11%|█         | 14/128 [00:06<00:57,  1.98it/s] 12%|█▏        | 15/128 [00:07<01:00,  1.85it/s] 12%|█▎        | 16/128 [00:08<00:59,  1.88it/s] 13%|█▎        | 17/128 [00:08<01:01,  1.80it/s] 14%|█▍        | 18/128 [00:09<00:59,  1.84it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.95it/s] 16%|█▌        | 20/128 [00:10<00:55,  1.94it/s] 16%|█▋        | 21/128 [00:10<00:54,  1.95it/s] 17%|█▋        | 22/128 [00:11<00:54,  1.94it/s] 18%|█▊        | 23/128 [00:11<00:53,  1.95it/s] 19%|█▉        | 24/128 [00:12<00:50,  2.08it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.02it/s] 20%|██        | 26/128 [00:13<00:48,  2.09it/s] 21%|██        | 27/128 [00:13<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:14<00:50,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.04it/s] 23%|██▎       | 30/128 [00:15<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.98it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.95it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.94it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.94it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.00it/s] 28%|██▊       | 36/128 [00:18<00:46,  1.99it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.96it/s] 30%|██▉       | 38/128 [00:19<00:46,  1.94it/s] 30%|███       | 39/128 [00:19<00:45,  1.95it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.93it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:21<00:44,  1.95it/s] 34%|███▎      | 43/128 [00:21<00:42,  2.01it/s] 34%|███▍      | 44/128 [00:22<00:40,  2.05it/s] 35%|███▌      | 45/128 [00:22<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:23<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:23<00:40,  1.98it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.05it/s] 39%|███▉      | 50/128 [00:25<00:37,  2.08it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.04it/s] 41%|████      | 52/128 [00:26<00:38,  2.00it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.96it/s] 43%|████▎     | 55/128 [00:27<00:37,  1.94it/s] 44%|████▍     | 56/128 [00:28<00:37,  1.93it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:36,  1.83it/s] 48%|████▊     | 62/128 [00:31<00:35,  1.85it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.88it/s] 50%|█████     | 64/128 [00:32<00:33,  1.90it/s] 51%|█████     | 65/128 [00:32<00:32,  1.97it/s] 52%|█████▏    | 66/128 [00:33<00:30,  2.02it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.06it/s] 53%|█████▎    | 68/128 [00:34<00:29,  2.00it/s] 54%|█████▍    | 69/128 [00:34<00:29,  1.99it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.96it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.04it/s] 56%|█████▋    | 72/128 [00:36<00:26,  2.14it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.06it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.90it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.89it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.89it/s] 60%|██████    | 77/128 [00:39<00:26,  1.89it/s] 61%|██████    | 78/128 [00:39<00:26,  1.92it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.98it/s] 63%|██████▎   | 81/128 [00:41<00:23,  1.97it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:42<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.95it/s] 66%|██████▋   | 85/128 [00:43<00:22,  1.95it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.95it/s] 68%|██████▊   | 87/128 [00:44<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.06it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.03it/s] 70%|███████   | 90/128 [00:45<00:18,  2.06it/s] 71%|███████   | 91/128 [00:46<00:18,  2.01it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.97it/s] 73%|███████▎  | 93/128 [00:47<00:18,  1.94it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:48<00:16,  2.00it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.99it/s] 76%|███████▌  | 97/128 [00:49<00:15,  2.04it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.10it/s] 77%|███████▋  | 99/128 [00:50<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.09it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.11it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.03it/s] 80%|████████  | 103/128 [00:51<00:12,  1.99it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.96it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.94it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.03it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.09it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.04it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.12it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.12it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.04it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.07it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:58<00:06,  2.00it/s] 91%|█████████▏| 117/128 [00:58<00:05,  1.99it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.06it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.02it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.05it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:04<00:00,  1.93it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
[2024-01-18 08:47:45,050] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:01<01:04,  1.95it/s]  2%|▏         | 3/128 [00:01<01:04,  1.93it/s]  3%|▎         | 4/128 [00:02<01:03,  1.94it/s]  4%|▍         | 5/128 [00:02<01:04,  1.92it/s]  5%|▍         | 6/128 [00:03<01:03,  1.93it/s]  5%|▌         | 7/128 [00:03<01:03,  1.91it/s]  6%|▋         | 8/128 [00:04<00:58,  2.05it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:55,  2.11it/s]  9%|▊         | 11/128 [00:05<00:56,  2.06it/s]  9%|▉         | 12/128 [00:05<00:57,  2.03it/s] 10%|█         | 13/128 [00:06<00:58,  1.98it/s] 11%|█         | 14/128 [00:07<00:58,  1.95it/s] 12%|█▏        | 15/128 [00:07<01:01,  1.83it/s] 12%|█▎        | 16/128 [00:08<01:00,  1.86it/s] 13%|█▎        | 17/128 [00:08<01:02,  1.77it/s] 14%|█▍        | 18/128 [00:09<01:00,  1.82it/s] 15%|█▍        | 19/128 [00:09<00:56,  1.93it/s] 16%|█▌        | 20/128 [00:10<00:56,  1.92it/s] 16%|█▋        | 21/128 [00:10<00:55,  1.92it/s] 17%|█▋        | 22/128 [00:11<00:54,  1.93it/s] 18%|█▊        | 23/128 [00:11<00:54,  1.93it/s] 19%|█▉        | 24/128 [00:12<00:51,  2.02it/s] 20%|█▉        | 25/128 [00:12<00:52,  1.98it/s] 20%|██        | 26/128 [00:13<00:49,  2.04it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:14<00:51,  1.96it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.01it/s] 23%|██▎       | 30/128 [00:15<00:49,  1.98it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.95it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.93it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.91it/s] 27%|██▋       | 34/128 [00:17<00:49,  1.91it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.97it/s] 28%|██▊       | 36/128 [00:18<00:46,  1.96it/s] 29%|██▉       | 37/128 [00:18<00:47,  1.93it/s] 30%|██▉       | 38/128 [00:19<00:47,  1.91it/s] 30%|███       | 39/128 [00:20<00:46,  1.92it/s] 31%|███▏      | 40/128 [00:20<00:46,  1.90it/s] 32%|███▏      | 41/128 [00:21<00:45,  1.91it/s] 33%|███▎      | 42/128 [00:21<00:44,  1.92it/s] 34%|███▎      | 43/128 [00:22<00:42,  1.98it/s] 34%|███▍      | 44/128 [00:22<00:41,  2.02it/s] 35%|███▌      | 45/128 [00:23<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:23<00:41,  1.97it/s] 37%|███▋      | 47/128 [00:24<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:25<00:39,  2.02it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.05it/s] 40%|███▉      | 51/128 [00:26<00:38,  2.02it/s] 41%|████      | 52/128 [00:26<00:38,  1.97it/s] 41%|████▏     | 53/128 [00:27<00:38,  1.95it/s] 42%|████▏     | 54/128 [00:27<00:38,  1.94it/s] 43%|████▎     | 55/128 [00:28<00:38,  1.92it/s] 44%|████▍     | 56/128 [00:28<00:37,  1.90it/s] 45%|████▍     | 57/128 [00:29<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.96it/s] 46%|████▌     | 59/128 [00:30<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.92it/s] 48%|████▊     | 61/128 [00:31<00:37,  1.81it/s] 48%|████▊     | 62/128 [00:31<00:36,  1.82it/s] 49%|████▉     | 63/128 [00:32<00:35,  1.86it/s] 50%|█████     | 64/128 [00:32<00:34,  1.87it/s] 51%|█████     | 65/128 [00:33<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:34<00:29,  2.03it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.98it/s] 54%|█████▍    | 69/128 [00:35<00:29,  1.97it/s] 55%|█████▍    | 70/128 [00:35<00:30,  1.93it/s] 55%|█████▌    | 71/128 [00:36<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:36<00:26,  2.12it/s] 57%|█████▋    | 73/128 [00:37<00:27,  2.03it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.88it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.87it/s] 59%|█████▉    | 76/128 [00:39<00:27,  1.87it/s] 60%|██████    | 77/128 [00:39<00:27,  1.87it/s] 61%|██████    | 78/128 [00:40<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:40<00:26,  1.88it/s] 62%|██████▎   | 80/128 [00:41<00:24,  1.95it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.95it/s] 64%|██████▍   | 82/128 [00:42<00:23,  1.95it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.94it/s] 66%|██████▌   | 84/128 [00:43<00:22,  1.93it/s] 66%|██████▋   | 85/128 [00:43<00:22,  1.93it/s] 67%|██████▋   | 86/128 [00:44<00:21,  1.93it/s] 68%|██████▊   | 87/128 [00:44<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:45<00:19,  2.04it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.01it/s] 70%|███████   | 90/128 [00:46<00:18,  2.04it/s] 71%|███████   | 91/128 [00:46<00:18,  1.99it/s] 72%|███████▏  | 92/128 [00:47<00:18,  1.95it/s] 73%|███████▎  | 93/128 [00:47<00:18,  1.92it/s] 73%|███████▎  | 94/128 [00:48<00:17,  1.93it/s] 74%|███████▍  | 95/128 [00:48<00:16,  1.98it/s] 75%|███████▌  | 96/128 [00:49<00:16,  1.97it/s] 76%|███████▌  | 97/128 [00:49<00:15,  2.02it/s] 77%|███████▋  | 98/128 [00:50<00:14,  2.08it/s] 77%|███████▋  | 99/128 [00:50<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:51<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.07it/s] 80%|███████▉  | 102/128 [00:52<00:12,  2.00it/s] 80%|████████  | 103/128 [00:52<00:12,  1.97it/s] 81%|████████▏ | 104/128 [00:53<00:12,  1.94it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.92it/s] 83%|████████▎ | 106/128 [00:54<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.01it/s] 84%|████████▍ | 108/128 [00:55<00:09,  2.07it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.03it/s] 86%|████████▌ | 110/128 [00:56<00:08,  2.00it/s] 87%|████████▋ | 111/128 [00:56<00:08,  2.07it/s] 88%|████████▊ | 112/128 [00:57<00:07,  2.09it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.02it/s] 89%|████████▉ | 114/128 [00:58<00:06,  2.05it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:59<00:06,  1.98it/s] 91%|█████████▏| 117/128 [00:59<00:05,  1.97it/s] 92%|█████████▏| 118/128 [01:00<00:04,  2.02it/s] 93%|█████████▎| 119/128 [01:00<00:04,  2.05it/s] 94%|█████████▍| 120/128 [01:01<00:03,  2.01it/s] 95%|█████████▍| 121/128 [01:01<00:03,  1.99it/s] 95%|█████████▌| 122/128 [01:02<00:03,  1.95it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:03<00:01,  2.04it/s] 98%|█████████▊| 125/128 [01:03<00:01,  2.01it/s] 98%|█████████▊| 126/128 [01:04<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.97it/s]100%|██████████| 128/128 [01:05<00:00,  1.85it/s]100%|██████████| 128/128 [01:05<00:00,  1.96it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.15s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.10s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.06s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.81s/it]
[2024-01-18 08:49:44,065] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 53%|█████▎    | 68/128 [00:00<00:00, 677.45it/s]100%|██████████| 128/128 [00:00<00:00, 672.11it/s]
[2024-01-18 08:49:44,395] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:05,  1.95it/s]  2%|▏         | 2/128 [00:00<01:00,  2.07it/s]  2%|▏         | 3/128 [00:01<01:01,  2.03it/s]  3%|▎         | 4/128 [00:01<00:59,  2.08it/s]  4%|▍         | 5/128 [00:02<01:00,  2.04it/s]  5%|▍         | 6/128 [00:02<01:00,  2.01it/s]  5%|▌         | 7/128 [00:03<01:01,  1.97it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:56,  2.09it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:56,  2.08it/s]  9%|▉         | 12/128 [00:05<00:54,  2.14it/s] 10%|█         | 13/128 [00:06<00:55,  2.07it/s] 11%|█         | 14/128 [00:06<00:56,  2.03it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.00it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.99it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.97it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.96it/s] 15%|█▍        | 19/128 [00:09<00:55,  1.95it/s] 16%|█▌        | 20/128 [00:09<00:53,  2.04it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.01it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.12it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.07it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.12it/s] 20%|██        | 26/128 [00:12<00:49,  2.07it/s] 21%|██        | 27/128 [00:13<00:49,  2.02it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.98it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.03it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.08it/s] 26%|██▌       | 33/128 [00:16<00:47,  2.02it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.00it/s] 27%|██▋       | 35/128 [00:17<00:46,  1.99it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.98it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.03it/s] 30%|██▉       | 38/128 [00:18<00:47,  1.89it/s] 30%|███       | 39/128 [00:19<00:46,  1.91it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.96it/s] 33%|███▎      | 42/128 [00:20<00:46,  1.85it/s] 34%|███▎      | 43/128 [00:21<00:45,  1.88it/s] 34%|███▍      | 44/128 [00:21<00:44,  1.91it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.90it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.91it/s] 37%|███▋      | 47/128 [00:23<00:40,  1.98it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.95it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.01it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.08it/s] 41%|████      | 52/128 [00:25<00:36,  2.10it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.03it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:27<00:34,  2.14it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.08it/s] 45%|████▍     | 57/128 [00:28<00:34,  2.04it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.01it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.96it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.92it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:32<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:33<00:30,  1.98it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.97it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.05it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.01it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:36<00:29,  1.87it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.94it/s] 58%|█████▊    | 74/128 [00:36<00:27,  2.00it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:38<00:28,  1.85it/s] 60%|██████    | 77/128 [00:38<00:27,  1.86it/s] 61%|██████    | 78/128 [00:39<00:26,  1.87it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.89it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.96it/s] 64%|██████▍   | 82/128 [00:41<00:22,  2.01it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.03it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.01it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.04it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.01it/s] 70%|███████   | 90/128 [00:45<00:18,  2.08it/s] 71%|███████   | 91/128 [00:45<00:17,  2.09it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.05it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.03it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.98it/s] 76%|███████▌  | 97/128 [00:48<00:15,  2.03it/s] 77%|███████▋  | 98/128 [00:49<00:15,  2.00it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.12it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.08it/s] 80%|████████  | 103/128 [00:51<00:12,  2.04it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.01it/s] 82%|████████▏ | 105/128 [00:52<00:12,  1.87it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.87it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.05it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.07it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.03it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.00it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.06it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.12it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.07it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.14it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.08it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.04it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.07it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.12it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.06it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.07it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.09it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.11it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.06it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]
[2024-01-18 08:50:48,131] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.93it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:01<01:00,  2.06it/s]  4%|▍         | 5/128 [00:02<01:01,  2.02it/s]  5%|▍         | 6/128 [00:02<01:01,  1.99it/s]  5%|▌         | 7/128 [00:03<01:01,  1.96it/s]  6%|▋         | 8/128 [00:03<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:55,  2.13it/s]  9%|▊         | 11/128 [00:05<00:56,  2.06it/s]  9%|▉         | 12/128 [00:05<00:54,  2.12it/s] 10%|█         | 13/128 [00:06<00:55,  2.06it/s] 11%|█         | 14/128 [00:06<00:56,  2.02it/s] 12%|█▏        | 15/128 [00:07<00:56,  1.99it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.98it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.95it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.94it/s] 15%|█▍        | 19/128 [00:09<00:56,  1.94it/s] 16%|█▌        | 20/128 [00:09<00:53,  2.02it/s] 16%|█▋        | 21/128 [00:10<00:53,  1.99it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.11it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.05it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.08it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.10it/s] 20%|██        | 26/128 [00:12<00:49,  2.05it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.01it/s] 23%|██▎       | 30/128 [00:14<00:49,  1.99it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.98it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.02it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.96it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.96it/s] 28%|██▊       | 36/128 [00:17<00:47,  1.95it/s] 29%|██▉       | 37/128 [00:18<00:45,  2.00it/s] 30%|██▉       | 38/128 [00:19<00:48,  1.86it/s] 30%|███       | 39/128 [00:19<00:47,  1.87it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.94it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:21<00:47,  1.82it/s] 34%|███▎      | 43/128 [00:21<00:45,  1.86it/s] 34%|███▍      | 44/128 [00:22<00:44,  1.89it/s] 35%|███▌      | 45/128 [00:22<00:44,  1.88it/s] 36%|███▌      | 46/128 [00:23<00:43,  1.89it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.93it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.93it/s] 39%|███▉      | 50/128 [00:25<00:39,  1.99it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.06it/s] 41%|████      | 52/128 [00:26<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:27<00:37,  1.99it/s] 43%|████▎     | 55/128 [00:27<00:34,  2.12it/s] 44%|████▍     | 56/128 [00:28<00:34,  2.06it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.94it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.92it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.90it/s] 50%|█████     | 64/128 [00:32<00:33,  1.91it/s] 51%|█████     | 65/128 [00:32<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.95it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.03it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.99it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:36<00:30,  1.85it/s] 57%|█████▋    | 73/128 [00:36<00:29,  1.87it/s] 58%|█████▊    | 74/128 [00:37<00:27,  1.94it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.93it/s] 59%|█████▉    | 76/128 [00:38<00:28,  1.81it/s] 60%|██████    | 77/128 [00:39<00:27,  1.83it/s] 61%|██████    | 78/128 [00:39<00:27,  1.84it/s] 62%|██████▏   | 79/128 [00:40<00:26,  1.86it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.87it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.95it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.95it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.94it/s] 66%|██████▋   | 85/128 [00:43<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:45<00:19,  1.98it/s] 70%|███████   | 90/128 [00:45<00:18,  2.05it/s] 71%|███████   | 91/128 [00:46<00:17,  2.07it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:47<00:17,  2.00it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.96it/s] 74%|███████▍  | 95/128 [00:48<00:16,  2.01it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.96it/s] 76%|███████▌  | 97/128 [00:49<00:15,  2.01it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:50<00:13,  2.09it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.04it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.06it/s] 80%|████████  | 103/128 [00:52<00:12,  2.02it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.98it/s] 82%|████████▏ | 105/128 [00:53<00:12,  1.85it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.85it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.95it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.02it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.05it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.98it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.97it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.04it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.05it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.12it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.06it/s] 93%|█████████▎| 119/128 [01:00<00:04,  2.02it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.05it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.10it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.04it/s] 96%|█████████▌| 123/128 [01:02<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.06it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.08it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.09it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.04it/s]100%|██████████| 128/128 [01:04<00:00,  2.00it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.66s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.33s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.15s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.96s/it]
[2024-01-18 08:52:46,822] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 45%|████▍     | 57/128 [00:00<00:00, 568.44it/s]100%|██████████| 128/128 [00:00<00:00, 647.48it/s]
[2024-01-18 08:52:47,148] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.18it/s]  2%|▏         | 2/128 [00:00<01:03,  1.99it/s]  2%|▏         | 3/128 [00:01<00:58,  2.12it/s]  3%|▎         | 4/128 [00:01<01:00,  2.05it/s]  4%|▍         | 5/128 [00:02<01:01,  2.01it/s]  5%|▍         | 6/128 [00:02<00:58,  2.10it/s]  5%|▌         | 7/128 [00:03<00:59,  2.02it/s]  6%|▋         | 8/128 [00:03<01:00,  1.99it/s]  7%|▋         | 9/128 [00:04<00:56,  2.11it/s]  8%|▊         | 10/128 [00:04<00:53,  2.21it/s]  9%|▊         | 11/128 [00:05<00:53,  2.19it/s]  9%|▉         | 12/128 [00:05<00:54,  2.11it/s] 10%|█         | 13/128 [00:06<00:53,  2.16it/s] 11%|█         | 14/128 [00:06<00:54,  2.09it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.05it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.11it/s] 13%|█▎        | 17/128 [00:08<00:51,  2.15it/s] 14%|█▍        | 18/128 [00:08<00:50,  2.18it/s] 15%|█▍        | 19/128 [00:09<00:51,  2.11it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.07it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.12it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.17it/s] 18%|█▊        | 23/128 [00:10<00:47,  2.20it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.12it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.21it/s] 20%|██        | 26/128 [00:12<00:44,  2.28it/s] 21%|██        | 27/128 [00:12<00:43,  2.33it/s] 22%|██▏       | 28/128 [00:13<00:45,  2.21it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.12it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.17it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:46,  2.05it/s] 26%|██▌       | 33/128 [00:15<00:43,  2.16it/s] 27%|██▋       | 34/128 [00:15<00:44,  2.10it/s] 27%|██▋       | 35/128 [00:16<00:43,  2.12it/s] 28%|██▊       | 36/128 [00:16<00:44,  2.08it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.04it/s] 30%|██▉       | 38/128 [00:17<00:44,  2.02it/s] 30%|███       | 39/128 [00:18<00:42,  2.08it/s] 31%|███▏      | 40/128 [00:18<00:39,  2.21it/s] 32%|███▏      | 41/128 [00:19<00:40,  2.14it/s] 33%|███▎      | 42/128 [00:19<00:40,  2.15it/s] 34%|███▎      | 43/128 [00:20<00:40,  2.09it/s] 34%|███▍      | 44/128 [00:20<00:41,  2.03it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:21<00:40,  2.05it/s] 37%|███▋      | 47/128 [00:22<00:38,  2.11it/s] 38%|███▊      | 48/128 [00:22<00:38,  2.06it/s] 38%|███▊      | 49/128 [00:23<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:23<00:39,  2.00it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.05it/s] 41%|████      | 52/128 [00:24<00:37,  2.02it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.13it/s] 42%|████▏     | 54/128 [00:25<00:33,  2.22it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.20it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.10it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.05it/s] 45%|████▌     | 58/128 [00:27<00:33,  2.08it/s] 46%|████▌     | 59/128 [00:27<00:32,  2.13it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.07it/s] 48%|████▊     | 61/128 [00:28<00:31,  2.09it/s] 48%|████▊     | 62/128 [00:29<00:31,  2.11it/s] 49%|████▉     | 63/128 [00:29<00:30,  2.12it/s] 50%|█████     | 64/128 [00:30<00:30,  2.07it/s] 51%|█████     | 65/128 [00:30<00:31,  2.01it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:31<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:32<00:30,  1.94it/s] 54%|█████▍    | 69/128 [00:32<00:30,  1.95it/s] 55%|█████▍    | 70/128 [00:33<00:29,  1.95it/s] 55%|█████▌    | 71/128 [00:33<00:28,  2.03it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.07it/s] 57%|█████▋    | 73/128 [00:34<00:25,  2.19it/s] 58%|█████▊    | 74/128 [00:35<00:25,  2.10it/s] 59%|█████▊    | 75/128 [00:35<00:25,  2.05it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.99it/s] 60%|██████    | 77/128 [00:36<00:24,  2.07it/s] 61%|██████    | 78/128 [00:37<00:26,  1.91it/s] 62%|██████▏   | 79/128 [00:37<00:24,  1.98it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.95it/s] 63%|██████▎   | 81/128 [00:38<00:24,  1.95it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.95it/s] 65%|██████▍   | 83/128 [00:40<00:24,  1.84it/s] 66%|██████▌   | 84/128 [00:40<00:23,  1.88it/s] 66%|██████▋   | 85/128 [00:41<00:22,  1.90it/s] 67%|██████▋   | 86/128 [00:41<00:21,  1.91it/s] 68%|██████▊   | 87/128 [00:42<00:20,  1.98it/s] 69%|██████▉   | 88/128 [00:42<00:19,  2.02it/s] 70%|██████▉   | 89/128 [00:42<00:18,  2.09it/s] 70%|███████   | 90/128 [00:43<00:19,  1.92it/s] 71%|███████   | 91/128 [00:44<00:18,  2.05it/s] 72%|███████▏  | 92/128 [00:44<00:18,  2.00it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.08it/s] 74%|███████▍  | 95/128 [00:45<00:15,  2.12it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.06it/s] 76%|███████▌  | 97/128 [00:46<00:14,  2.12it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.03it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.07it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.09it/s] 79%|███████▉  | 101/128 [00:48<00:12,  2.14it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.08it/s] 80%|████████  | 103/128 [00:49<00:12,  2.03it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.00it/s] 82%|████████▏ | 105/128 [00:50<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.15it/s] 84%|████████▎ | 107/128 [00:51<00:09,  2.15it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.14it/s] 85%|████████▌ | 109/128 [00:52<00:08,  2.14it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.17it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.10it/s] 88%|████████▊ | 112/128 [00:54<00:08,  1.93it/s] 88%|████████▊ | 113/128 [00:54<00:07,  1.93it/s] 89%|████████▉ | 114/128 [00:55<00:07,  1.99it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.10it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.11it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.12it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.05it/s] 93%|█████████▎| 119/128 [00:57<00:03,  2.27it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.26it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.15it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.15it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.08it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.04it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.10it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.05it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.07it/s]100%|██████████| 128/128 [01:01<00:00,  2.01it/s]100%|██████████| 128/128 [01:01<00:00,  2.07it/s]
[2024-01-18 08:53:48,954] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.14it/s]  2%|▏         | 2/128 [00:01<01:04,  1.96it/s]  2%|▏         | 3/128 [00:01<00:59,  2.09it/s]  3%|▎         | 4/128 [00:01<01:01,  2.01it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:02<00:59,  2.07it/s]  5%|▌         | 7/128 [00:03<01:00,  2.00it/s]  6%|▋         | 8/128 [00:04<01:01,  1.96it/s]  7%|▋         | 9/128 [00:04<00:57,  2.09it/s]  8%|▊         | 10/128 [00:04<00:54,  2.17it/s]  9%|▊         | 11/128 [00:05<00:54,  2.16it/s]  9%|▉         | 12/128 [00:05<00:55,  2.08it/s] 10%|█         | 13/128 [00:06<00:54,  2.13it/s] 11%|█         | 14/128 [00:06<00:55,  2.06it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.01it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.08it/s] 13%|█▎        | 17/128 [00:08<00:52,  2.12it/s] 14%|█▍        | 18/128 [00:08<00:51,  2.15it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.08it/s] 16%|█▌        | 20/128 [00:09<00:53,  2.04it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.14it/s] 18%|█▊        | 23/128 [00:11<00:48,  2.17it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.09it/s] 20%|█▉        | 25/128 [00:11<00:47,  2.18it/s] 20%|██        | 26/128 [00:12<00:45,  2.25it/s] 21%|██        | 27/128 [00:12<00:43,  2.30it/s] 22%|██▏       | 28/128 [00:13<00:45,  2.18it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.10it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.14it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.03it/s] 26%|██▌       | 33/128 [00:15<00:44,  2.13it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.08it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.09it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:17<00:45,  2.02it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:18<00:43,  2.06it/s] 31%|███▏      | 40/128 [00:19<00:40,  2.19it/s] 32%|███▏      | 41/128 [00:19<00:41,  2.11it/s] 33%|███▎      | 42/128 [00:20<00:40,  2.12it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.06it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.00it/s] 35%|███▌      | 45/128 [00:21<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:22<00:40,  2.02it/s] 37%|███▋      | 47/128 [00:22<00:38,  2.09it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.04it/s] 38%|███▊      | 49/128 [00:23<00:39,  1.99it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.98it/s] 40%|███▉      | 51/128 [00:24<00:38,  2.02it/s] 41%|████      | 52/128 [00:25<00:38,  1.99it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.11it/s] 42%|████▏     | 54/128 [00:25<00:33,  2.19it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.17it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.07it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.03it/s] 45%|████▌     | 58/128 [00:27<00:34,  2.06it/s] 46%|████▌     | 59/128 [00:28<00:32,  2.11it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.05it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.07it/s] 48%|████▊     | 62/128 [00:29<00:31,  2.09it/s] 49%|████▉     | 63/128 [00:30<00:31,  2.04it/s] 50%|█████     | 64/128 [00:30<00:31,  2.01it/s] 51%|█████     | 65/128 [00:31<00:32,  1.97it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.95it/s] 52%|█████▏    | 67/128 [00:32<00:31,  1.93it/s] 53%|█████▎    | 68/128 [00:32<00:31,  1.91it/s] 54%|█████▍    | 69/128 [00:33<00:30,  1.93it/s] 55%|█████▍    | 70/128 [00:33<00:30,  1.92it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.04it/s] 57%|█████▋    | 73/128 [00:35<00:25,  2.16it/s] 58%|█████▊    | 74/128 [00:35<00:25,  2.08it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.03it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:24,  2.05it/s] 61%|██████    | 78/128 [00:37<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.96it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:40<00:24,  1.82it/s] 66%|██████▌   | 84/128 [00:41<00:23,  1.86it/s] 66%|██████▋   | 85/128 [00:41<00:22,  1.89it/s] 67%|██████▋   | 86/128 [00:42<00:22,  1.90it/s] 68%|██████▊   | 87/128 [00:42<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.07it/s] 70%|███████   | 90/128 [00:44<00:19,  1.90it/s] 71%|███████   | 91/128 [00:44<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:45<00:18,  1.99it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.06it/s] 74%|███████▍  | 95/128 [00:46<00:15,  2.11it/s] 75%|███████▌  | 96/128 [00:47<00:15,  2.05it/s] 76%|███████▌  | 97/128 [00:47<00:14,  2.10it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.06it/s] 78%|███████▊  | 100/128 [00:48<00:13,  2.02it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.08it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.04it/s] 80%|████████  | 103/128 [00:50<00:12,  2.00it/s] 81%|████████▏ | 104/128 [00:50<00:12,  1.97it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.02it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.13it/s] 84%|████████▎ | 107/128 [00:52<00:09,  2.13it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.13it/s] 85%|████████▌ | 109/128 [00:53<00:08,  2.13it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.16it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.09it/s] 88%|████████▊ | 112/128 [00:54<00:08,  1.92it/s] 88%|████████▊ | 113/128 [00:55<00:07,  1.92it/s] 89%|████████▉ | 114/128 [00:55<00:07,  1.98it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.09it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.10it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.11it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:58<00:03,  2.25it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.25it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.14it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.14it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.07it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.02it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.09it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.04it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.06it/s]100%|██████████| 128/128 [01:02<00:00,  2.00it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.56s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.28s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.20s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.98s/it]
[2024-01-18 08:55:45,751] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 54%|█████▍    | 69/128 [00:00<00:00, 686.99it/s]100%|██████████| 128/128 [00:00<00:00, 682.71it/s]
[2024-01-18 08:55:46,076] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:01<01:04,  1.97it/s]  2%|▏         | 3/128 [00:01<01:03,  1.96it/s]  3%|▎         | 4/128 [00:02<01:02,  1.97it/s]  4%|▍         | 5/128 [00:02<01:00,  2.04it/s]  5%|▍         | 6/128 [00:03<01:01,  1.99it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:04<01:00,  1.98it/s]  7%|▋         | 9/128 [00:04<00:55,  2.14it/s]  8%|▊         | 10/128 [00:04<00:56,  2.08it/s]  9%|▊         | 11/128 [00:05<00:54,  2.13it/s]  9%|▉         | 12/128 [00:05<00:53,  2.17it/s] 10%|█         | 13/128 [00:06<00:54,  2.10it/s] 11%|█         | 14/128 [00:06<00:55,  2.05it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.08it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:55,  2.01it/s] 14%|█▍        | 18/128 [00:08<00:55,  2.00it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.05it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.13it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.14it/s] 18%|█▊        | 23/128 [00:11<00:48,  2.15it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.19it/s] 20%|█▉        | 25/128 [00:11<00:45,  2.28it/s] 20%|██        | 26/128 [00:12<00:47,  2.15it/s] 21%|██        | 27/128 [00:13<00:48,  2.06it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.00it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.11it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.06it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.01it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.97it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.14it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.08it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.05it/s] 30%|███       | 39/128 [00:18<00:42,  2.08it/s] 31%|███▏      | 40/128 [00:19<00:41,  2.10it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.03it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.00it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.05it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.02it/s] 36%|███▌      | 46/128 [00:22<00:40,  2.00it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.97it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.03it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.09it/s] 41%|████      | 52/128 [00:25<00:37,  2.05it/s] 41%|████▏     | 53/128 [00:25<00:37,  2.00it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.05it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.11it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.04it/s] 45%|████▍     | 57/128 [00:27<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.00it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.04it/s] 47%|████▋     | 60/128 [00:29<00:32,  2.10it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.03it/s] 48%|████▊     | 62/128 [00:30<00:31,  2.07it/s] 49%|████▉     | 63/128 [00:30<00:32,  2.01it/s] 50%|█████     | 64/128 [00:31<00:32,  1.97it/s] 51%|█████     | 65/128 [00:31<00:31,  2.02it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.00it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.08it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.04it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.14it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.06it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.02it/s] 56%|█████▋    | 72/128 [00:35<00:29,  1.87it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.90it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:37<00:28,  1.85it/s] 60%|██████    | 77/128 [00:37<00:27,  1.86it/s] 61%|██████    | 78/128 [00:38<00:26,  1.87it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.89it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:41<00:21,  1.99it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:42<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.05it/s] 70%|███████   | 90/128 [00:44<00:18,  2.07it/s] 71%|███████   | 91/128 [00:44<00:17,  2.13it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.05it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:17,  2.00it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.04it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.89it/s] 76%|███████▌  | 97/128 [00:47<00:16,  1.90it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.97it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.96it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.04it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.07it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.09it/s] 80%|████████  | 103/128 [00:50<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.05it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.01it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.97it/s] 84%|████████▎ | 107/128 [00:52<00:10,  1.96it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.94it/s] 85%|████████▌ | 109/128 [00:53<00:09,  1.94it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.02it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.09it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.05it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.02it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.11it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.05it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.01it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.05it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.02it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.99it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.03it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.01it/s] 98%|█████████▊| 125/128 [01:01<00:01,  1.99it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.03it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.06it/s]100%|██████████| 128/128 [01:03<00:00,  2.08it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]
[2024-01-18 08:56:49,244] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:06,  1.92it/s]  2%|▏         | 2/128 [00:01<01:05,  1.94it/s]  2%|▏         | 3/128 [00:01<01:04,  1.94it/s]  3%|▎         | 4/128 [00:02<01:03,  1.94it/s]  4%|▍         | 5/128 [00:02<01:01,  2.02it/s]  5%|▍         | 6/128 [00:03<01:01,  1.97it/s]  5%|▌         | 7/128 [00:03<01:01,  1.96it/s]  6%|▋         | 8/128 [00:04<01:01,  1.96it/s]  7%|▋         | 9/128 [00:04<00:56,  2.12it/s]  8%|▊         | 10/128 [00:04<00:57,  2.05it/s]  9%|▊         | 11/128 [00:05<00:55,  2.11it/s]  9%|▉         | 12/128 [00:05<00:53,  2.15it/s] 10%|█         | 13/128 [00:06<00:55,  2.07it/s] 11%|█         | 14/128 [00:06<00:56,  2.03it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.06it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.01it/s] 13%|█▎        | 17/128 [00:08<00:55,  1.99it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.98it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.03it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.09it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.12it/s] 18%|█▊        | 23/128 [00:11<00:49,  2.13it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.17it/s] 20%|█▉        | 25/128 [00:12<00:45,  2.26it/s] 20%|██        | 26/128 [00:12<00:47,  2.13it/s] 21%|██        | 27/128 [00:13<00:49,  2.04it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:14<00:49,  1.98it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.10it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.01it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.12it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.06it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.03it/s] 30%|███       | 39/128 [00:19<00:43,  2.06it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.08it/s] 32%|███▏      | 41/128 [00:20<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.03it/s] 35%|███▌      | 45/128 [00:22<00:41,  2.01it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.02it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.05it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.07it/s] 41%|████      | 52/128 [00:25<00:37,  2.03it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:27<00:34,  2.09it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:29<00:32,  2.08it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.02it/s] 48%|████▊     | 62/128 [00:30<00:32,  2.04it/s] 49%|████▉     | 63/128 [00:31<00:32,  1.99it/s] 50%|█████     | 64/128 [00:31<00:32,  1.95it/s] 51%|█████     | 65/128 [00:32<00:31,  2.00it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.06it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.02it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.12it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.04it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:35<00:30,  1.85it/s] 57%|█████▋    | 73/128 [00:36<00:29,  1.88it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.97it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.96it/s] 59%|█████▉    | 76/128 [00:37<00:28,  1.83it/s] 60%|██████    | 77/128 [00:38<00:27,  1.84it/s] 61%|██████    | 78/128 [00:38<00:26,  1.85it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.88it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.87it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:40<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.90it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.01it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.95it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.03it/s] 70%|███████   | 90/128 [00:44<00:18,  2.05it/s] 71%|███████   | 91/128 [00:45<00:17,  2.10it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.00it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.02it/s] 75%|███████▌  | 96/128 [00:47<00:17,  1.88it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.89it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.90it/s] 77%|███████▋  | 99/128 [00:49<00:15,  1.91it/s] 78%|███████▊  | 100/128 [00:49<00:14,  2.00it/s] 79%|███████▉  | 101/128 [00:50<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.01it/s] 80%|████████  | 103/128 [00:51<00:12,  2.07it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.01it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.98it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.93it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.92it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.92it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.00it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.07it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:56<00:07,  1.99it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.00it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.09it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.00it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.04it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.98it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.02it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.99it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.97it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.05it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]100%|██████████| 128/128 [01:03<00:00,  2.00it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.22s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.14s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.03s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.80s/it]
[2024-01-18 08:58:46,856] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 44%|████▍     | 56/128 [00:00<00:00, 554.60it/s] 98%|█████████▊| 125/128 [00:00<00:00, 633.05it/s]100%|██████████| 128/128 [00:00<00:00, 622.27it/s]
[2024-01-18 08:58:47,192] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:03,  1.99it/s]  2%|▏         | 2/128 [00:00<01:00,  2.10it/s]  2%|▏         | 3/128 [00:01<01:01,  2.04it/s]  3%|▎         | 4/128 [00:01<01:01,  2.02it/s]  4%|▍         | 5/128 [00:02<00:58,  2.11it/s]  5%|▍         | 6/128 [00:02<01:00,  2.03it/s]  5%|▌         | 7/128 [00:03<00:58,  2.07it/s]  6%|▋         | 8/128 [00:03<00:57,  2.10it/s]  7%|▋         | 9/128 [00:04<00:56,  2.12it/s]  8%|▊         | 10/128 [00:04<00:57,  2.07it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:56,  2.07it/s] 10%|█         | 13/128 [00:06<00:53,  2.13it/s] 11%|█         | 14/128 [00:06<00:54,  2.08it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.10it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.15it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.08it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.05it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.02it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.09it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.12it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.16it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.09it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.11it/s] 20%|█▉        | 25/128 [00:11<00:50,  2.06it/s] 20%|██        | 26/128 [00:12<00:47,  2.16it/s] 21%|██        | 27/128 [00:12<00:48,  2.09it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.07it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.09it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.12it/s] 25%|██▌       | 32/128 [00:15<00:44,  2.16it/s] 26%|██▌       | 33/128 [00:15<00:45,  2.07it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.04it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.07it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.10it/s] 29%|██▉       | 37/128 [00:17<00:41,  2.21it/s] 30%|██▉       | 38/128 [00:18<00:42,  2.10it/s] 30%|███       | 39/128 [00:18<00:43,  2.03it/s] 31%|███▏      | 40/128 [00:19<00:43,  2.01it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.00it/s] 33%|███▎      | 42/128 [00:20<00:46,  1.87it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.95it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.96it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.96it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:23<00:40,  1.97it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.09it/s] 41%|████      | 52/128 [00:25<00:36,  2.11it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.10it/s] 44%|████▍     | 56/128 [00:27<00:33,  2.14it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.08it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.04it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.06it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.03it/s] 48%|████▊     | 62/128 [00:30<00:32,  2.01it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.97it/s] 50%|█████     | 64/128 [00:31<00:32,  1.94it/s] 51%|█████     | 65/128 [00:31<00:31,  2.03it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.01it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.05it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.13it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.05it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.11it/s] 56%|█████▋    | 72/128 [00:35<00:28,  1.93it/s] 57%|█████▋    | 73/128 [00:35<00:28,  1.94it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.00it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.12it/s] 59%|█████▉    | 76/128 [00:37<00:25,  2.04it/s] 60%|██████    | 77/128 [00:37<00:26,  1.89it/s] 61%|██████    | 78/128 [00:38<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.90it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:40<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.92it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.01it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.99it/s] 68%|██████▊   | 87/128 [00:42<00:19,  2.06it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.03it/s] 70%|██████▉   | 89/128 [00:43<00:19,  2.01it/s] 70%|███████   | 90/128 [00:44<00:19,  2.00it/s] 71%|███████   | 91/128 [00:44<00:17,  2.11it/s] 72%|███████▏  | 92/128 [00:45<00:16,  2.13it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.08it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.03it/s] 74%|███████▍  | 95/128 [00:46<00:16,  2.01it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.99it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:49<00:14,  2.00it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.11it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.12it/s] 80%|████████  | 103/128 [00:50<00:11,  2.13it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.14it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.06it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.90it/s] 84%|████████▎ | 107/128 [00:52<00:11,  1.90it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.91it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.00it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.11it/s] 87%|████████▋ | 111/128 [00:54<00:07,  2.13it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.13it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.06it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.12it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.06it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.16it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.16it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.15it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.08it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.03it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:00<00:02,  1.98it/s] 98%|█████████▊| 125/128 [01:01<00:01,  1.97it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.11it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.12it/s]100%|██████████| 128/128 [01:02<00:00,  2.15it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 08:59:49,836] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:00<01:01,  2.06it/s]  2%|▏         | 3/128 [00:01<01:01,  2.02it/s]  3%|▎         | 4/128 [00:01<01:02,  2.00it/s]  4%|▍         | 5/128 [00:02<00:59,  2.08it/s]  5%|▍         | 6/128 [00:02<01:00,  2.00it/s]  5%|▌         | 7/128 [00:03<00:59,  2.05it/s]  6%|▋         | 8/128 [00:03<00:57,  2.08it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:57,  2.04it/s]  9%|▊         | 11/128 [00:05<00:55,  2.10it/s]  9%|▉         | 12/128 [00:05<00:56,  2.05it/s] 10%|█         | 13/128 [00:06<00:54,  2.11it/s] 11%|█         | 14/128 [00:06<00:55,  2.05it/s] 12%|█▏        | 15/128 [00:07<00:54,  2.08it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.12it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.06it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.02it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.00it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.07it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.11it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.05it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.08it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.03it/s] 20%|██        | 26/128 [00:12<00:47,  2.14it/s] 21%|██        | 27/128 [00:13<00:48,  2.07it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.04it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.07it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.09it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.11it/s] 26%|██▌       | 33/128 [00:16<00:46,  2.03it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.00it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.07it/s] 29%|██▉       | 37/128 [00:17<00:41,  2.18it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.08it/s] 30%|███       | 39/128 [00:18<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.99it/s] 32%|███▏      | 41/128 [00:19<00:44,  1.98it/s] 33%|███▎      | 42/128 [00:20<00:46,  1.85it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.93it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.94it/s] 38%|███▊      | 49/128 [00:24<00:40,  1.94it/s] 39%|███▉      | 50/128 [00:24<00:39,  2.00it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.06it/s] 41%|████      | 52/128 [00:25<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.05it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.10it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.05it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.01it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.99it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.03it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.01it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.99it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.94it/s] 50%|█████     | 64/128 [00:31<00:33,  1.92it/s] 51%|█████     | 65/128 [00:32<00:31,  2.00it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.05it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.11it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.09it/s] 56%|█████▋    | 72/128 [00:35<00:29,  1.91it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.92it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.98it/s] 59%|█████▊    | 75/128 [00:36<00:25,  2.09it/s] 59%|█████▉    | 76/128 [00:37<00:25,  2.01it/s] 60%|██████    | 77/128 [00:38<00:27,  1.87it/s] 61%|██████    | 78/128 [00:38<00:26,  1.87it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.88it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.88it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.89it/s] 64%|██████▍   | 82/128 [00:40<00:24,  1.89it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.90it/s] 66%|██████▌   | 84/128 [00:41<00:23,  1.90it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.99it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.97it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.04it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:44<00:19,  1.98it/s] 70%|███████   | 90/128 [00:44<00:19,  1.97it/s] 71%|███████   | 91/128 [00:45<00:17,  2.09it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.10it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.05it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.01it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.98it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.97it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.93it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.01it/s] 78%|███████▊  | 100/128 [00:49<00:14,  1.98it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.09it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.10it/s] 80%|████████  | 103/128 [00:51<00:11,  2.11it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.11it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.04it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.88it/s] 84%|████████▎ | 107/128 [00:53<00:11,  1.88it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.89it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.98it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.09it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.10it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.05it/s] 88%|████████▊ | 113/128 [00:56<00:07,  1.99it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.04it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.10it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.04it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.14it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.14it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.13it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.06it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.01it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.96it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.95it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.09it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.10it/s]100%|██████████| 128/128 [01:03<00:00,  2.13it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.75s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.37s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.05s/it]
[2024-01-18 09:01:47,661] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 67/128 [00:00<00:00, 669.93it/s]100%|██████████| 128/128 [00:00<00:00, 673.07it/s]
[2024-01-18 09:01:47,986] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:03,  1.99it/s]  2%|▏         | 2/128 [00:01<01:03,  1.97it/s]  2%|▏         | 3/128 [00:01<01:03,  1.97it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:02<00:59,  2.06it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:56,  2.11it/s]  7%|▋         | 9/128 [00:04<00:56,  2.12it/s]  8%|▊         | 10/128 [00:04<00:55,  2.14it/s]  9%|▊         | 11/128 [00:05<00:52,  2.22it/s]  9%|▉         | 12/128 [00:05<00:54,  2.13it/s] 10%|█         | 13/128 [00:06<00:55,  2.08it/s] 11%|█         | 14/128 [00:06<00:54,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.03it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.10it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.06it/s] 14%|█▍        | 18/128 [00:08<00:52,  2.09it/s] 15%|█▍        | 19/128 [00:09<00:50,  2.14it/s] 16%|█▌        | 20/128 [00:09<00:48,  2.23it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.14it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.04it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.17it/s] 20%|█▉        | 25/128 [00:11<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:49,  2.05it/s] 21%|██        | 27/128 [00:12<00:48,  2.08it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.11it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.04it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:15<00:48,  1.96it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.96it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.05it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.99it/s] 29%|██▉       | 37/128 [00:17<00:46,  1.96it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:45,  1.95it/s] 31%|███▏      | 40/128 [00:19<00:47,  1.83it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.92it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.91it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.98it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.94it/s] 36%|███▌      | 46/128 [00:22<00:41,  2.00it/s] 37%|███▋      | 47/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:37,  2.09it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.11it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.06it/s] 41%|████      | 52/128 [00:25<00:37,  2.02it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.99it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.04it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.01it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.00it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.03it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.99it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.91it/s] 49%|████▉     | 63/128 [00:31<00:32,  1.98it/s] 50%|█████     | 64/128 [00:31<00:32,  1.96it/s] 51%|█████     | 65/128 [00:32<00:32,  1.96it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.04it/s] 52%|█████▏    | 67/128 [00:32<00:28,  2.15it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.09it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.04it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.99it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.04it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.01it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.05it/s] 58%|█████▊    | 74/128 [00:36<00:28,  1.90it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.89it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.89it/s] 60%|██████    | 77/128 [00:38<00:28,  1.80it/s] 61%|██████    | 78/128 [00:38<00:27,  1.83it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.85it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.86it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:40<00:23,  2.00it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.08it/s] 70%|███████   | 90/128 [00:44<00:18,  2.03it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.93it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.94it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.96it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.09it/s] 80%|████████  | 103/128 [00:51<00:12,  2.01it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.97it/s] 82%|████████▏ | 105/128 [00:52<00:12,  1.85it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.99it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.98it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.97it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:54<00:09,  1.96it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.04it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.12it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.12it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.02it/s] 92%|█████████▏| 118/128 [00:58<00:05,  1.98it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.02it/s] 94%|█████████▍| 120/128 [00:59<00:04,  1.99it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.98it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.05it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.01it/s] 98%|█████████▊| 126/128 [01:02<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.98it/s]100%|██████████| 128/128 [01:03<00:00,  1.96it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]
[2024-01-18 09:02:51,766] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:01<01:04,  1.95it/s]  2%|▏         | 3/128 [00:01<01:04,  1.95it/s]  3%|▎         | 4/128 [00:02<01:03,  1.94it/s]  4%|▍         | 5/128 [00:02<01:03,  1.94it/s]  5%|▍         | 6/128 [00:03<00:59,  2.04it/s]  5%|▌         | 7/128 [00:03<01:00,  2.01it/s]  6%|▋         | 8/128 [00:03<00:57,  2.08it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:55,  2.11it/s]  9%|▊         | 11/128 [00:05<00:53,  2.20it/s]  9%|▉         | 12/128 [00:05<00:55,  2.11it/s] 10%|█         | 13/128 [00:06<00:55,  2.06it/s] 11%|█         | 14/128 [00:06<00:54,  2.08it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.01it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.08it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.04it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.07it/s] 15%|█▍        | 19/128 [00:09<00:51,  2.12it/s] 16%|█▌        | 20/128 [00:09<00:48,  2.21it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.12it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.02it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.15it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.06it/s] 20%|██        | 26/128 [00:12<00:50,  2.03it/s] 21%|██        | 27/128 [00:13<00:49,  2.06it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.07it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.09it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.02it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.98it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.94it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.95it/s] 30%|███       | 39/128 [00:19<00:45,  1.94it/s] 31%|███▏      | 40/128 [00:19<00:48,  1.82it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.90it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.89it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.96it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.92it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.98it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.97it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.96it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.08it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.10it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.04it/s] 41%|████      | 52/128 [00:25<00:37,  2.00it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.02it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.00it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.99it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.98it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.02it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.97it/s] 47%|████▋     | 60/128 [00:29<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.92it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.90it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.97it/s] 50%|█████     | 64/128 [00:31<00:32,  1.95it/s] 51%|█████     | 65/128 [00:32<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.03it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.09it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.05it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.01it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.02it/s] 56%|█████▋    | 72/128 [00:35<00:28,  2.00it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.04it/s] 58%|█████▊    | 74/128 [00:36<00:28,  1.88it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.88it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.88it/s] 60%|██████    | 77/128 [00:38<00:28,  1.79it/s] 61%|██████    | 78/128 [00:39<00:27,  1.81it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.84it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.85it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.98it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:42<00:21,  2.02it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.99it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.97it/s] 68%|██████▊   | 87/128 [00:43<00:21,  1.95it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.00it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.07it/s] 70%|███████   | 90/128 [00:45<00:18,  2.02it/s] 71%|███████   | 91/128 [00:45<00:18,  2.05it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.97it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.94it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.92it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.97it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.95it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.07it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.01it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.08it/s] 80%|████████  | 103/128 [00:51<00:12,  2.00it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.96it/s] 82%|████████▏ | 105/128 [00:52<00:12,  1.84it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.98it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.97it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.95it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.95it/s] 86%|████████▌ | 110/128 [00:55<00:09,  1.95it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.06it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.11it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.05it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.11it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.05it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.01it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.97it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.01it/s] 94%|█████████▍| 120/128 [01:00<00:04,  1.98it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.97it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.95it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.04it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.00it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.98it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:04<00:00,  1.95it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.75s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.39s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.14s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.98s/it]
[2024-01-18 09:04:50,350] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 41%|████▏     | 53/128 [00:00<00:00, 524.29it/s] 95%|█████████▌| 122/128 [00:00<00:00, 620.98it/s]100%|██████████| 128/128 [00:00<00:00, 609.98it/s]
[2024-01-18 09:04:50,688] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.17it/s]  2%|▏         | 2/128 [00:00<01:01,  2.04it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:01<01:02,  2.00it/s]  4%|▍         | 5/128 [00:02<01:02,  1.98it/s]  5%|▍         | 6/128 [00:03<01:01,  1.98it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<00:57,  2.08it/s]  7%|▋         | 9/128 [00:04<00:56,  2.11it/s]  8%|▊         | 10/128 [00:04<00:54,  2.15it/s]  9%|▊         | 11/128 [00:05<00:56,  2.09it/s]  9%|▉         | 12/128 [00:05<00:55,  2.11it/s] 10%|█         | 13/128 [00:06<00:53,  2.16it/s] 11%|█         | 14/128 [00:06<00:54,  2.10it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.05it/s] 12%|█▎        | 16/128 [00:07<00:55,  2.02it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.98it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.06it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.02it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.13it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.08it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.10it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.06it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.17it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.20it/s] 20%|██        | 26/128 [00:12<00:48,  2.10it/s] 21%|██        | 27/128 [00:13<00:49,  2.06it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:14<00:49,  2.00it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.05it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.04it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.14it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.06it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.03it/s] 30%|███       | 39/128 [00:18<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:44,  2.00it/s] 32%|███▏      | 41/128 [00:19<00:44,  1.96it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.04it/s] 34%|███▎      | 43/128 [00:20<00:42,  2.01it/s] 34%|███▍      | 44/128 [00:21<00:42,  2.00it/s] 35%|███▌      | 45/128 [00:21<00:41,  1.99it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.96it/s] 37%|███▋      | 47/128 [00:22<00:39,  2.05it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.01it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.05it/s] 39%|███▉      | 50/128 [00:24<00:35,  2.18it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.17it/s] 41%|████      | 52/128 [00:25<00:36,  2.11it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.13it/s] 42%|████▏     | 54/128 [00:26<00:34,  2.13it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.18it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.08it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.03it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.01it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.05it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.03it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.06it/s] 48%|████▊     | 62/128 [00:30<00:32,  2.01it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.97it/s] 50%|█████     | 64/128 [00:31<00:32,  1.97it/s] 51%|█████     | 65/128 [00:31<00:32,  1.96it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.01it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.05it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.11it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.04it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.01it/s] 55%|█████▌    | 71/128 [00:34<00:28,  1.97it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.03it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.00it/s] 58%|█████▊    | 74/128 [00:36<00:26,  2.04it/s] 59%|█████▊    | 75/128 [00:36<00:28,  1.88it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.88it/s] 60%|██████    | 77/128 [00:37<00:27,  1.88it/s] 61%|██████    | 78/128 [00:38<00:26,  1.89it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.90it/s] 63%|██████▎   | 81/128 [00:39<00:23,  1.97it/s] 64%|██████▍   | 82/128 [00:40<00:22,  2.02it/s] 65%|██████▍   | 83/128 [00:40<00:21,  2.06it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.00it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.11it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.11it/s] 70%|███████   | 90/128 [00:44<00:17,  2.15it/s] 71%|███████   | 91/128 [00:44<00:17,  2.08it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.10it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.01it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.94it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.00it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.98it/s] 77%|███████▋  | 99/128 [00:48<00:13,  2.12it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.12it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.06it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.02it/s] 80%|████████  | 103/128 [00:50<00:12,  1.99it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.97it/s] 82%|████████▏ | 105/128 [00:51<00:11,  1.94it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.07it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.09it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.07it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.14it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.04it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.10it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.15it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.15it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.09it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.04it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.07it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.03it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.10it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.05it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.05it/s]100%|██████████| 128/128 [01:02<00:00,  2.00it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 09:05:53,477] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.14it/s]  2%|▏         | 2/128 [00:00<01:02,  2.02it/s]  2%|▏         | 3/128 [00:01<01:03,  1.97it/s]  3%|▎         | 4/128 [00:02<01:02,  1.97it/s]  4%|▍         | 5/128 [00:02<01:02,  1.96it/s]  5%|▍         | 6/128 [00:03<01:02,  1.96it/s]  5%|▌         | 7/128 [00:03<01:00,  2.01it/s]  6%|▋         | 8/128 [00:03<00:58,  2.05it/s]  7%|▋         | 9/128 [00:04<00:57,  2.08it/s]  8%|▊         | 10/128 [00:04<00:55,  2.12it/s]  9%|▊         | 11/128 [00:05<00:56,  2.06it/s]  9%|▉         | 12/128 [00:05<00:55,  2.08it/s] 10%|█         | 13/128 [00:06<00:54,  2.13it/s] 11%|█         | 14/128 [00:06<00:55,  2.07it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.02it/s] 12%|█▎        | 16/128 [00:07<00:56,  1.99it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.96it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.04it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.00it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.07it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.03it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.06it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.03it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.13it/s] 20%|█▉        | 25/128 [00:12<00:47,  2.16it/s] 20%|██        | 26/128 [00:12<00:49,  2.07it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.97it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.02it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.96it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.01it/s] 28%|██▊       | 36/128 [00:17<00:43,  2.12it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.04it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.01it/s] 30%|███       | 39/128 [00:19<00:44,  1.99it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.93it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.02it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.99it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.98it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.97it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:23<00:40,  2.02it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.03it/s] 39%|███▉      | 50/128 [00:24<00:36,  2.15it/s] 40%|███▉      | 51/128 [00:25<00:35,  2.14it/s] 41%|████      | 52/128 [00:25<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:26<00:35,  2.10it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.11it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.15it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.06it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.00it/s] 46%|████▌     | 59/128 [00:29<00:33,  2.04it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:30<00:32,  2.04it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.99it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.96it/s] 50%|█████     | 64/128 [00:31<00:32,  1.95it/s] 51%|█████     | 65/128 [00:32<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.03it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.09it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.01it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.99it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.95it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.00it/s] 57%|█████▋    | 73/128 [00:36<00:27,  1.97it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.96it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.83it/s] 59%|█████▉    | 76/128 [00:37<00:28,  1.84it/s] 60%|██████    | 77/128 [00:38<00:27,  1.85it/s] 61%|██████    | 78/128 [00:38<00:26,  1.86it/s] 62%|██████▏   | 79/128 [00:39<00:26,  1.86it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.87it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.99it/s] 65%|██████▍   | 83/128 [00:41<00:22,  2.03it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.09it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.99it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.09it/s] 70%|███████   | 90/128 [00:44<00:17,  2.13it/s] 71%|███████   | 91/128 [00:45<00:18,  2.05it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.08it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.02it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.99it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.92it/s] 76%|███████▌  | 97/128 [00:48<00:16,  1.93it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.92it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.06it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.08it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.03it/s] 80%|███████▉  | 102/128 [00:50<00:13,  1.99it/s] 80%|████████  | 103/128 [00:51<00:12,  1.97it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.92it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.98it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.05it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.07it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.03it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.12it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.06it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.08it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.13it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.13it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.07it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.02it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.05it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.97it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.09it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.00it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.04it/s]100%|██████████| 128/128 [01:03<00:00,  1.99it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.16s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.13s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.19s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.91s/it]
[2024-01-18 09:07:51,148] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 53%|█████▎    | 68/128 [00:00<00:00, 670.89it/s]100%|██████████| 128/128 [00:00<00:00, 679.89it/s]
[2024-01-18 09:07:51,471] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.98it/s]  2%|▏         | 2/128 [00:00<01:00,  2.09it/s]  2%|▏         | 3/128 [00:01<01:01,  2.03it/s]  3%|▎         | 4/128 [00:01<01:02,  1.98it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:03<01:02,  1.96it/s]  5%|▌         | 7/128 [00:03<01:01,  1.97it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:04<00:56,  2.10it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:55,  2.08it/s] 10%|█         | 13/128 [00:06<00:56,  2.03it/s] 11%|█         | 14/128 [00:06<00:56,  2.00it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.97it/s] 12%|█▎        | 16/128 [00:07<00:57,  1.96it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.94it/s] 14%|█▍        | 18/128 [00:08<00:56,  1.95it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.01it/s] 16%|█▌        | 20/128 [00:09<00:54,  1.99it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:10<00:52,  2.01it/s] 18%|█▊        | 23/128 [00:11<00:52,  1.99it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.11it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:50,  2.04it/s] 21%|██        | 27/128 [00:13<00:48,  2.07it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.03it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.07it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.03it/s] 24%|██▍       | 31/128 [00:15<00:48,  2.01it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.98it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.04it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.02it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.98it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.98it/s] 30%|███       | 39/128 [00:19<00:45,  1.97it/s] 31%|███▏      | 40/128 [00:20<00:47,  1.85it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.93it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.93it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.95it/s] 35%|███▌      | 45/128 [00:22<00:42,  1.95it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.95it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.04it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.08it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.04it/s] 41%|████      | 52/128 [00:25<00:36,  2.11it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.04it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.01it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.00it/s] 45%|████▍     | 57/128 [00:28<00:34,  2.04it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.01it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.97it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.96it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.95it/s] 50%|█████     | 64/128 [00:32<00:32,  1.95it/s] 51%|█████     | 65/128 [00:32<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.95it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.09it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.03it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.00it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.96it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.01it/s] 57%|█████▋    | 73/128 [00:36<00:27,  1.99it/s] 58%|█████▊    | 74/128 [00:37<00:28,  1.86it/s] 59%|█████▊    | 75/128 [00:37<00:28,  1.87it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.87it/s] 60%|██████    | 77/128 [00:38<00:26,  1.90it/s] 61%|██████    | 78/128 [00:39<00:26,  1.90it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:40<00:23,  2.02it/s] 64%|██████▍   | 82/128 [00:41<00:23,  2.00it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:42<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.04it/s] 68%|██████▊   | 87/128 [00:43<00:19,  2.07it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.09it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.11it/s] 70%|███████   | 90/128 [00:45<00:18,  2.06it/s] 71%|███████   | 91/128 [00:45<00:17,  2.17it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.08it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.03it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.08it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.00it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.04it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.01it/s] 80%|████████  | 103/128 [00:51<00:12,  1.98it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.86it/s] 82%|████████▏ | 105/128 [00:52<00:12,  1.88it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.95it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.03it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.09it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.05it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.02it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.06it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.09it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.04it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.03it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.12it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.07it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.04it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.06it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.09it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.04it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.01it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.05it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.01it/s] 98%|█████████▊| 126/128 [01:02<00:01,  1.99it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.96it/s]100%|██████████| 128/128 [01:03<00:00,  2.04it/s]100%|██████████| 128/128 [01:03<00:00,  2.00it/s]
[2024-01-18 09:08:55,332] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.95it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:02<01:03,  1.96it/s]  4%|▍         | 5/128 [00:02<01:03,  1.95it/s]  5%|▍         | 6/128 [00:03<01:02,  1.94it/s]  5%|▌         | 7/128 [00:03<01:02,  1.95it/s]  6%|▋         | 8/128 [00:04<00:58,  2.03it/s]  7%|▋         | 9/128 [00:04<00:59,  2.00it/s]  8%|▊         | 10/128 [00:04<00:57,  2.07it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:56,  2.06it/s] 10%|█         | 13/128 [00:06<00:57,  2.00it/s] 11%|█         | 14/128 [00:06<00:57,  1.98it/s] 12%|█▏        | 15/128 [00:07<00:57,  1.95it/s] 12%|█▎        | 16/128 [00:08<00:57,  1.94it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.92it/s] 14%|█▍        | 18/128 [00:09<00:57,  1.93it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.99it/s] 16%|█▌        | 20/128 [00:10<00:54,  1.97it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.01it/s] 17%|█▋        | 22/128 [00:11<00:53,  1.99it/s] 18%|█▊        | 23/128 [00:11<00:53,  1.97it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.09it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.04it/s] 20%|██        | 26/128 [00:13<00:50,  2.01it/s] 21%|██        | 27/128 [00:13<00:49,  2.04it/s] 22%|██▏       | 28/128 [00:14<00:49,  2.01it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.04it/s] 23%|██▎       | 30/128 [00:15<00:48,  2.00it/s] 24%|██▍       | 31/128 [00:15<00:48,  1.99it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.95it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.93it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:18<00:46,  2.00it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.96it/s] 30%|██▉       | 38/128 [00:19<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:45,  1.94it/s] 31%|███▏      | 40/128 [00:20<00:48,  1.82it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.91it/s] 33%|███▎      | 42/128 [00:21<00:45,  1.91it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.93it/s] 36%|███▌      | 46/128 [00:23<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.91it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:25<00:38,  2.05it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.02it/s] 41%|████      | 52/128 [00:26<00:36,  2.08it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:27<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:27<00:36,  1.99it/s] 44%|████▍     | 56/128 [00:28<00:36,  1.98it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:29<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.97it/s] 47%|████▋     | 60/128 [00:30<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.91it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.92it/s] 50%|█████     | 64/128 [00:32<00:33,  1.93it/s] 51%|█████     | 65/128 [00:32<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:33<00:32,  1.92it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.07it/s] 53%|█████▎    | 68/128 [00:34<00:29,  2.00it/s] 54%|█████▍    | 69/128 [00:34<00:29,  1.98it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.94it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.93it/s] 56%|█████▋    | 72/128 [00:36<00:28,  1.98it/s] 57%|█████▋    | 73/128 [00:36<00:27,  1.97it/s] 58%|█████▊    | 74/128 [00:37<00:29,  1.84it/s] 59%|█████▊    | 75/128 [00:38<00:28,  1.85it/s] 59%|█████▉    | 76/128 [00:38<00:28,  1.85it/s] 60%|██████    | 77/128 [00:39<00:27,  1.88it/s] 61%|██████    | 78/128 [00:39<00:26,  1.88it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.89it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.91it/s] 63%|██████▎   | 81/128 [00:41<00:23,  1.99it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.94it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.99it/s] 66%|██████▋   | 85/128 [00:43<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.96it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.95it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.00it/s] 70%|██████▉   | 89/128 [00:45<00:19,  2.03it/s] 70%|███████   | 90/128 [00:45<00:18,  2.00it/s] 71%|███████   | 91/128 [00:46<00:17,  2.11it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:47<00:17,  2.00it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:48<00:17,  1.93it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:49<00:16,  1.93it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:50<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:50<00:14,  1.96it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.01it/s] 80%|███████▉  | 102/128 [00:51<00:13,  1.98it/s] 80%|████████  | 103/128 [00:52<00:12,  1.96it/s] 81%|████████▏ | 104/128 [00:52<00:13,  1.83it/s] 82%|████████▏ | 105/128 [00:53<00:12,  1.87it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:54<00:10,  2.02it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.08it/s] 85%|████████▌ | 109/128 [00:55<00:09,  2.03it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:56<00:08,  2.04it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:57<00:07,  2.02it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:58<00:06,  2.01it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.05it/s] 91%|█████████▏| 117/128 [00:59<00:05,  2.11it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.05it/s] 93%|█████████▎| 119/128 [01:00<00:04,  2.02it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.05it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.08it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.03it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 125/128 [01:03<00:01,  2.00it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.97it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.95it/s]100%|██████████| 128/128 [01:04<00:00,  2.02it/s]100%|██████████| 128/128 [01:04<00:00,  1.98it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.23s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.16s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.15s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.89s/it]
[2024-01-18 09:10:54,126] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 44%|████▍     | 56/128 [00:00<00:00, 559.40it/s]100%|██████████| 128/128 [00:00<00:00, 652.02it/s]
[2024-01-18 09:10:54,452] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.31it/s]  2%|▏         | 2/128 [00:00<00:59,  2.10it/s]  2%|▏         | 3/128 [00:01<00:57,  2.18it/s]  3%|▎         | 4/128 [00:01<00:57,  2.17it/s]  4%|▍         | 5/128 [00:02<00:55,  2.21it/s]  5%|▍         | 6/128 [00:02<00:58,  2.09it/s]  5%|▌         | 7/128 [00:03<00:59,  2.05it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:54,  2.19it/s]  8%|▊         | 10/128 [00:04<00:53,  2.22it/s]  9%|▊         | 11/128 [00:05<00:50,  2.32it/s]  9%|▉         | 12/128 [00:05<00:49,  2.36it/s] 10%|█         | 13/128 [00:05<00:49,  2.30it/s] 11%|█         | 14/128 [00:06<00:49,  2.30it/s] 12%|█▏        | 15/128 [00:06<00:49,  2.30it/s] 12%|█▎        | 16/128 [00:07<00:47,  2.34it/s] 13%|█▎        | 17/128 [00:07<00:50,  2.21it/s] 14%|█▍        | 18/128 [00:08<00:51,  2.12it/s] 15%|█▍        | 19/128 [00:08<00:51,  2.13it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.17it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.10it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.12it/s] 18%|█▊        | 23/128 [00:10<00:47,  2.21it/s] 19%|█▉        | 24/128 [00:10<00:46,  2.23it/s] 20%|█▉        | 25/128 [00:11<00:44,  2.30it/s] 20%|██        | 26/128 [00:11<00:46,  2.19it/s] 21%|██        | 27/128 [00:12<00:47,  2.11it/s] 22%|██▏       | 28/128 [00:12<00:46,  2.13it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.07it/s] 23%|██▎       | 30/128 [00:13<00:45,  2.17it/s] 24%|██▍       | 31/128 [00:14<00:43,  2.25it/s] 25%|██▌       | 32/128 [00:14<00:44,  2.15it/s] 26%|██▌       | 33/128 [00:15<00:45,  2.09it/s] 27%|██▋       | 34/128 [00:15<00:44,  2.12it/s] 27%|██▋       | 35/128 [00:16<00:43,  2.16it/s] 28%|██▊       | 36/128 [00:16<00:42,  2.16it/s] 29%|██▉       | 37/128 [00:16<00:41,  2.19it/s] 30%|██▉       | 38/128 [00:17<00:41,  2.18it/s] 30%|███       | 39/128 [00:17<00:40,  2.18it/s] 31%|███▏      | 40/128 [00:18<00:39,  2.25it/s] 32%|███▏      | 41/128 [00:18<00:43,  2.02it/s] 33%|███▎      | 42/128 [00:19<00:43,  2.00it/s] 34%|███▎      | 43/128 [00:19<00:41,  2.07it/s] 34%|███▍      | 44/128 [00:20<00:40,  2.09it/s] 35%|███▌      | 45/128 [00:20<00:40,  2.05it/s] 36%|███▌      | 46/128 [00:21<00:40,  2.02it/s] 37%|███▋      | 47/128 [00:21<00:40,  2.01it/s] 38%|███▊      | 48/128 [00:22<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:22<00:37,  2.11it/s] 39%|███▉      | 50/128 [00:23<00:36,  2.12it/s] 40%|███▉      | 51/128 [00:23<00:35,  2.17it/s] 41%|████      | 52/128 [00:24<00:36,  2.10it/s] 41%|████▏     | 53/128 [00:24<00:36,  2.03it/s] 42%|████▏     | 54/128 [00:25<00:34,  2.14it/s] 43%|████▎     | 55/128 [00:25<00:33,  2.18it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.10it/s] 45%|████▍     | 57/128 [00:26<00:34,  2.05it/s] 45%|████▌     | 58/128 [00:27<00:34,  2.01it/s] 46%|████▌     | 59/128 [00:27<00:33,  2.05it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.11it/s] 48%|████▊     | 61/128 [00:28<00:31,  2.12it/s] 48%|████▊     | 62/128 [00:28<00:31,  2.07it/s] 49%|████▉     | 63/128 [00:29<00:31,  2.03it/s] 50%|█████     | 64/128 [00:30<00:31,  2.01it/s] 51%|█████     | 65/128 [00:30<00:31,  2.00it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:31<00:29,  2.06it/s] 53%|█████▎    | 68/128 [00:31<00:28,  2.09it/s] 54%|█████▍    | 69/128 [00:32<00:27,  2.11it/s] 55%|█████▍    | 70/128 [00:32<00:26,  2.20it/s] 55%|█████▌    | 71/128 [00:33<00:26,  2.12it/s] 56%|█████▋    | 72/128 [00:33<00:26,  2.08it/s] 57%|█████▋    | 73/128 [00:34<00:27,  2.01it/s] 58%|█████▊    | 74/128 [00:34<00:26,  2.05it/s] 59%|█████▊    | 75/128 [00:35<00:26,  2.02it/s] 59%|█████▉    | 76/128 [00:35<00:26,  1.99it/s] 60%|██████    | 77/128 [00:36<00:25,  1.99it/s] 61%|██████    | 78/128 [00:36<00:25,  1.96it/s] 62%|██████▏   | 79/128 [00:37<00:23,  2.08it/s] 62%|██████▎   | 80/128 [00:37<00:23,  2.02it/s] 63%|██████▎   | 81/128 [00:38<00:23,  1.99it/s] 64%|██████▍   | 82/128 [00:38<00:22,  2.07it/s] 65%|██████▍   | 83/128 [00:39<00:22,  2.02it/s] 66%|██████▌   | 84/128 [00:39<00:21,  2.06it/s] 66%|██████▋   | 85/128 [00:40<00:19,  2.16it/s] 67%|██████▋   | 86/128 [00:40<00:20,  2.10it/s] 68%|██████▊   | 87/128 [00:41<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:41<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:42<00:18,  2.13it/s] 70%|███████   | 90/128 [00:42<00:18,  2.08it/s] 71%|███████   | 91/128 [00:43<00:17,  2.10it/s] 72%|███████▏  | 92/128 [00:43<00:16,  2.14it/s] 73%|███████▎  | 93/128 [00:44<00:16,  2.07it/s] 73%|███████▎  | 94/128 [00:44<00:15,  2.13it/s] 74%|███████▍  | 95/128 [00:44<00:14,  2.21it/s] 75%|███████▌  | 96/128 [00:45<00:15,  2.12it/s] 76%|███████▌  | 97/128 [00:45<00:14,  2.13it/s] 77%|███████▋  | 98/128 [00:46<00:14,  2.07it/s] 77%|███████▋  | 99/128 [00:46<00:14,  2.04it/s] 78%|███████▊  | 100/128 [00:47<00:14,  1.99it/s] 79%|███████▉  | 101/128 [00:47<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:48<00:12,  2.02it/s] 80%|████████  | 103/128 [00:48<00:12,  2.06it/s] 81%|████████▏ | 104/128 [00:49<00:11,  2.16it/s] 82%|████████▏ | 105/128 [00:49<00:10,  2.16it/s] 83%|████████▎ | 106/128 [00:50<00:10,  2.15it/s] 84%|████████▎ | 107/128 [00:50<00:09,  2.18it/s] 84%|████████▍ | 108/128 [00:51<00:08,  2.25it/s] 85%|████████▌ | 109/128 [00:51<00:08,  2.14it/s] 86%|████████▌ | 110/128 [00:52<00:08,  2.07it/s] 87%|████████▋ | 111/128 [00:52<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.09it/s] 88%|████████▊ | 113/128 [00:53<00:07,  2.11it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.12it/s] 90%|████████▉ | 115/128 [00:54<00:06,  2.16it/s] 91%|█████████ | 116/128 [00:54<00:05,  2.16it/s] 91%|█████████▏| 117/128 [00:55<00:05,  2.08it/s] 92%|█████████▏| 118/128 [00:55<00:04,  2.10it/s] 93%|█████████▎| 119/128 [00:56<00:04,  2.19it/s] 94%|█████████▍| 120/128 [00:56<00:03,  2.21it/s] 95%|█████████▍| 121/128 [00:57<00:03,  2.19it/s] 95%|█████████▌| 122/128 [00:57<00:02,  2.17it/s] 96%|█████████▌| 123/128 [00:58<00:02,  2.25it/s] 97%|█████████▋| 124/128 [00:58<00:01,  2.21it/s] 98%|█████████▊| 125/128 [00:59<00:01,  2.23it/s] 98%|█████████▊| 126/128 [00:59<00:00,  2.11it/s] 99%|█████████▉| 127/128 [01:00<00:00,  2.12it/s]100%|██████████| 128/128 [01:00<00:00,  2.13it/s]100%|██████████| 128/128 [01:00<00:00,  2.12it/s]
[2024-01-18 09:11:54,943] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:55,  2.27it/s]  2%|▏         | 2/128 [00:00<01:00,  2.07it/s]  2%|▏         | 3/128 [00:01<00:58,  2.14it/s]  3%|▎         | 4/128 [00:01<00:58,  2.14it/s]  4%|▍         | 5/128 [00:02<00:56,  2.17it/s]  5%|▍         | 6/128 [00:02<00:58,  2.07it/s]  5%|▌         | 7/128 [00:03<00:59,  2.02it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:55,  2.16it/s]  8%|▊         | 10/128 [00:04<00:54,  2.18it/s]  9%|▊         | 11/128 [00:05<00:51,  2.29it/s]  9%|▉         | 12/128 [00:05<00:49,  2.33it/s] 10%|█         | 13/128 [00:05<00:50,  2.27it/s] 11%|█         | 14/128 [00:06<00:50,  2.27it/s] 12%|█▏        | 15/128 [00:06<00:50,  2.26it/s] 12%|█▎        | 16/128 [00:07<00:48,  2.31it/s] 13%|█▎        | 17/128 [00:07<00:51,  2.18it/s] 14%|█▍        | 18/128 [00:08<00:52,  2.09it/s] 15%|█▍        | 19/128 [00:08<00:51,  2.10it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.14it/s] 16%|█▋        | 21/128 [00:09<00:51,  2.07it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.09it/s] 18%|█▊        | 23/128 [00:10<00:48,  2.18it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.20it/s] 20%|█▉        | 25/128 [00:11<00:45,  2.27it/s] 20%|██        | 26/128 [00:12<00:47,  2.14it/s] 21%|██        | 27/128 [00:12<00:48,  2.07it/s] 22%|██▏       | 28/128 [00:12<00:47,  2.09it/s] 23%|██▎       | 29/128 [00:13<00:48,  2.04it/s] 23%|██▎       | 30/128 [00:13<00:45,  2.14it/s] 24%|██▍       | 31/128 [00:14<00:43,  2.21it/s] 25%|██▌       | 32/128 [00:14<00:45,  2.12it/s] 26%|██▌       | 33/128 [00:15<00:45,  2.07it/s] 27%|██▋       | 34/128 [00:15<00:45,  2.09it/s] 27%|██▋       | 35/128 [00:16<00:43,  2.13it/s] 28%|██▊       | 36/128 [00:16<00:43,  2.13it/s] 29%|██▉       | 37/128 [00:17<00:42,  2.16it/s] 30%|██▉       | 38/128 [00:17<00:41,  2.15it/s] 30%|███       | 39/128 [00:18<00:41,  2.14it/s] 31%|███▏      | 40/128 [00:18<00:39,  2.21it/s] 32%|███▏      | 41/128 [00:19<00:43,  1.99it/s] 33%|███▎      | 42/128 [00:19<00:43,  1.97it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.04it/s] 34%|███▍      | 44/128 [00:20<00:40,  2.06it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.02it/s] 36%|███▌      | 46/128 [00:21<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:22<00:40,  1.98it/s] 38%|███▊      | 48/128 [00:22<00:40,  1.96it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.08it/s] 39%|███▉      | 50/128 [00:23<00:37,  2.10it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.14it/s] 41%|████      | 52/128 [00:24<00:36,  2.07it/s] 41%|████▏     | 53/128 [00:25<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:25<00:35,  2.11it/s] 43%|████▎     | 55/128 [00:25<00:33,  2.15it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.07it/s] 45%|████▍     | 57/128 [00:26<00:35,  2.02it/s] 45%|████▌     | 58/128 [00:27<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:27<00:34,  2.03it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.08it/s] 48%|████▊     | 61/128 [00:28<00:31,  2.10it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.05it/s] 49%|████▉     | 63/128 [00:29<00:32,  2.01it/s] 50%|█████     | 64/128 [00:30<00:32,  1.99it/s] 51%|█████     | 65/128 [00:30<00:31,  1.97it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.96it/s] 52%|█████▏    | 67/128 [00:31<00:29,  2.04it/s] 53%|█████▎    | 68/128 [00:32<00:29,  2.07it/s] 54%|█████▍    | 69/128 [00:32<00:28,  2.08it/s] 55%|█████▍    | 70/128 [00:33<00:26,  2.17it/s] 55%|█████▌    | 71/128 [00:33<00:27,  2.09it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.05it/s] 57%|█████▋    | 73/128 [00:34<00:27,  1.98it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.02it/s] 59%|█████▊    | 75/128 [00:35<00:26,  1.99it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.97it/s] 60%|██████    | 77/128 [00:36<00:26,  1.96it/s] 61%|██████    | 78/128 [00:37<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:37<00:23,  2.06it/s] 62%|██████▎   | 80/128 [00:38<00:24,  2.00it/s] 63%|██████▎   | 81/128 [00:38<00:23,  1.97it/s] 64%|██████▍   | 82/128 [00:39<00:22,  2.05it/s] 65%|██████▍   | 83/128 [00:39<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.04it/s] 66%|██████▋   | 85/128 [00:40<00:20,  2.14it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.08it/s] 68%|██████▊   | 87/128 [00:41<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:42<00:20,  1.99it/s] 70%|██████▉   | 89/128 [00:42<00:18,  2.10it/s] 70%|███████   | 90/128 [00:43<00:18,  2.05it/s] 71%|███████   | 91/128 [00:43<00:17,  2.08it/s] 72%|███████▏  | 92/128 [00:44<00:16,  2.12it/s] 73%|███████▎  | 93/128 [00:44<00:17,  2.05it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.11it/s] 74%|███████▍  | 95/128 [00:45<00:15,  2.19it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.10it/s] 76%|███████▌  | 97/128 [00:46<00:14,  2.10it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.05it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.02it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.97it/s] 79%|███████▉  | 101/128 [00:48<00:13,  1.96it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.01it/s] 80%|████████  | 103/128 [00:49<00:12,  2.04it/s] 81%|████████▏ | 104/128 [00:49<00:11,  2.15it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.14it/s] 83%|████████▎ | 106/128 [00:50<00:10,  2.14it/s] 84%|████████▎ | 107/128 [00:51<00:09,  2.17it/s] 84%|████████▍ | 108/128 [00:51<00:09,  2.19it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.10it/s] 86%|████████▌ | 110/128 [00:52<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.07it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.09it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.10it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.15it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.14it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.07it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.09it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.17it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.20it/s] 95%|█████████▍| 121/128 [00:57<00:03,  2.18it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.17it/s] 96%|█████████▌| 123/128 [00:58<00:02,  2.24it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.21it/s] 98%|█████████▊| 125/128 [00:59<00:01,  2.22it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.11it/s] 99%|█████████▉| 127/128 [01:00<00:00,  2.12it/s]100%|██████████| 128/128 [01:01<00:00,  2.12it/s]100%|██████████| 128/128 [01:01<00:00,  2.09it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:05<00:10,  5.35s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.62s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.33s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:15<00:00,  5.21s/it]
[2024-01-18 09:13:51,218] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 54%|█████▍    | 69/128 [00:00<00:00, 682.57it/s]100%|██████████| 128/128 [00:00<00:00, 678.56it/s]
[2024-01-18 09:13:51,542] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:03,  1.99it/s]  2%|▏         | 2/128 [00:00<01:00,  2.10it/s]  2%|▏         | 3/128 [00:01<00:58,  2.13it/s]  3%|▎         | 4/128 [00:01<01:00,  2.06it/s]  4%|▍         | 5/128 [00:02<01:01,  2.00it/s]  5%|▍         | 6/128 [00:02<00:58,  2.08it/s]  5%|▌         | 7/128 [00:03<00:59,  2.04it/s]  6%|▋         | 8/128 [00:03<00:55,  2.15it/s]  7%|▋         | 9/128 [00:04<00:55,  2.16it/s]  8%|▊         | 10/128 [00:04<00:54,  2.16it/s]  9%|▊         | 11/128 [00:05<00:55,  2.09it/s]  9%|▉         | 12/128 [00:05<00:56,  2.05it/s] 10%|█         | 13/128 [00:06<00:54,  2.11it/s] 11%|█         | 14/128 [00:06<00:55,  2.07it/s] 12%|█▏        | 15/128 [00:07<00:55,  2.04it/s] 12%|█▎        | 16/128 [00:07<00:53,  2.08it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.02it/s] 14%|█▍        | 18/128 [00:08<00:51,  2.14it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.08it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.11it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.13it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.03it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.10it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.05it/s] 20%|██        | 26/128 [00:12<00:50,  2.02it/s] 21%|██        | 27/128 [00:13<00:50,  2.00it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.03it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.09it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.11it/s] 25%|██▌       | 32/128 [00:15<00:49,  1.94it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.93it/s] 27%|██▋       | 35/128 [00:17<00:47,  1.94it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.03it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.99it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.98it/s] 30%|███       | 39/128 [00:19<00:43,  2.03it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.99it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.96it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.04it/s] 34%|███▎      | 43/128 [00:21<00:42,  2.02it/s] 34%|███▍      | 44/128 [00:21<00:40,  2.06it/s] 35%|███▌      | 45/128 [00:22<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.97it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.97it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.02it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.00it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.05it/s] 41%|████      | 52/128 [00:25<00:37,  2.01it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.99it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.98it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.06it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.99it/s] 46%|████▌     | 59/128 [00:29<00:34,  1.98it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.97it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.95it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.93it/s] 50%|█████     | 64/128 [00:31<00:35,  1.83it/s] 51%|█████     | 65/128 [00:32<00:33,  1.87it/s] 52%|█████▏    | 66/128 [00:32<00:33,  1.88it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.95it/s] 53%|█████▎    | 68/128 [00:33<00:29,  2.01it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.08it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.02it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.05it/s] 56%|█████▋    | 72/128 [00:35<00:29,  1.89it/s] 57%|█████▋    | 73/128 [00:36<00:28,  1.91it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.98it/s] 59%|█████▊    | 75/128 [00:37<00:24,  2.12it/s] 59%|█████▉    | 76/128 [00:37<00:25,  2.05it/s] 60%|██████    | 77/128 [00:38<00:25,  1.99it/s] 61%|██████    | 78/128 [00:38<00:25,  1.96it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.96it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.94it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.95it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.94it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.94it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.98it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.98it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.98it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.05it/s] 70%|███████   | 90/128 [00:44<00:18,  2.11it/s] 71%|███████   | 91/128 [00:45<00:17,  2.15it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.09it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.05it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.08it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.03it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.98it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.97it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.02it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.14it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.13it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.07it/s] 80%|████████  | 103/128 [00:51<00:12,  2.03it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.99it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.98it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.95it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.93it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.98it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.03it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.06it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.00it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.04it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.11it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.11it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.06it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.12it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.16it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.03it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:00<00:03,  1.97it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.96it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.95it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.00it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.04it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.06it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
[2024-01-18 09:14:54,948] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:00<01:01,  2.06it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:02<01:02,  1.98it/s]  4%|▍         | 5/128 [00:02<01:03,  1.94it/s]  5%|▍         | 6/128 [00:03<01:00,  2.00it/s]  5%|▌         | 7/128 [00:03<01:01,  1.97it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:55,  2.12it/s]  9%|▊         | 11/128 [00:05<00:56,  2.06it/s]  9%|▉         | 12/128 [00:05<00:57,  2.01it/s] 10%|█         | 13/128 [00:06<00:55,  2.07it/s] 11%|█         | 14/128 [00:06<00:56,  2.03it/s] 12%|█▏        | 15/128 [00:07<00:56,  2.01it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.05it/s] 13%|█▎        | 17/128 [00:08<00:55,  1.99it/s] 14%|█▍        | 18/128 [00:08<00:52,  2.10it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.05it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.10it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.04it/s] 18%|█▊        | 23/128 [00:11<00:52,  2.01it/s] 19%|█▉        | 24/128 [00:11<00:50,  2.07it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.02it/s] 20%|██        | 26/128 [00:12<00:51,  1.99it/s] 21%|██        | 27/128 [00:13<00:51,  1.97it/s] 22%|██▏       | 28/128 [00:13<00:51,  1.94it/s] 23%|██▎       | 29/128 [00:14<00:49,  1.99it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.06it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:15<00:50,  1.91it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.92it/s] 27%|██▋       | 34/128 [00:16<00:49,  1.90it/s] 27%|██▋       | 35/128 [00:17<00:48,  1.91it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.00it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.96it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.96it/s] 30%|███       | 39/128 [00:19<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.93it/s] 33%|███▎      | 42/128 [00:20<00:42,  2.01it/s] 34%|███▎      | 43/128 [00:21<00:42,  1.99it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.04it/s] 35%|███▌      | 45/128 [00:22<00:41,  1.98it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.96it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.00it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.98it/s] 40%|███▉      | 51/128 [00:25<00:38,  2.02it/s] 41%|████      | 52/128 [00:25<00:38,  1.99it/s] 41%|████▏     | 53/128 [00:26<00:38,  1.97it/s] 42%|████▏     | 54/128 [00:26<00:37,  1.96it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.04it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.01it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.97it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.95it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.93it/s] 48%|████▊     | 62/128 [00:31<00:34,  1.92it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.91it/s] 50%|█████     | 64/128 [00:32<00:35,  1.81it/s] 51%|█████     | 65/128 [00:32<00:34,  1.85it/s] 52%|█████▏    | 66/128 [00:33<00:33,  1.86it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.94it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.99it/s] 54%|█████▍    | 69/128 [00:34<00:28,  2.06it/s] 55%|█████▍    | 70/128 [00:35<00:28,  2.00it/s] 55%|█████▌    | 71/128 [00:35<00:27,  2.04it/s] 56%|█████▋    | 72/128 [00:36<00:29,  1.88it/s] 57%|█████▋    | 73/128 [00:36<00:29,  1.90it/s] 58%|█████▊    | 74/128 [00:37<00:27,  1.96it/s] 59%|█████▊    | 75/128 [00:37<00:25,  2.11it/s] 59%|█████▉    | 76/128 [00:38<00:25,  2.03it/s] 60%|██████    | 77/128 [00:38<00:25,  1.97it/s] 61%|██████    | 78/128 [00:39<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:42<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.97it/s] 67%|██████▋   | 86/128 [00:43<00:20,  2.02it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:44<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.04it/s] 70%|███████   | 90/128 [00:45<00:18,  2.10it/s] 71%|███████   | 91/128 [00:45<00:17,  2.14it/s] 72%|███████▏  | 92/128 [00:46<00:17,  2.08it/s] 73%|███████▎  | 93/128 [00:46<00:17,  2.04it/s] 73%|███████▎  | 94/128 [00:47<00:16,  2.06it/s] 74%|███████▍  | 95/128 [00:47<00:16,  2.02it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.97it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.98it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.13it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.12it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.06it/s] 80%|████████  | 103/128 [00:51<00:12,  2.01it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.98it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.97it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.93it/s] 84%|████████▎ | 107/128 [00:53<00:10,  1.94it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.92it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.97it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.02it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:56<00:08,  2.00it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.03it/s] 89%|████████▉ | 114/128 [00:57<00:06,  2.09it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.10it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.05it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.10it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.14it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.07it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.02it/s] 95%|█████████▍| 121/128 [01:00<00:03,  1.98it/s] 95%|█████████▌| 122/128 [01:01<00:03,  1.96it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.95it/s] 97%|█████████▋| 124/128 [01:02<00:02,  1.94it/s] 98%|█████████▊| 125/128 [01:02<00:01,  1.99it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.03it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.05it/s]100%|██████████| 128/128 [01:04<00:00,  2.01it/s]100%|██████████| 128/128 [01:04<00:00,  2.00it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:07<00:15,  7.88s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:15<00:07,  7.78s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:21<00:00,  7.09s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:21<00:00,  7.29s/it]
[2024-01-18 09:17:00,282] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 40%|███▉      | 51/128 [00:00<00:00, 507.84it/s] 97%|█████████▋| 124/128 [00:00<00:00, 637.05it/s]100%|██████████| 128/128 [00:00<00:00, 619.91it/s]
[2024-01-18 09:17:00,618] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:55,  2.29it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<00:56,  2.20it/s]  3%|▎         | 4/128 [00:01<00:56,  2.19it/s]  4%|▍         | 5/128 [00:02<00:56,  2.18it/s]  5%|▍         | 6/128 [00:02<00:55,  2.18it/s]  5%|▌         | 7/128 [00:03<00:58,  2.08it/s]  6%|▋         | 8/128 [00:03<00:58,  2.05it/s]  7%|▋         | 9/128 [00:04<00:54,  2.18it/s]  8%|▊         | 10/128 [00:04<00:52,  2.26it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:52,  2.19it/s] 10%|█         | 13/128 [00:05<00:51,  2.22it/s] 11%|█         | 14/128 [00:06<00:53,  2.14it/s] 12%|█▏        | 15/128 [00:06<00:50,  2.25it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.15it/s] 13%|█▎        | 17/128 [00:07<00:53,  2.07it/s] 14%|█▍        | 18/128 [00:08<00:50,  2.17it/s] 15%|█▍        | 19/128 [00:08<00:51,  2.11it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.13it/s] 16%|█▋        | 21/128 [00:09<00:49,  2.17it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.20it/s] 18%|█▊        | 23/128 [00:10<00:47,  2.19it/s] 19%|█▉        | 24/128 [00:11<00:45,  2.26it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.24it/s] 20%|██        | 26/128 [00:11<00:46,  2.22it/s] 21%|██        | 27/128 [00:12<00:45,  2.24it/s] 22%|██▏       | 28/128 [00:12<00:46,  2.14it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 30/128 [00:13<00:45,  2.14it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.06it/s] 25%|██▌       | 32/128 [00:14<00:47,  2.01it/s] 26%|██▌       | 33/128 [00:15<00:44,  2.15it/s] 27%|██▋       | 34/128 [00:15<00:45,  2.08it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.05it/s] 28%|██▊       | 36/128 [00:16<00:45,  2.02it/s] 29%|██▉       | 37/128 [00:17<00:46,  1.98it/s] 30%|██▉       | 38/128 [00:17<00:46,  1.95it/s] 30%|███       | 39/128 [00:18<00:43,  2.04it/s] 31%|███▏      | 40/128 [00:18<00:40,  2.15it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.07it/s] 33%|███▎      | 42/128 [00:19<00:41,  2.10it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.06it/s] 34%|███▍      | 44/128 [00:20<00:41,  2.01it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.00it/s] 36%|███▌      | 46/128 [00:21<00:39,  2.07it/s] 37%|███▋      | 47/128 [00:22<00:38,  2.10it/s] 38%|███▊      | 48/128 [00:22<00:37,  2.11it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.04it/s] 39%|███▉      | 50/128 [00:23<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.06it/s] 41%|████      | 52/128 [00:24<00:36,  2.09it/s] 41%|████▏     | 53/128 [00:25<00:34,  2.19it/s] 42%|████▏     | 54/128 [00:25<00:33,  2.18it/s] 43%|████▎     | 55/128 [00:25<00:33,  2.17it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.08it/s] 45%|████▍     | 57/128 [00:26<00:32,  2.17it/s] 45%|████▌     | 58/128 [00:27<00:32,  2.16it/s] 46%|████▌     | 59/128 [00:27<00:32,  2.09it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.05it/s] 48%|████▊     | 61/128 [00:28<00:32,  2.08it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.03it/s] 49%|████▉     | 63/128 [00:29<00:32,  2.01it/s] 50%|█████     | 64/128 [00:30<00:34,  1.87it/s] 51%|█████     | 65/128 [00:30<00:31,  1.97it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.96it/s] 52%|█████▏    | 67/128 [00:31<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:32<00:30,  1.96it/s] 54%|█████▍    | 69/128 [00:32<00:29,  2.02it/s] 55%|█████▍    | 70/128 [00:33<00:29,  1.99it/s] 55%|█████▌    | 71/128 [00:33<00:27,  2.06it/s] 56%|█████▋    | 72/128 [00:34<00:25,  2.20it/s] 57%|█████▋    | 73/128 [00:34<00:25,  2.12it/s] 58%|█████▊    | 74/128 [00:35<00:25,  2.13it/s] 59%|█████▊    | 75/128 [00:35<00:25,  2.05it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.02it/s] 60%|██████    | 77/128 [00:36<00:25,  1.98it/s] 61%|██████    | 78/128 [00:37<00:24,  2.03it/s] 62%|██████▏   | 79/128 [00:37<00:24,  1.99it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.95it/s] 63%|██████▎   | 81/128 [00:38<00:24,  1.95it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.95it/s] 65%|██████▍   | 83/128 [00:39<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:40<00:22,  1.94it/s] 66%|██████▋   | 85/128 [00:40<00:21,  2.02it/s] 67%|██████▋   | 86/128 [00:41<00:21,  2.00it/s] 68%|██████▊   | 87/128 [00:41<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:42<00:19,  2.01it/s] 70%|██████▉   | 89/128 [00:42<00:19,  2.00it/s] 70%|███████   | 90/128 [00:43<00:18,  2.05it/s] 71%|███████   | 91/128 [00:43<00:18,  2.02it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:44<00:16,  2.08it/s] 73%|███████▎  | 94/128 [00:45<00:15,  2.18it/s] 74%|███████▍  | 95/128 [00:45<00:15,  2.11it/s] 75%|███████▌  | 96/128 [00:46<00:14,  2.15it/s] 76%|███████▌  | 97/128 [00:46<00:14,  2.07it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.03it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.01it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.99it/s] 79%|███████▉  | 101/128 [00:48<00:13,  1.96it/s] 80%|███████▉  | 102/128 [00:49<00:13,  1.95it/s] 80%|████████  | 103/128 [00:49<00:12,  1.96it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.04it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.26it/s] 83%|████████▎ | 106/128 [00:50<00:09,  2.22it/s] 84%|████████▎ | 107/128 [00:51<00:09,  2.13it/s] 84%|████████▍ | 108/128 [00:51<00:09,  2.14it/s] 85%|████████▌ | 109/128 [00:52<00:08,  2.14it/s] 86%|████████▌ | 110/128 [00:52<00:08,  2.07it/s] 87%|████████▋ | 111/128 [00:53<00:07,  2.13it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.13it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.07it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.03it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.09it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.11it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.19it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.26it/s] 93%|█████████▎| 119/128 [00:57<00:03,  2.26it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.15it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.08it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.13it/s] 96%|█████████▌| 123/128 [00:58<00:02,  2.21it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.23it/s] 98%|█████████▊| 125/128 [00:59<00:01,  2.20it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.12it/s] 99%|█████████▉| 127/128 [01:00<00:00,  2.06it/s]100%|██████████| 128/128 [01:01<00:00,  2.01it/s]100%|██████████| 128/128 [01:01<00:00,  2.08it/s]
[2024-01-18 09:18:02,050] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:56,  2.24it/s]  2%|▏         | 2/128 [00:01<01:08,  1.83it/s]  2%|▏         | 3/128 [00:01<01:00,  2.06it/s]  3%|▎         | 4/128 [00:01<00:59,  2.09it/s]  4%|▍         | 5/128 [00:02<00:58,  2.10it/s]  5%|▍         | 6/128 [00:02<00:57,  2.12it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:59,  2.01it/s]  7%|▋         | 9/128 [00:04<00:55,  2.14it/s]  8%|▊         | 10/128 [00:04<00:53,  2.22it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:53,  2.16it/s] 10%|█         | 13/128 [00:06<00:52,  2.19it/s] 11%|█         | 14/128 [00:06<00:54,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:50,  2.22it/s] 12%|█▎        | 16/128 [00:07<00:52,  2.12it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.05it/s] 14%|█▍        | 18/128 [00:08<00:52,  2.11it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.06it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.08it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.13it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.16it/s] 18%|█▊        | 23/128 [00:10<00:48,  2.15it/s] 19%|█▉        | 24/128 [00:11<00:46,  2.23it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.20it/s] 20%|██        | 26/128 [00:12<00:46,  2.18it/s] 21%|██        | 27/128 [00:12<00:45,  2.21it/s] 22%|██▏       | 28/128 [00:13<00:47,  2.12it/s] 23%|██▎       | 29/128 [00:13<00:47,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:46,  2.11it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.03it/s] 25%|██▌       | 32/128 [00:15<00:48,  1.99it/s] 26%|██▌       | 33/128 [00:15<00:44,  2.12it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.05it/s] 27%|██▋       | 35/128 [00:16<00:46,  2.02it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.99it/s] 29%|██▉       | 37/128 [00:17<00:46,  1.95it/s] 30%|██▉       | 38/128 [00:18<00:46,  1.93it/s] 30%|███       | 39/128 [00:18<00:44,  2.01it/s] 31%|███▏      | 40/128 [00:19<00:41,  2.12it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.04it/s] 33%|███▎      | 42/128 [00:20<00:41,  2.07it/s] 34%|███▎      | 43/128 [00:20<00:41,  2.03it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.98it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.97it/s] 36%|███▌      | 46/128 [00:22<00:40,  2.04it/s] 37%|███▋      | 47/128 [00:22<00:39,  2.07it/s] 38%|███▊      | 48/128 [00:23<00:38,  2.09it/s] 38%|███▊      | 49/128 [00:23<00:39,  2.02it/s] 39%|███▉      | 50/128 [00:24<00:39,  1.99it/s] 40%|███▉      | 51/128 [00:24<00:37,  2.03it/s] 41%|████      | 52/128 [00:25<00:36,  2.06it/s] 41%|████▏     | 53/128 [00:25<00:34,  2.15it/s] 42%|████▏     | 54/128 [00:25<00:34,  2.15it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.08it/s] 44%|████▍     | 56/128 [00:26<00:35,  2.01it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.12it/s] 45%|████▌     | 58/128 [00:27<00:33,  2.12it/s] 46%|████▌     | 59/128 [00:28<00:33,  2.05it/s] 47%|████▋     | 60/128 [00:28<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.05it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.01it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.98it/s] 50%|█████     | 64/128 [00:31<00:34,  1.85it/s] 51%|█████     | 65/128 [00:31<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:32<00:32,  1.93it/s] 52%|█████▏    | 67/128 [00:32<00:31,  1.93it/s] 53%|█████▎    | 68/128 [00:33<00:31,  1.93it/s] 54%|█████▍    | 69/128 [00:33<00:29,  1.99it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.97it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.04it/s] 56%|█████▋    | 72/128 [00:34<00:25,  2.17it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.09it/s] 58%|█████▊    | 74/128 [00:35<00:25,  2.10it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.02it/s] 59%|█████▉    | 76/128 [00:36<00:26,  2.00it/s] 60%|██████    | 77/128 [00:37<00:26,  1.96it/s] 61%|██████    | 78/128 [00:37<00:24,  2.01it/s] 62%|██████▏   | 79/128 [00:38<00:24,  1.97it/s] 62%|██████▎   | 80/128 [00:38<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:40<00:23,  1.91it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.92it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:42<00:21,  1.95it/s] 69%|██████▉   | 88/128 [00:43<00:20,  2.00it/s] 70%|██████▉   | 89/128 [00:43<00:19,  1.98it/s] 70%|███████   | 90/128 [00:44<00:18,  2.03it/s] 71%|███████   | 91/128 [00:44<00:18,  2.00it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.06it/s] 73%|███████▎  | 94/128 [00:45<00:15,  2.16it/s] 74%|███████▍  | 95/128 [00:46<00:15,  2.09it/s] 75%|███████▌  | 96/128 [00:46<00:14,  2.13it/s] 76%|███████▌  | 97/128 [00:47<00:15,  2.05it/s] 77%|███████▋  | 98/128 [00:47<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.99it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.97it/s] 79%|███████▉  | 101/128 [00:49<00:13,  1.94it/s] 80%|███████▉  | 102/128 [00:50<00:13,  1.94it/s] 80%|████████  | 103/128 [00:50<00:12,  1.94it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.02it/s] 82%|████████▏ | 105/128 [00:51<00:10,  2.16it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.15it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.08it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.09it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.10it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.10it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.11it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.05it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.01it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.07it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.18it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.24it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.24it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.14it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.07it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.12it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.20it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.21it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.19it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.10it/s] 99%|█████████▉| 127/128 [01:01<00:00,  2.05it/s]100%|██████████| 128/128 [01:02<00:00,  1.99it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.22s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.13s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.00s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.77s/it]
[2024-01-18 09:19:57,959] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 66/128 [00:00<00:00, 659.43it/s]100%|██████████| 128/128 [00:00<00:00, 661.12it/s]
[2024-01-18 09:19:58,290] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:06,  1.92it/s]  2%|▏         | 2/128 [00:00<01:01,  2.06it/s]  2%|▏         | 3/128 [00:01<01:02,  1.99it/s]  3%|▎         | 4/128 [00:02<01:02,  1.97it/s]  4%|▍         | 5/128 [00:02<01:02,  1.97it/s]  5%|▍         | 6/128 [00:03<01:01,  1.98it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:03<00:58,  2.06it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:05<00:59,  1.99it/s]  9%|▊         | 11/128 [00:05<00:59,  1.98it/s]  9%|▉         | 12/128 [00:06<00:58,  1.97it/s] 10%|█         | 13/128 [00:06<00:58,  1.97it/s] 11%|█         | 14/128 [00:07<00:58,  1.96it/s] 12%|█▏        | 15/128 [00:07<01:01,  1.85it/s] 12%|█▎        | 16/128 [00:08<00:59,  1.88it/s] 13%|█▎        | 17/128 [00:08<01:02,  1.79it/s] 14%|█▍        | 18/128 [00:09<00:57,  1.91it/s] 15%|█▍        | 19/128 [00:09<00:54,  2.01it/s] 16%|█▌        | 20/128 [00:10<00:54,  1.99it/s] 16%|█▋        | 21/128 [00:10<00:52,  2.04it/s] 17%|█▋        | 22/128 [00:11<00:52,  2.02it/s] 18%|█▊        | 23/128 [00:11<00:52,  1.99it/s] 19%|█▉        | 24/128 [00:12<00:49,  2.11it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.06it/s] 20%|██        | 26/128 [00:13<00:50,  2.03it/s] 21%|██        | 27/128 [00:13<00:48,  2.07it/s] 22%|██▏       | 28/128 [00:14<00:49,  2.04it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.08it/s] 23%|██▎       | 30/128 [00:15<00:48,  2.03it/s] 24%|██▍       | 31/128 [00:15<00:48,  1.99it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.96it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.94it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.94it/s] 27%|██▋       | 35/128 [00:17<00:44,  2.07it/s] 28%|██▊       | 36/128 [00:18<00:45,  2.01it/s] 29%|██▉       | 37/128 [00:18<00:45,  1.99it/s] 30%|██▉       | 38/128 [00:19<00:45,  1.96it/s] 30%|███       | 39/128 [00:19<00:45,  1.94it/s] 31%|███▏      | 40/128 [00:20<00:45,  1.93it/s] 32%|███▏      | 41/128 [00:20<00:44,  1.94it/s] 33%|███▎      | 42/128 [00:21<00:44,  1.95it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.95it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:22<00:45,  1.82it/s] 36%|███▌      | 46/128 [00:23<00:44,  1.86it/s] 37%|███▋      | 47/128 [00:23<00:43,  1.88it/s] 38%|███▊      | 48/128 [00:24<00:40,  1.98it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.06it/s] 39%|███▉      | 50/128 [00:25<00:37,  2.09it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.04it/s] 41%|████      | 52/128 [00:26<00:38,  1.99it/s] 41%|████▏     | 53/128 [00:26<00:36,  2.04it/s] 42%|████▏     | 54/128 [00:27<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.06it/s] 44%|████▍     | 56/128 [00:28<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:28<00:35,  2.01it/s] 45%|████▌     | 58/128 [00:29<00:34,  2.05it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.03it/s] 47%|████▋     | 60/128 [00:30<00:33,  2.01it/s] 48%|████▊     | 61/128 [00:30<00:33,  2.00it/s] 48%|████▊     | 62/128 [00:31<00:33,  1.98it/s] 49%|████▉     | 63/128 [00:31<00:31,  2.06it/s] 50%|█████     | 64/128 [00:32<00:31,  2.02it/s] 51%|█████     | 65/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 66/128 [00:33<00:30,  2.02it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.06it/s] 53%|█████▎    | 68/128 [00:34<00:29,  2.03it/s] 54%|█████▍    | 69/128 [00:34<00:29,  1.99it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.96it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:36<00:26,  2.12it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.04it/s] 58%|█████▊    | 74/128 [00:37<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.96it/s] 59%|█████▉    | 76/128 [00:38<00:26,  1.96it/s] 60%|██████    | 77/128 [00:38<00:26,  1.94it/s] 61%|██████    | 78/128 [00:39<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.93it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.92it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.92it/s] 65%|██████▍   | 83/128 [00:41<00:23,  1.93it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.91it/s] 66%|██████▋   | 85/128 [00:42<00:22,  1.93it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.99it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.09it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.10it/s] 70%|███████   | 90/128 [00:45<00:18,  2.05it/s] 71%|███████   | 91/128 [00:45<00:18,  2.02it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.98it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.95it/s] 73%|███████▎  | 94/128 [00:47<00:16,  2.00it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.98it/s] 75%|███████▌  | 96/128 [00:48<00:15,  2.05it/s] 76%|███████▌  | 97/128 [00:48<00:14,  2.15it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.09it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.05it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.07it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.03it/s] 80%|███████▉  | 102/128 [00:51<00:13,  2.00it/s] 80%|████████  | 103/128 [00:51<00:12,  1.99it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.97it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.96it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.95it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.00it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.97it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.96it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.04it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.01it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 113/128 [00:56<00:07,  1.95it/s] 89%|████████▉ | 114/128 [00:57<00:07,  1.95it/s] 90%|████████▉ | 115/128 [00:57<00:06,  1.95it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.92it/s] 91%|█████████▏| 117/128 [00:58<00:05,  1.99it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.96it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.01it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.05it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.02it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.06it/s] 96%|█████████▌| 123/128 [01:01<00:02,  2.11it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.03it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.99it/s]100%|██████████| 128/128 [01:04<00:00,  1.96it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
[2024-01-18 09:21:02,595] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:07,  1.88it/s]  2%|▏         | 2/128 [00:00<01:02,  2.03it/s]  2%|▏         | 3/128 [00:01<01:03,  1.96it/s]  3%|▎         | 4/128 [00:02<01:03,  1.95it/s]  4%|▍         | 5/128 [00:02<01:03,  1.95it/s]  5%|▍         | 6/128 [00:03<01:02,  1.95it/s]  5%|▌         | 7/128 [00:03<01:01,  1.95it/s]  6%|▋         | 8/128 [00:04<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:59,  2.00it/s]  8%|▊         | 10/128 [00:05<00:59,  1.97it/s]  9%|▊         | 11/128 [00:05<00:59,  1.96it/s]  9%|▉         | 12/128 [00:06<00:59,  1.95it/s] 10%|█         | 13/128 [00:06<00:58,  1.95it/s] 11%|█         | 14/128 [00:07<00:58,  1.94it/s] 12%|█▏        | 15/128 [00:07<01:01,  1.83it/s] 12%|█▎        | 16/128 [00:08<01:00,  1.87it/s] 13%|█▎        | 17/128 [00:08<01:02,  1.77it/s] 14%|█▍        | 18/128 [00:09<00:58,  1.89it/s] 15%|█▍        | 19/128 [00:09<00:54,  1.99it/s] 16%|█▌        | 20/128 [00:10<00:54,  1.97it/s] 16%|█▋        | 21/128 [00:10<00:53,  2.02it/s] 17%|█▋        | 22/128 [00:11<00:53,  2.00it/s] 18%|█▊        | 23/128 [00:11<00:53,  1.98it/s] 19%|█▉        | 24/128 [00:12<00:49,  2.09it/s] 20%|█▉        | 25/128 [00:12<00:50,  2.04it/s] 20%|██        | 26/128 [00:13<00:50,  2.01it/s] 21%|██        | 27/128 [00:13<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:14<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.05it/s] 23%|██▎       | 30/128 [00:15<00:48,  2.01it/s] 24%|██▍       | 31/128 [00:15<00:49,  1.97it/s] 25%|██▌       | 32/128 [00:16<00:49,  1.94it/s] 26%|██▌       | 33/128 [00:16<00:49,  1.92it/s] 27%|██▋       | 34/128 [00:17<00:48,  1.92it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.05it/s] 28%|██▊       | 36/128 [00:18<00:46,  2.00it/s] 29%|██▉       | 37/128 [00:18<00:46,  1.97it/s] 30%|██▉       | 38/128 [00:19<00:46,  1.94it/s] 30%|███       | 39/128 [00:19<00:46,  1.93it/s] 31%|███▏      | 40/128 [00:20<00:46,  1.91it/s] 32%|███▏      | 41/128 [00:20<00:45,  1.92it/s] 33%|███▎      | 42/128 [00:21<00:44,  1.93it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:22<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:23<00:46,  1.80it/s] 36%|███▌      | 46/128 [00:23<00:44,  1.85it/s] 37%|███▋      | 47/128 [00:24<00:43,  1.87it/s] 38%|███▊      | 48/128 [00:24<00:41,  1.95it/s] 38%|███▊      | 49/128 [00:25<00:38,  2.03it/s] 39%|███▉      | 50/128 [00:25<00:37,  2.06it/s] 40%|███▉      | 51/128 [00:26<00:38,  2.02it/s] 41%|████      | 52/128 [00:26<00:38,  1.97it/s] 41%|████▏     | 53/128 [00:27<00:37,  2.02it/s] 42%|████▏     | 54/128 [00:27<00:37,  2.00it/s] 43%|████▎     | 55/128 [00:28<00:35,  2.04it/s] 44%|████▍     | 56/128 [00:28<00:35,  2.01it/s] 45%|████▍     | 57/128 [00:29<00:35,  1.99it/s] 45%|████▌     | 58/128 [00:29<00:34,  2.03it/s] 46%|████▌     | 59/128 [00:30<00:34,  2.01it/s] 47%|████▋     | 60/128 [00:30<00:34,  1.99it/s] 48%|████▊     | 61/128 [00:31<00:33,  1.98it/s] 48%|████▊     | 62/128 [00:31<00:33,  1.97it/s] 49%|████▉     | 63/128 [00:32<00:31,  2.04it/s] 50%|█████     | 64/128 [00:32<00:32,  2.00it/s] 51%|█████     | 65/128 [00:33<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:33<00:30,  2.01it/s] 52%|█████▏    | 67/128 [00:34<00:29,  2.04it/s] 53%|█████▎    | 68/128 [00:34<00:29,  2.01it/s] 54%|█████▍    | 69/128 [00:35<00:29,  1.97it/s] 55%|█████▍    | 70/128 [00:35<00:29,  1.94it/s] 55%|█████▌    | 71/128 [00:36<00:28,  1.99it/s] 56%|█████▋    | 72/128 [00:36<00:26,  2.11it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.02it/s] 58%|█████▊    | 74/128 [00:37<00:27,  1.98it/s] 59%|█████▊    | 75/128 [00:38<00:27,  1.94it/s] 59%|█████▉    | 76/128 [00:38<00:26,  1.94it/s] 60%|██████    | 77/128 [00:39<00:26,  1.92it/s] 61%|██████    | 78/128 [00:39<00:26,  1.91it/s] 62%|██████▏   | 79/128 [00:40<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:40<00:25,  1.92it/s] 63%|██████▎   | 81/128 [00:41<00:24,  1.91it/s] 64%|██████▍   | 82/128 [00:41<00:24,  1.91it/s] 65%|██████▍   | 83/128 [00:42<00:23,  1.92it/s] 66%|██████▌   | 84/128 [00:42<00:23,  1.90it/s] 66%|██████▋   | 85/128 [00:43<00:22,  1.92it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:44<00:20,  1.96it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.07it/s] 70%|██████▉   | 89/128 [00:45<00:18,  2.09it/s] 70%|███████   | 90/128 [00:45<00:18,  2.04it/s] 71%|███████   | 91/128 [00:46<00:18,  2.01it/s] 72%|███████▏  | 92/128 [00:46<00:18,  1.97it/s] 73%|███████▎  | 93/128 [00:47<00:18,  1.93it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.99it/s] 74%|███████▍  | 95/128 [00:48<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:48<00:15,  2.04it/s] 76%|███████▌  | 97/128 [00:49<00:14,  2.14it/s] 77%|███████▋  | 98/128 [00:49<00:14,  2.07it/s] 77%|███████▋  | 99/128 [00:50<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.06it/s] 79%|███████▉  | 101/128 [00:51<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:51<00:13,  2.00it/s] 80%|████████  | 103/128 [00:52<00:12,  1.98it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.96it/s] 82%|████████▏ | 105/128 [00:53<00:11,  1.95it/s] 83%|████████▎ | 106/128 [00:53<00:11,  1.94it/s] 84%|████████▎ | 107/128 [00:54<00:10,  1.99it/s] 84%|████████▍ | 108/128 [00:54<00:10,  1.95it/s] 85%|████████▌ | 109/128 [00:55<00:09,  1.94it/s] 86%|████████▌ | 110/128 [00:55<00:08,  2.03it/s] 87%|████████▋ | 111/128 [00:56<00:08,  1.99it/s] 88%|████████▊ | 112/128 [00:56<00:08,  1.97it/s] 88%|████████▊ | 113/128 [00:57<00:07,  1.94it/s] 89%|████████▉ | 114/128 [00:57<00:07,  1.93it/s] 90%|████████▉ | 115/128 [00:58<00:06,  1.93it/s] 91%|█████████ | 116/128 [00:58<00:06,  1.90it/s] 91%|█████████▏| 117/128 [00:59<00:05,  1.97it/s] 92%|█████████▏| 118/128 [00:59<00:05,  1.94it/s] 93%|█████████▎| 119/128 [01:00<00:04,  1.99it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.03it/s] 95%|█████████▍| 121/128 [01:01<00:03,  2.00it/s] 95%|█████████▌| 122/128 [01:01<00:02,  2.04it/s] 96%|█████████▌| 123/128 [01:02<00:02,  2.09it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.01it/s] 98%|█████████▊| 125/128 [01:03<00:01,  1.98it/s] 98%|█████████▊| 126/128 [01:03<00:01,  1.94it/s] 99%|█████████▉| 127/128 [01:04<00:00,  1.94it/s]100%|██████████| 128/128 [01:04<00:00,  1.91it/s]100%|██████████| 128/128 [01:04<00:00,  1.97it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.34s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.22s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  5.00s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:14<00:00,  4.80s/it]
[2024-01-18 09:23:01,424] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 45%|████▌     | 58/128 [00:00<00:00, 573.08it/s]100%|██████████| 128/128 [00:00<00:00, 641.02it/s]
[2024-01-18 09:23:01,751] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:51,  2.47it/s]  2%|▏         | 2/128 [00:00<00:58,  2.15it/s]  2%|▏         | 3/128 [00:01<00:56,  2.21it/s]  3%|▎         | 4/128 [00:01<00:59,  2.10it/s]  4%|▍         | 5/128 [00:02<00:56,  2.16it/s]  5%|▍         | 6/128 [00:02<00:59,  2.06it/s]  5%|▌         | 7/128 [00:03<01:00,  2.01it/s]  6%|▋         | 8/128 [00:03<00:56,  2.13it/s]  7%|▋         | 9/128 [00:04<00:54,  2.17it/s]  8%|▊         | 10/128 [00:04<00:53,  2.20it/s]  9%|▊         | 11/128 [00:05<00:53,  2.19it/s]  9%|▉         | 12/128 [00:05<00:53,  2.18it/s] 10%|█         | 13/128 [00:06<00:54,  2.11it/s] 11%|█         | 14/128 [00:06<00:53,  2.12it/s] 12%|█▏        | 15/128 [00:06<00:51,  2.21it/s] 12%|█▎        | 16/128 [00:07<00:50,  2.20it/s] 13%|█▎        | 17/128 [00:07<00:52,  2.10it/s] 14%|█▍        | 18/128 [00:08<00:53,  2.04it/s] 15%|█▍        | 19/128 [00:08<00:52,  2.07it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.13it/s] 16%|█▋        | 21/128 [00:09<00:49,  2.17it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.10it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.12it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.16it/s] 20%|█▉        | 25/128 [00:11<00:45,  2.24it/s] 20%|██        | 26/128 [00:12<00:47,  2.15it/s] 21%|██        | 27/128 [00:12<00:46,  2.18it/s] 22%|██▏       | 28/128 [00:13<00:47,  2.11it/s] 23%|██▎       | 29/128 [00:13<00:48,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.03it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.06it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.12it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.06it/s] 27%|██▋       | 34/128 [00:15<00:44,  2.09it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.06it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.00it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.04it/s] 30%|██▉       | 38/128 [00:17<00:42,  2.11it/s] 30%|███       | 39/128 [00:18<00:43,  2.04it/s] 31%|███▏      | 40/128 [00:18<00:43,  2.01it/s] 32%|███▏      | 41/128 [00:19<00:41,  2.08it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.92it/s] 34%|███▎      | 43/128 [00:20<00:44,  1.91it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.93it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:22<00:41,  1.94it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.92it/s] 38%|███▊      | 49/128 [00:23<00:40,  1.94it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:24<00:35,  2.15it/s] 41%|████      | 52/128 [00:24<00:35,  2.15it/s] 41%|████▏     | 53/128 [00:25<00:33,  2.27it/s] 42%|████▏     | 54/128 [00:25<00:32,  2.27it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.17it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.10it/s] 45%|████▍     | 57/128 [00:27<00:32,  2.15it/s] 45%|████▌     | 58/128 [00:27<00:31,  2.25it/s] 46%|████▌     | 59/128 [00:28<00:32,  2.16it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.07it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.09it/s] 48%|████▊     | 62/128 [00:29<00:31,  2.11it/s] 49%|████▉     | 63/128 [00:30<00:31,  2.06it/s] 50%|█████     | 64/128 [00:30<00:31,  2.03it/s] 51%|█████     | 65/128 [00:31<00:31,  2.01it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.99it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.03it/s] 53%|█████▎    | 68/128 [00:32<00:29,  2.06it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.12it/s] 55%|█████▍    | 70/128 [00:33<00:26,  2.16it/s] 55%|█████▌    | 71/128 [00:33<00:25,  2.23it/s] 56%|█████▋    | 72/128 [00:34<00:26,  2.12it/s] 57%|█████▋    | 73/128 [00:34<00:25,  2.16it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.07it/s] 59%|█████▊    | 75/128 [00:35<00:26,  2.04it/s] 59%|█████▉    | 76/128 [00:36<00:25,  2.01it/s] 60%|██████    | 77/128 [00:36<00:24,  2.07it/s] 61%|██████    | 78/128 [00:37<00:24,  2.04it/s] 62%|██████▏   | 79/128 [00:37<00:24,  2.02it/s] 62%|██████▎   | 80/128 [00:38<00:23,  2.06it/s] 63%|██████▎   | 81/128 [00:38<00:23,  2.02it/s] 64%|██████▍   | 82/128 [00:39<00:23,  2.00it/s] 65%|██████▍   | 83/128 [00:39<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:40<00:22,  1.98it/s] 66%|██████▋   | 85/128 [00:40<00:20,  2.10it/s] 67%|██████▋   | 86/128 [00:41<00:19,  2.14it/s] 68%|██████▊   | 87/128 [00:41<00:19,  2.08it/s] 69%|██████▉   | 88/128 [00:42<00:18,  2.13it/s] 70%|██████▉   | 89/128 [00:42<00:18,  2.14it/s] 70%|███████   | 90/128 [00:43<00:17,  2.14it/s] 71%|███████   | 91/128 [00:43<00:17,  2.14it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.06it/s] 73%|███████▎  | 93/128 [00:44<00:16,  2.12it/s] 73%|███████▎  | 94/128 [00:45<00:15,  2.16it/s] 74%|███████▍  | 95/128 [00:45<00:15,  2.09it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.03it/s] 76%|███████▌  | 97/128 [00:46<00:15,  1.99it/s] 77%|███████▋  | 98/128 [00:47<00:15,  1.97it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.05it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.99it/s] 79%|███████▉  | 101/128 [00:48<00:13,  1.97it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.02it/s] 80%|████████  | 103/128 [00:49<00:12,  2.08it/s] 81%|████████▏ | 104/128 [00:49<00:11,  2.13it/s] 82%|████████▏ | 105/128 [00:50<00:11,  2.07it/s] 83%|████████▎ | 106/128 [00:50<00:10,  2.09it/s] 84%|████████▎ | 107/128 [00:51<00:10,  2.05it/s] 84%|████████▍ | 108/128 [00:51<00:09,  2.11it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.05it/s] 86%|████████▌ | 110/128 [00:52<00:08,  2.02it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.08it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.14it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.14it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.07it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.02it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.00it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.07it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.09it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.05it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.10it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.11it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.06it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.08it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.03it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:01<00:00,  1.99it/s]100%|██████████| 128/128 [01:01<00:00,  1.97it/s]100%|██████████| 128/128 [01:01<00:00,  2.07it/s]
[2024-01-18 09:24:03,444] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:52,  2.42it/s]  2%|▏         | 2/128 [00:00<00:59,  2.12it/s]  2%|▏         | 3/128 [00:01<00:57,  2.17it/s]  3%|▎         | 4/128 [00:01<00:59,  2.07it/s]  4%|▍         | 5/128 [00:02<00:57,  2.13it/s]  5%|▍         | 6/128 [00:02<01:00,  2.03it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:03<00:57,  2.10it/s]  7%|▋         | 9/128 [00:04<00:55,  2.15it/s]  8%|▊         | 10/128 [00:04<00:54,  2.17it/s]  9%|▊         | 11/128 [00:05<00:54,  2.16it/s]  9%|▉         | 12/128 [00:05<00:53,  2.15it/s] 10%|█         | 13/128 [00:06<00:55,  2.08it/s] 11%|█         | 14/128 [00:06<00:54,  2.09it/s] 12%|█▏        | 15/128 [00:07<00:51,  2.18it/s] 12%|█▎        | 16/128 [00:07<00:51,  2.17it/s] 13%|█▎        | 17/128 [00:08<00:53,  2.08it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.01it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.04it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.10it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.14it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:10<00:50,  2.09it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.13it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.21it/s] 20%|██        | 26/128 [00:12<00:48,  2.12it/s] 21%|██        | 27/128 [00:12<00:46,  2.15it/s] 22%|██▏       | 28/128 [00:13<00:47,  2.09it/s] 23%|██▎       | 29/128 [00:13<00:48,  2.03it/s] 23%|██▎       | 30/128 [00:14<00:49,  2.00it/s] 24%|██▍       | 31/128 [00:14<00:47,  2.04it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.10it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.04it/s] 27%|██▋       | 34/128 [00:16<00:45,  2.07it/s] 27%|██▋       | 35/128 [00:16<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:17<00:46,  1.98it/s] 29%|██▉       | 37/128 [00:17<00:45,  2.02it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.08it/s] 30%|███       | 39/128 [00:18<00:44,  2.02it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.99it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.06it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.90it/s] 34%|███▎      | 43/128 [00:20<00:44,  1.90it/s] 34%|███▍      | 44/128 [00:21<00:44,  1.91it/s] 35%|███▌      | 45/128 [00:21<00:43,  1.92it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.92it/s] 37%|███▋      | 47/128 [00:22<00:42,  1.92it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.91it/s] 38%|███▊      | 49/128 [00:23<00:41,  1.92it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.00it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.13it/s] 41%|████      | 52/128 [00:25<00:35,  2.13it/s] 41%|████▏     | 53/128 [00:25<00:33,  2.25it/s] 42%|████▏     | 54/128 [00:26<00:32,  2.25it/s] 43%|████▎     | 55/128 [00:26<00:33,  2.15it/s] 44%|████▍     | 56/128 [00:27<00:34,  2.09it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.14it/s] 45%|████▌     | 58/128 [00:27<00:31,  2.23it/s] 46%|████▌     | 59/128 [00:28<00:32,  2.14it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.05it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.07it/s] 48%|████▊     | 62/128 [00:29<00:31,  2.09it/s] 49%|████▉     | 63/128 [00:30<00:31,  2.04it/s] 50%|█████     | 64/128 [00:30<00:31,  2.01it/s] 51%|█████     | 65/128 [00:31<00:31,  1.99it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.01it/s] 53%|█████▎    | 68/128 [00:32<00:29,  2.04it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.10it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.14it/s] 55%|█████▌    | 71/128 [00:34<00:25,  2.21it/s] 56%|█████▋    | 72/128 [00:34<00:26,  2.10it/s] 57%|█████▋    | 73/128 [00:35<00:26,  2.11it/s] 58%|█████▊    | 74/128 [00:35<00:26,  2.03it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.00it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:24,  2.05it/s] 61%|██████    | 78/128 [00:37<00:24,  2.02it/s] 62%|██████▏   | 79/128 [00:38<00:24,  2.00it/s] 62%|██████▎   | 80/128 [00:38<00:23,  2.04it/s] 63%|██████▎   | 81/128 [00:39<00:23,  2.00it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.98it/s] 65%|██████▍   | 83/128 [00:40<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:40<00:22,  1.96it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.08it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.10it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.05it/s] 69%|██████▉   | 88/128 [00:42<00:19,  2.10it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.11it/s] 70%|███████   | 90/128 [00:43<00:17,  2.12it/s] 71%|███████   | 91/128 [00:44<00:17,  2.12it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:45<00:16,  2.10it/s] 73%|███████▎  | 94/128 [00:45<00:15,  2.14it/s] 74%|███████▍  | 95/128 [00:46<00:15,  2.07it/s] 75%|███████▌  | 96/128 [00:46<00:15,  2.01it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.98it/s] 77%|███████▋  | 98/128 [00:47<00:15,  1.96it/s] 77%|███████▋  | 99/128 [00:48<00:14,  2.04it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.98it/s] 79%|███████▉  | 101/128 [00:49<00:13,  1.96it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.01it/s] 80%|████████  | 103/128 [00:50<00:12,  2.07it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.11it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.06it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.08it/s] 84%|████████▎ | 107/128 [00:51<00:10,  2.04it/s] 84%|████████▍ | 108/128 [00:52<00:09,  2.10it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.04it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.00it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.07it/s] 88%|████████▊ | 112/128 [00:54<00:07,  2.03it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.13it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.13it/s] 90%|████████▉ | 115/128 [00:55<00:06,  2.06it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.02it/s] 91%|█████████▏| 117/128 [00:56<00:05,  2.00it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.06it/s] 93%|█████████▎| 119/128 [00:57<00:04,  2.08it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.04it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.10it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.10it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.05it/s] 97%|█████████▋| 124/128 [01:00<00:01,  2.07it/s] 98%|█████████▊| 125/128 [01:00<00:01,  2.02it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.00it/s] 99%|█████████▉| 127/128 [01:01<00:00,  1.98it/s]100%|██████████| 128/128 [01:02<00:00,  1.97it/s]100%|██████████| 128/128 [01:02<00:00,  2.05it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.97s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.92s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.70s/it]
[2024-01-18 09:26:02,405] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 55%|█████▍    | 70/128 [00:00<00:00, 697.16it/s]100%|██████████| 128/128 [00:00<00:00, 691.15it/s]
[2024-01-18 09:26:02,718] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.18it/s]  2%|▏         | 2/128 [00:00<00:57,  2.18it/s]  2%|▏         | 3/128 [00:01<00:59,  2.09it/s]  3%|▎         | 4/128 [00:01<00:57,  2.16it/s]  4%|▍         | 5/128 [00:02<00:59,  2.05it/s]  5%|▍         | 6/128 [00:02<00:57,  2.12it/s]  5%|▌         | 7/128 [00:03<00:58,  2.06it/s]  6%|▋         | 8/128 [00:03<00:55,  2.17it/s]  7%|▋         | 9/128 [00:04<00:56,  2.10it/s]  8%|▊         | 10/128 [00:04<00:54,  2.15it/s]  9%|▊         | 11/128 [00:05<00:53,  2.19it/s]  9%|▉         | 12/128 [00:05<00:53,  2.18it/s] 10%|█         | 13/128 [00:06<00:52,  2.18it/s] 11%|█         | 14/128 [00:06<00:54,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.13it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.07it/s] 13%|█▎        | 17/128 [00:08<00:54,  2.04it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.02it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.05it/s] 16%|█▌        | 20/128 [00:09<00:51,  2.09it/s] 16%|█▋        | 21/128 [00:09<00:49,  2.14it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.15it/s] 18%|█▊        | 23/128 [00:10<00:50,  2.09it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.14it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.23it/s] 20%|██        | 26/128 [00:12<00:48,  2.12it/s] 21%|██        | 27/128 [00:12<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:13<00:49,  2.00it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.07it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.10it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.11it/s] 26%|██▌       | 33/128 [00:15<00:46,  2.04it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.02it/s] 27%|██▋       | 35/128 [00:16<00:46,  2.00it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.04it/s] 29%|██▉       | 37/128 [00:17<00:42,  2.17it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.07it/s] 30%|███       | 39/128 [00:18<00:43,  2.04it/s] 31%|███▏      | 40/128 [00:19<00:41,  2.10it/s] 32%|███▏      | 41/128 [00:19<00:42,  2.03it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.98it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.97it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.97it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.02it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.99it/s] 37%|███▋      | 47/128 [00:22<00:39,  2.04it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.99it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.04it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.10it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.12it/s] 41%|████      | 52/128 [00:24<00:35,  2.13it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.08it/s] 42%|████▏     | 54/128 [00:25<00:36,  2.03it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.10it/s] 44%|████▍     | 56/128 [00:26<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.11it/s] 45%|████▌     | 58/128 [00:27<00:34,  2.05it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.03it/s] 47%|████▋     | 60/128 [00:28<00:32,  2.09it/s] 48%|████▊     | 61/128 [00:29<00:32,  2.04it/s] 48%|████▊     | 62/128 [00:29<00:32,  2.02it/s] 49%|████▉     | 63/128 [00:30<00:32,  1.98it/s] 50%|█████     | 64/128 [00:30<00:32,  1.94it/s] 51%|█████     | 65/128 [00:31<00:32,  1.95it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.95it/s] 52%|█████▏    | 67/128 [00:32<00:29,  2.03it/s] 53%|█████▎    | 68/128 [00:32<00:30,  2.00it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.07it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.09it/s] 55%|█████▌    | 71/128 [00:34<00:27,  2.04it/s] 56%|█████▋    | 72/128 [00:34<00:27,  2.02it/s] 57%|█████▋    | 73/128 [00:35<00:29,  1.87it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.95it/s] 59%|█████▊    | 75/128 [00:36<00:26,  2.00it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.98it/s] 60%|██████    | 77/128 [00:37<00:26,  1.94it/s] 61%|██████    | 78/128 [00:38<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:38<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.93it/s] 63%|██████▎   | 81/128 [00:39<00:24,  1.94it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.94it/s] 65%|██████▍   | 83/128 [00:40<00:22,  2.00it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.04it/s] 66%|██████▋   | 85/128 [00:41<00:21,  2.01it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.99it/s] 68%|██████▊   | 87/128 [00:42<00:20,  1.98it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.97it/s] 70%|██████▉   | 89/128 [00:43<00:19,  1.96it/s] 70%|███████   | 90/128 [00:44<00:19,  1.95it/s] 71%|███████   | 91/128 [00:44<00:17,  2.08it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.03it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.00it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.98it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.96it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 99/128 [00:48<00:14,  1.95it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.03it/s] 79%|███████▉  | 101/128 [00:49<00:12,  2.09it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.04it/s] 80%|████████  | 103/128 [00:50<00:11,  2.10it/s] 81%|████████▏ | 104/128 [00:50<00:11,  2.05it/s] 82%|████████▏ | 105/128 [00:51<00:11,  2.01it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.87it/s] 84%|████████▎ | 107/128 [00:52<00:11,  1.89it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.89it/s] 85%|████████▌ | 109/128 [00:53<00:09,  1.98it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.10it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.11it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.05it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.02it/s] 89%|████████▉ | 114/128 [00:55<00:06,  2.09it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.13it/s] 91%|█████████ | 116/128 [00:56<00:05,  2.14it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.17it/s] 92%|█████████▏| 118/128 [00:57<00:04,  2.23it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.14it/s] 94%|█████████▍| 120/128 [00:58<00:03,  2.17it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.07it/s] 95%|█████████▌| 122/128 [00:59<00:02,  2.02it/s] 96%|█████████▌| 123/128 [01:00<00:02,  2.00it/s] 97%|█████████▋| 124/128 [01:00<00:02,  1.98it/s] 98%|█████████▊| 125/128 [01:01<00:01,  1.97it/s] 98%|█████████▊| 126/128 [01:01<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.05it/s]100%|██████████| 128/128 [01:02<00:00,  2.11it/s]100%|██████████| 128/128 [01:02<00:00,  2.04it/s]
[2024-01-18 09:27:05,413] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:59,  2.12it/s]  2%|▏         | 2/128 [00:00<00:58,  2.14it/s]  2%|▏         | 3/128 [00:01<01:00,  2.05it/s]  3%|▎         | 4/128 [00:01<00:59,  2.09it/s]  4%|▍         | 5/128 [00:02<01:01,  2.00it/s]  5%|▍         | 6/128 [00:02<00:58,  2.08it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:56,  2.13it/s]  7%|▋         | 9/128 [00:04<00:57,  2.07it/s]  8%|▊         | 10/128 [00:04<00:55,  2.12it/s]  9%|▊         | 11/128 [00:05<00:54,  2.15it/s]  9%|▉         | 12/128 [00:05<00:54,  2.15it/s] 10%|█         | 13/128 [00:06<00:53,  2.14it/s] 11%|█         | 14/128 [00:06<00:54,  2.08it/s] 12%|█▏        | 15/128 [00:07<00:53,  2.10it/s] 12%|█▎        | 16/128 [00:07<00:54,  2.05it/s] 13%|█▎        | 17/128 [00:08<00:55,  2.01it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.99it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.03it/s] 16%|█▌        | 20/128 [00:09<00:52,  2.06it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.12it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.07it/s] 19%|█▉        | 24/128 [00:11<00:49,  2.12it/s] 20%|█▉        | 25/128 [00:11<00:46,  2.20it/s] 20%|██        | 26/128 [00:12<00:48,  2.09it/s] 21%|██        | 27/128 [00:12<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:50,  1.98it/s] 23%|██▎       | 30/128 [00:14<00:47,  2.05it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.07it/s] 25%|██▌       | 32/128 [00:15<00:45,  2.09it/s] 26%|██▌       | 33/128 [00:15<00:47,  2.02it/s] 27%|██▋       | 34/128 [00:16<00:47,  2.00it/s] 27%|██▋       | 35/128 [00:16<00:47,  1.98it/s] 28%|██▊       | 36/128 [00:17<00:45,  2.02it/s] 29%|██▉       | 37/128 [00:17<00:42,  2.14it/s] 30%|██▉       | 38/128 [00:18<00:43,  2.06it/s] 30%|███       | 39/128 [00:18<00:43,  2.03it/s] 31%|███▏      | 40/128 [00:19<00:42,  2.09it/s] 32%|███▏      | 41/128 [00:19<00:43,  2.02it/s] 33%|███▎      | 42/128 [00:20<00:45,  1.88it/s] 34%|███▎      | 43/128 [00:21<00:45,  1.89it/s] 34%|███▍      | 44/128 [00:21<00:44,  1.90it/s] 35%|███▌      | 45/128 [00:21<00:42,  1.96it/s] 36%|███▌      | 46/128 [00:22<00:41,  1.95it/s] 37%|███▋      | 47/128 [00:22<00:40,  2.00it/s] 38%|███▊      | 48/128 [00:23<00:40,  1.96it/s] 38%|███▊      | 49/128 [00:23<00:39,  2.01it/s] 39%|███▉      | 50/128 [00:24<00:37,  2.07it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.09it/s] 41%|████      | 52/128 [00:25<00:36,  2.11it/s] 41%|████▏     | 53/128 [00:25<00:36,  2.06it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.01it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.08it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:27<00:33,  2.09it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.04it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.01it/s] 47%|████▋     | 60/128 [00:29<00:32,  2.07it/s] 48%|████▊     | 61/128 [00:29<00:33,  2.02it/s] 48%|████▊     | 62/128 [00:30<00:33,  2.00it/s] 49%|████▉     | 63/128 [00:30<00:33,  1.96it/s] 50%|█████     | 64/128 [00:31<00:33,  1.93it/s] 51%|█████     | 65/128 [00:31<00:32,  1.93it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.94it/s] 52%|█████▏    | 67/128 [00:32<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:30,  2.00it/s] 54%|█████▍    | 69/128 [00:33<00:28,  2.07it/s] 55%|█████▍    | 70/128 [00:34<00:27,  2.09it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.04it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.01it/s] 57%|█████▋    | 73/128 [00:35<00:29,  1.86it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.93it/s] 59%|█████▊    | 75/128 [00:36<00:26,  1.99it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.97it/s] 60%|██████    | 77/128 [00:37<00:26,  1.93it/s] 61%|██████    | 78/128 [00:38<00:26,  1.92it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:39<00:25,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:24,  1.93it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.93it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.99it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:42<00:21,  2.00it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.98it/s] 68%|██████▊   | 87/128 [00:43<00:20,  1.97it/s] 69%|██████▉   | 88/128 [00:43<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:44<00:20,  1.95it/s] 70%|███████   | 90/128 [00:44<00:19,  1.94it/s] 71%|███████   | 91/128 [00:45<00:17,  2.06it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.99it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.97it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.96it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.95it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.95it/s] 77%|███████▋  | 98/128 [00:48<00:15,  1.94it/s] 77%|███████▋  | 99/128 [00:49<00:14,  1.94it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.02it/s] 79%|███████▉  | 101/128 [00:50<00:12,  2.08it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.03it/s] 80%|████████  | 103/128 [00:51<00:11,  2.09it/s] 81%|████████▏ | 104/128 [00:51<00:11,  2.04it/s] 82%|████████▏ | 105/128 [00:52<00:11,  2.00it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.86it/s] 84%|████████▎ | 107/128 [00:53<00:11,  1.88it/s] 84%|████████▍ | 108/128 [00:53<00:10,  1.88it/s] 85%|████████▌ | 109/128 [00:54<00:09,  1.98it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.09it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.10it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.04it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.01it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.08it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.12it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.13it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.16it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.19it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.11it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.14it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.05it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.01it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:01<00:02,  1.97it/s] 98%|█████████▊| 125/128 [01:01<00:01,  1.96it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:02<00:00,  2.05it/s]100%|██████████| 128/128 [01:03<00:00,  2.10it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:05<00:11,  5.57s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:10<00:04,  4.99s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:16<00:00,  5.81s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:16<00:00,  5.65s/it]
[2024-01-18 09:29:05,118] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 53%|█████▎    | 68/128 [00:00<00:00, 673.18it/s]100%|██████████| 128/128 [00:00<00:00, 675.35it/s]
[2024-01-18 09:29:05,436] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.96it/s]  2%|▏         | 2/128 [00:00<01:00,  2.08it/s]  2%|▏         | 3/128 [00:01<01:01,  2.03it/s]  3%|▎         | 4/128 [00:01<01:01,  2.01it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:03<01:01,  1.97it/s]  5%|▌         | 7/128 [00:03<01:01,  1.98it/s]  6%|▋         | 8/128 [00:03<00:58,  2.04it/s]  7%|▋         | 9/128 [00:04<00:59,  2.01it/s]  8%|▊         | 10/128 [00:04<00:56,  2.09it/s]  9%|▊         | 11/128 [00:05<00:54,  2.14it/s]  9%|▉         | 12/128 [00:05<00:54,  2.14it/s] 10%|█         | 13/128 [00:06<00:55,  2.09it/s] 11%|█         | 14/128 [00:06<00:53,  2.11it/s] 12%|█▏        | 15/128 [00:07<00:58,  1.94it/s] 12%|█▎        | 16/128 [00:07<00:57,  1.94it/s] 13%|█▎        | 17/128 [00:08<00:56,  1.95it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.03it/s] 15%|█▍        | 19/128 [00:09<00:51,  2.10it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.19it/s] 16%|█▋        | 21/128 [00:10<00:49,  2.18it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.10it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.05it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.19it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.09it/s] 20%|██        | 26/128 [00:12<00:49,  2.04it/s] 21%|██        | 27/128 [00:13<00:48,  2.08it/s] 22%|██▏       | 28/128 [00:13<00:49,  2.02it/s] 23%|██▎       | 29/128 [00:14<00:46,  2.13it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.17it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.09it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.03it/s] 26%|██▌       | 33/128 [00:16<00:47,  1.99it/s] 27%|██▋       | 34/128 [00:16<00:47,  1.98it/s] 27%|██▋       | 35/128 [00:17<00:45,  2.03it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.17it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.08it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.02it/s] 30%|███       | 39/128 [00:18<00:44,  2.00it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.99it/s] 32%|███▏      | 41/128 [00:20<00:46,  1.85it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.96it/s] 34%|███▎      | 43/128 [00:21<00:43,  1.94it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.94it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.93it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.93it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.94it/s] 38%|███▊      | 49/128 [00:24<00:39,  2.00it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.05it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.11it/s] 41%|████      | 52/128 [00:25<00:37,  2.04it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.01it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.08it/s] 43%|████▎     | 55/128 [00:26<00:34,  2.14it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.05it/s] 45%|████▍     | 57/128 [00:27<00:34,  2.08it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.05it/s] 46%|████▌     | 59/128 [00:28<00:34,  2.02it/s] 47%|████▋     | 60/128 [00:29<00:33,  2.00it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.97it/s] 48%|████▊     | 62/128 [00:30<00:33,  1.95it/s] 49%|████▉     | 63/128 [00:31<00:33,  1.93it/s] 50%|█████     | 64/128 [00:31<00:33,  1.94it/s] 51%|█████     | 65/128 [00:32<00:32,  1.94it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.00it/s] 52%|█████▏    | 67/128 [00:33<00:29,  2.05it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.10it/s] 54%|█████▍    | 69/128 [00:33<00:27,  2.11it/s] 55%|█████▍    | 70/128 [00:34<00:28,  2.04it/s] 55%|█████▌    | 71/128 [00:34<00:28,  2.01it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.05it/s] 57%|█████▋    | 73/128 [00:35<00:27,  2.02it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.98it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.95it/s] 59%|█████▉    | 76/128 [00:37<00:27,  1.92it/s] 60%|██████    | 77/128 [00:38<00:26,  1.91it/s] 61%|██████    | 78/128 [00:38<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.94it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.94it/s] 63%|██████▎   | 81/128 [00:40<00:23,  2.00it/s] 64%|██████▍   | 82/128 [00:40<00:22,  2.04it/s] 65%|██████▍   | 83/128 [00:41<00:21,  2.07it/s] 66%|██████▌   | 84/128 [00:41<00:21,  2.02it/s] 66%|██████▋   | 85/128 [00:41<00:20,  2.13it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.07it/s] 68%|██████▊   | 87/128 [00:42<00:20,  2.03it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.06it/s] 70%|██████▉   | 89/128 [00:43<00:18,  2.09it/s] 70%|███████   | 90/128 [00:44<00:18,  2.10it/s] 71%|███████   | 91/128 [00:44<00:18,  2.05it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.02it/s] 73%|███████▎  | 93/128 [00:45<00:17,  2.00it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.04it/s] 74%|███████▍  | 95/128 [00:46<00:16,  1.99it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.97it/s] 76%|███████▌  | 97/128 [00:47<00:15,  1.97it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.04it/s] 77%|███████▋  | 99/128 [00:48<00:13,  2.11it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.05it/s] 79%|███████▉  | 101/128 [00:49<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.08it/s] 80%|████████  | 103/128 [00:50<00:11,  2.17it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.97it/s] 82%|████████▏ | 105/128 [00:51<00:11,  1.94it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.92it/s] 84%|████████▎ | 107/128 [00:52<00:10,  2.02it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.05it/s] 85%|████████▌ | 109/128 [00:53<00:09,  2.02it/s] 86%|████████▌ | 110/128 [00:54<00:09,  1.99it/s] 87%|████████▋ | 111/128 [00:54<00:08,  2.06it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.01it/s] 88%|████████▊ | 113/128 [00:55<00:07,  2.05it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.15it/s] 90%|████████▉ | 115/128 [00:56<00:06,  2.08it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.09it/s] 91%|█████████▏| 117/128 [00:57<00:05,  2.10it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.05it/s] 93%|█████████▎| 119/128 [00:58<00:04,  2.01it/s] 94%|█████████▍| 120/128 [00:59<00:04,  1.99it/s] 95%|█████████▍| 121/128 [00:59<00:03,  2.04it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.01it/s] 96%|█████████▌| 123/128 [01:00<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.11it/s] 98%|█████████▊| 125/128 [01:01<00:01,  2.06it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:02<00:00,  1.99it/s]100%|██████████| 128/128 [01:03<00:00,  1.97it/s]100%|██████████| 128/128 [01:03<00:00,  2.03it/s]
[2024-01-18 09:30:08,613] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.94it/s]  2%|▏         | 2/128 [00:00<01:01,  2.04it/s]  2%|▏         | 3/128 [00:01<01:02,  2.00it/s]  3%|▎         | 4/128 [00:02<01:02,  1.98it/s]  4%|▍         | 5/128 [00:02<01:02,  1.96it/s]  5%|▍         | 6/128 [00:03<01:02,  1.95it/s]  5%|▌         | 7/128 [00:03<01:02,  1.95it/s]  6%|▋         | 8/128 [00:04<00:59,  2.00it/s]  7%|▋         | 9/128 [00:04<00:59,  1.99it/s]  8%|▊         | 10/128 [00:04<00:57,  2.06it/s]  9%|▊         | 11/128 [00:05<00:55,  2.11it/s]  9%|▉         | 12/128 [00:05<00:54,  2.12it/s] 10%|█         | 13/128 [00:06<00:55,  2.06it/s] 11%|█         | 14/128 [00:06<00:54,  2.09it/s] 12%|█▏        | 15/128 [00:07<00:58,  1.92it/s] 12%|█▎        | 16/128 [00:08<00:58,  1.92it/s] 13%|█▎        | 17/128 [00:08<00:57,  1.93it/s] 14%|█▍        | 18/128 [00:08<00:54,  2.01it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.07it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.17it/s] 16%|█▋        | 21/128 [00:10<00:49,  2.16it/s] 17%|█▋        | 22/128 [00:10<00:50,  2.08it/s] 18%|█▊        | 23/128 [00:11<00:51,  2.03it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.17it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:50,  2.02it/s] 21%|██        | 27/128 [00:13<00:49,  2.05it/s] 22%|██▏       | 28/128 [00:13<00:50,  2.00it/s] 23%|██▎       | 29/128 [00:14<00:47,  2.10it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.15it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.07it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.01it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.97it/s] 27%|██▋       | 34/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 35/128 [00:17<00:46,  2.00it/s] 28%|██▊       | 36/128 [00:17<00:42,  2.14it/s] 29%|██▉       | 37/128 [00:18<00:44,  2.05it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:44,  1.98it/s] 31%|███▏      | 40/128 [00:19<00:44,  1.97it/s] 32%|███▏      | 41/128 [00:20<00:47,  1.83it/s] 33%|███▎      | 42/128 [00:20<00:44,  1.94it/s] 34%|███▎      | 43/128 [00:21<00:44,  1.92it/s] 34%|███▍      | 44/128 [00:21<00:43,  1.92it/s] 35%|███▌      | 45/128 [00:22<00:43,  1.90it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.91it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.91it/s] 38%|███▊      | 48/128 [00:23<00:41,  1.92it/s] 38%|███▊      | 49/128 [00:24<00:39,  1.98it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:25<00:36,  2.09it/s] 41%|████      | 52/128 [00:25<00:37,  2.02it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.99it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.06it/s] 43%|████▎     | 55/128 [00:27<00:34,  2.11it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.03it/s] 45%|████▍     | 57/128 [00:28<00:34,  2.06it/s] 45%|████▌     | 58/128 [00:28<00:34,  2.03it/s] 46%|████▌     | 59/128 [00:29<00:34,  2.00it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.98it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.95it/s] 48%|████▊     | 62/128 [00:30<00:34,  1.93it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.91it/s] 50%|█████     | 64/128 [00:31<00:33,  1.92it/s] 51%|█████     | 65/128 [00:32<00:32,  1.92it/s] 52%|█████▏    | 66/128 [00:32<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:30,  2.02it/s] 53%|█████▎    | 68/128 [00:33<00:28,  2.08it/s] 54%|█████▍    | 69/128 [00:34<00:29,  2.03it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.98it/s] 55%|█████▌    | 71/128 [00:35<00:29,  1.96it/s] 56%|█████▋    | 72/128 [00:35<00:27,  2.01it/s] 57%|█████▋    | 73/128 [00:36<00:27,  1.99it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.95it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.92it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.90it/s] 60%|██████    | 77/128 [00:38<00:27,  1.89it/s] 61%|██████    | 78/128 [00:39<00:26,  1.90it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.92it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:23,  1.98it/s] 64%|██████▍   | 82/128 [00:41<00:22,  2.02it/s] 65%|██████▍   | 83/128 [00:41<00:21,  2.05it/s] 66%|██████▌   | 84/128 [00:42<00:21,  2.00it/s] 66%|██████▋   | 85/128 [00:42<00:20,  2.11it/s] 67%|██████▋   | 86/128 [00:42<00:20,  2.05it/s] 68%|██████▊   | 87/128 [00:43<00:20,  2.01it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.05it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.07it/s] 70%|███████   | 90/128 [00:44<00:18,  2.09it/s] 71%|███████   | 91/128 [00:45<00:18,  2.04it/s] 72%|███████▏  | 92/128 [00:45<00:18,  2.00it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.98it/s] 73%|███████▎  | 94/128 [00:46<00:16,  2.02it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.97it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.96it/s] 76%|███████▌  | 97/128 [00:48<00:15,  1.96it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.03it/s] 77%|███████▋  | 99/128 [00:49<00:13,  2.09it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.04it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.00it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.07it/s] 80%|████████  | 103/128 [00:51<00:11,  2.16it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.95it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:52<00:11,  1.91it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.01it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.04it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.01it/s] 86%|████████▌ | 110/128 [00:54<00:09,  1.98it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.02it/s] 88%|████████▊ | 113/128 [00:56<00:07,  1.99it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.11it/s] 90%|████████▉ | 115/128 [00:57<00:06,  2.04it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.07it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.08it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.00it/s] 94%|█████████▍| 120/128 [00:59<00:04,  1.98it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.02it/s] 95%|█████████▌| 122/128 [01:00<00:03,  2.00it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.10it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.04it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  1.98it/s]100%|██████████| 128/128 [01:03<00:00,  1.96it/s]100%|██████████| 128/128 [01:03<00:00,  2.00it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:05<00:10,  5.26s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:10<00:05,  5.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  6.04s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.83s/it]
[2024-01-18 09:32:09,361] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 55%|█████▍    | 70/128 [00:00<00:00, 695.49it/s]100%|██████████| 128/128 [00:00<00:00, 701.81it/s]
[2024-01-18 09:32:09,671] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<00:58,  2.18it/s]  2%|▏         | 2/128 [00:00<01:02,  2.02it/s]  2%|▏         | 3/128 [00:01<00:58,  2.13it/s]  3%|▎         | 4/128 [00:01<00:57,  2.14it/s]  4%|▍         | 5/128 [00:02<00:57,  2.15it/s]  5%|▍         | 6/128 [00:02<00:58,  2.08it/s]  5%|▌         | 7/128 [00:03<00:57,  2.11it/s]  6%|▋         | 8/128 [00:03<00:54,  2.21it/s]  7%|▋         | 9/128 [00:04<00:53,  2.23it/s]  8%|▊         | 10/128 [00:04<00:52,  2.24it/s]  9%|▊         | 11/128 [00:05<00:51,  2.26it/s]  9%|▉         | 12/128 [00:05<00:52,  2.23it/s] 10%|█         | 13/128 [00:05<00:52,  2.21it/s] 11%|█         | 14/128 [00:06<00:51,  2.20it/s] 12%|█▏        | 15/128 [00:06<00:50,  2.22it/s] 12%|█▎        | 16/128 [00:07<00:49,  2.28it/s] 13%|█▎        | 17/128 [00:07<00:49,  2.25it/s] 14%|█▍        | 18/128 [00:08<00:49,  2.23it/s] 15%|█▍        | 19/128 [00:08<00:49,  2.21it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.19it/s] 16%|█▋        | 21/128 [00:09<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:48,  2.16it/s] 18%|█▊        | 23/128 [00:10<00:48,  2.16it/s] 19%|█▉        | 24/128 [00:10<00:48,  2.16it/s] 20%|█▉        | 25/128 [00:11<00:49,  2.10it/s] 20%|██        | 26/128 [00:11<00:44,  2.31it/s] 21%|██        | 27/128 [00:12<00:46,  2.19it/s] 22%|██▏       | 28/128 [00:12<00:45,  2.18it/s] 23%|██▎       | 29/128 [00:13<00:46,  2.11it/s] 23%|██▎       | 30/128 [00:13<00:47,  2.06it/s] 24%|██▍       | 31/128 [00:14<00:45,  2.12it/s] 25%|██▌       | 32/128 [00:14<00:44,  2.16it/s] 26%|██▌       | 33/128 [00:15<00:43,  2.16it/s] 27%|██▋       | 34/128 [00:15<00:42,  2.20it/s] 27%|██▋       | 35/128 [00:16<00:43,  2.11it/s] 28%|██▊       | 36/128 [00:16<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:17<00:43,  2.08it/s] 30%|██▉       | 38/128 [00:17<00:42,  2.13it/s] 30%|███       | 39/128 [00:18<00:41,  2.14it/s] 31%|███▏      | 40/128 [00:18<00:42,  2.07it/s] 32%|███▏      | 41/128 [00:18<00:40,  2.13it/s] 33%|███▎      | 42/128 [00:19<00:44,  1.94it/s] 34%|███▎      | 43/128 [00:20<00:43,  1.95it/s] 34%|███▍      | 44/128 [00:20<00:42,  1.96it/s] 35%|███▌      | 45/128 [00:21<00:41,  2.01it/s] 36%|███▌      | 46/128 [00:21<00:40,  2.05it/s] 37%|███▋      | 47/128 [00:21<00:38,  2.11it/s] 38%|███▊      | 48/128 [00:22<00:38,  2.05it/s] 38%|███▊      | 49/128 [00:23<00:38,  2.03it/s] 39%|███▉      | 50/128 [00:23<00:36,  2.16it/s] 40%|███▉      | 51/128 [00:23<00:35,  2.16it/s] 41%|████      | 52/128 [00:24<00:33,  2.24it/s] 41%|████▏     | 53/128 [00:24<00:34,  2.15it/s] 42%|████▏     | 54/128 [00:25<00:35,  2.07it/s] 43%|████▎     | 55/128 [00:25<00:34,  2.09it/s] 44%|████▍     | 56/128 [00:26<00:33,  2.14it/s] 45%|████▍     | 57/128 [00:26<00:30,  2.35it/s] 45%|████▌     | 58/128 [00:27<00:31,  2.22it/s] 46%|████▌     | 59/128 [00:27<00:32,  2.14it/s] 47%|████▋     | 60/128 [00:27<00:30,  2.22it/s] 48%|████▊     | 61/128 [00:28<00:30,  2.20it/s] 48%|████▊     | 62/128 [00:28<00:31,  2.12it/s] 49%|████▉     | 63/128 [00:29<00:31,  2.07it/s] 50%|█████     | 64/128 [00:29<00:31,  2.03it/s] 51%|█████     | 65/128 [00:30<00:31,  2.01it/s] 52%|█████▏    | 66/128 [00:30<00:31,  2.00it/s] 52%|█████▏    | 67/128 [00:31<00:30,  1.98it/s] 53%|█████▎    | 68/128 [00:32<00:30,  1.97it/s] 54%|█████▍    | 69/128 [00:32<00:28,  2.09it/s] 55%|█████▍    | 70/128 [00:32<00:27,  2.14it/s] 55%|█████▌    | 71/128 [00:33<00:25,  2.23it/s] 56%|█████▋    | 72/128 [00:33<00:26,  2.11it/s] 57%|█████▋    | 73/128 [00:34<00:27,  2.03it/s] 58%|█████▊    | 74/128 [00:34<00:27,  2.00it/s] 59%|█████▊    | 75/128 [00:35<00:26,  1.98it/s] 59%|█████▉    | 76/128 [00:35<00:26,  1.97it/s] 60%|██████    | 77/128 [00:36<00:25,  1.96it/s] 61%|██████    | 78/128 [00:36<00:25,  1.94it/s] 62%|██████▏   | 79/128 [00:37<00:24,  1.99it/s] 62%|██████▎   | 80/128 [00:37<00:23,  2.04it/s] 63%|██████▎   | 81/128 [00:38<00:23,  2.01it/s] 64%|██████▍   | 82/128 [00:38<00:22,  2.00it/s] 65%|██████▍   | 83/128 [00:39<00:21,  2.07it/s] 66%|██████▌   | 84/128 [00:39<00:21,  2.03it/s] 66%|██████▋   | 85/128 [00:40<00:20,  2.14it/s] 67%|██████▋   | 86/128 [00:40<00:19,  2.14it/s] 68%|██████▊   | 87/128 [00:41<00:18,  2.17it/s] 69%|██████▉   | 88/128 [00:41<00:20,  1.96it/s] 70%|██████▉   | 89/128 [00:42<00:18,  2.09it/s] 70%|███████   | 90/128 [00:42<00:18,  2.04it/s] 71%|███████   | 91/128 [00:43<00:17,  2.07it/s] 72%|███████▏  | 92/128 [00:43<00:17,  2.04it/s] 73%|███████▎  | 93/128 [00:44<00:17,  2.01it/s] 73%|███████▎  | 94/128 [00:44<00:16,  2.07it/s] 74%|███████▍  | 95/128 [00:45<00:16,  2.04it/s] 75%|███████▌  | 96/128 [00:45<00:15,  2.01it/s] 76%|███████▌  | 97/128 [00:46<00:15,  2.04it/s] 77%|███████▋  | 98/128 [00:46<00:14,  2.01it/s] 77%|███████▋  | 99/128 [00:47<00:13,  2.08it/s] 78%|███████▊  | 100/128 [00:47<00:13,  2.01it/s] 79%|███████▉  | 101/128 [00:48<00:13,  2.05it/s] 80%|███████▉  | 102/128 [00:48<00:12,  2.07it/s] 80%|████████  | 103/128 [00:48<00:11,  2.20it/s] 81%|████████▏ | 104/128 [00:49<00:10,  2.22it/s] 82%|████████▏ | 105/128 [00:49<00:10,  2.20it/s] 83%|████████▎ | 106/128 [00:50<00:09,  2.22it/s] 84%|████████▎ | 107/128 [00:50<00:09,  2.28it/s] 84%|████████▍ | 108/128 [00:51<00:08,  2.24it/s] 85%|████████▌ | 109/128 [00:51<00:08,  2.14it/s] 86%|████████▌ | 110/128 [00:52<00:08,  2.08it/s] 87%|████████▋ | 111/128 [00:52<00:07,  2.13it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.13it/s] 88%|████████▊ | 113/128 [00:53<00:07,  2.08it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.19it/s] 90%|████████▉ | 115/128 [00:54<00:05,  2.26it/s] 91%|█████████ | 116/128 [00:54<00:05,  2.15it/s] 91%|█████████▏| 117/128 [00:55<00:04,  2.22it/s] 92%|█████████▏| 118/128 [00:55<00:04,  2.23it/s] 93%|█████████▎| 119/128 [00:56<00:03,  2.28it/s] 94%|█████████▍| 120/128 [00:56<00:03,  2.16it/s] 95%|█████████▍| 121/128 [00:57<00:03,  2.19it/s] 95%|█████████▌| 122/128 [00:57<00:02,  2.10it/s] 96%|█████████▌| 123/128 [00:58<00:02,  2.15it/s] 97%|█████████▋| 124/128 [00:58<00:01,  2.08it/s] 98%|█████████▊| 125/128 [00:59<00:01,  2.13it/s] 98%|█████████▊| 126/128 [00:59<00:00,  2.05it/s] 99%|█████████▉| 127/128 [01:00<00:00,  2.11it/s]100%|██████████| 128/128 [01:00<00:00,  2.12it/s]100%|██████████| 128/128 [01:00<00:00,  2.11it/s]
[2024-01-18 09:33:10,243] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<00:58,  2.15it/s]  2%|▏         | 2/128 [00:00<01:03,  1.99it/s]  2%|▏         | 3/128 [00:01<00:59,  2.10it/s]  3%|▎         | 4/128 [00:01<00:58,  2.11it/s]  4%|▍         | 5/128 [00:02<00:57,  2.12it/s]  5%|▍         | 6/128 [00:02<00:59,  2.05it/s]  5%|▌         | 7/128 [00:03<00:58,  2.07it/s]  6%|▋         | 8/128 [00:03<00:55,  2.17it/s]  7%|▋         | 9/128 [00:04<00:54,  2.20it/s]  8%|▊         | 10/128 [00:04<00:53,  2.21it/s]  9%|▊         | 11/128 [00:05<00:52,  2.22it/s]  9%|▉         | 12/128 [00:05<00:52,  2.19it/s] 10%|█         | 13/128 [00:06<00:52,  2.18it/s] 11%|█         | 14/128 [00:06<00:52,  2.17it/s] 12%|█▏        | 15/128 [00:06<00:51,  2.19it/s] 12%|█▎        | 16/128 [00:07<00:49,  2.25it/s] 13%|█▎        | 17/128 [00:07<00:50,  2.22it/s] 14%|█▍        | 18/128 [00:08<00:50,  2.19it/s] 15%|█▍        | 19/128 [00:08<00:50,  2.18it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.16it/s] 16%|█▋        | 21/128 [00:09<00:51,  2.09it/s] 17%|█▋        | 22/128 [00:10<00:49,  2.13it/s] 18%|█▊        | 23/128 [00:10<00:49,  2.13it/s] 19%|█▉        | 24/128 [00:11<00:48,  2.13it/s] 20%|█▉        | 25/128 [00:11<00:49,  2.07it/s] 20%|██        | 26/128 [00:12<00:46,  2.20it/s] 21%|██        | 27/128 [00:12<00:47,  2.11it/s] 22%|██▏       | 28/128 [00:13<00:47,  2.12it/s] 23%|██▎       | 29/128 [00:13<00:48,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:48,  2.02it/s] 24%|██▍       | 31/128 [00:14<00:46,  2.08it/s] 25%|██▌       | 32/128 [00:14<00:45,  2.12it/s] 26%|██▌       | 33/128 [00:15<00:44,  2.13it/s] 27%|██▋       | 34/128 [00:15<00:43,  2.17it/s] 27%|██▋       | 35/128 [00:16<00:44,  2.09it/s] 28%|██▊       | 36/128 [00:16<00:45,  2.02it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.05it/s] 30%|██▉       | 38/128 [00:17<00:42,  2.11it/s] 30%|███       | 39/128 [00:18<00:42,  2.11it/s] 31%|███▏      | 40/128 [00:18<00:42,  2.05it/s] 32%|███▏      | 41/128 [00:19<00:41,  2.10it/s] 33%|███▎      | 42/128 [00:19<00:44,  1.92it/s] 34%|███▎      | 43/128 [00:20<00:44,  1.93it/s] 34%|███▍      | 44/128 [00:20<00:43,  1.93it/s] 35%|███▌      | 45/128 [00:21<00:41,  1.99it/s] 36%|███▌      | 46/128 [00:21<00:40,  2.02it/s] 37%|███▋      | 47/128 [00:22<00:38,  2.08it/s] 38%|███▊      | 48/128 [00:22<00:39,  2.03it/s] 38%|███▊      | 49/128 [00:23<00:39,  2.00it/s] 39%|███▉      | 50/128 [00:23<00:36,  2.13it/s] 40%|███▉      | 51/128 [00:24<00:36,  2.14it/s] 41%|████      | 52/128 [00:24<00:34,  2.21it/s] 41%|████▏     | 53/128 [00:25<00:35,  2.12it/s] 42%|████▏     | 54/128 [00:25<00:36,  2.04it/s] 43%|████▎     | 55/128 [00:26<00:35,  2.07it/s] 44%|████▍     | 56/128 [00:26<00:34,  2.11it/s] 45%|████▍     | 57/128 [00:26<00:30,  2.32it/s] 45%|████▌     | 58/128 [00:27<00:31,  2.20it/s] 46%|████▌     | 59/128 [00:27<00:32,  2.11it/s] 47%|████▋     | 60/128 [00:28<00:31,  2.19it/s] 48%|████▊     | 61/128 [00:28<00:30,  2.18it/s] 48%|████▊     | 62/128 [00:29<00:31,  2.09it/s] 49%|████▉     | 63/128 [00:29<00:31,  2.05it/s] 50%|█████     | 64/128 [00:30<00:31,  2.01it/s] 51%|█████     | 65/128 [00:30<00:31,  1.98it/s] 52%|█████▏    | 66/128 [00:31<00:31,  1.97it/s] 52%|█████▏    | 67/128 [00:31<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:32<00:30,  1.95it/s] 54%|█████▍    | 69/128 [00:32<00:28,  2.07it/s] 55%|█████▍    | 70/128 [00:33<00:27,  2.11it/s] 55%|█████▌    | 71/128 [00:33<00:25,  2.20it/s] 56%|█████▋    | 72/128 [00:34<00:26,  2.08it/s] 57%|█████▋    | 73/128 [00:34<00:27,  2.01it/s] 58%|█████▊    | 74/128 [00:35<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:35<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:36<00:26,  1.96it/s] 60%|██████    | 77/128 [00:36<00:26,  1.94it/s] 61%|██████    | 78/128 [00:37<00:26,  1.92it/s] 62%|██████▏   | 79/128 [00:37<00:24,  1.97it/s] 62%|██████▎   | 80/128 [00:38<00:23,  2.02it/s] 63%|██████▎   | 81/128 [00:38<00:23,  1.99it/s] 64%|██████▍   | 82/128 [00:39<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:39<00:22,  2.04it/s] 66%|██████▌   | 84/128 [00:40<00:21,  2.01it/s] 66%|██████▋   | 85/128 [00:40<00:20,  2.07it/s] 67%|██████▋   | 86/128 [00:41<00:20,  2.03it/s] 68%|██████▊   | 87/128 [00:41<00:19,  2.08it/s] 69%|██████▉   | 88/128 [00:42<00:21,  1.90it/s] 70%|██████▉   | 89/128 [00:42<00:19,  2.03it/s] 70%|███████   | 90/128 [00:43<00:19,  1.99it/s] 71%|███████   | 91/128 [00:43<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:44<00:17,  2.00it/s] 73%|███████▎  | 93/128 [00:44<00:17,  1.97it/s] 73%|███████▎  | 94/128 [00:45<00:16,  2.04it/s] 74%|███████▍  | 95/128 [00:45<00:16,  2.01it/s] 75%|███████▌  | 96/128 [00:46<00:16,  1.98it/s] 76%|███████▌  | 97/128 [00:46<00:15,  2.02it/s] 77%|███████▋  | 98/128 [00:47<00:15,  1.99it/s] 77%|███████▋  | 99/128 [00:47<00:14,  2.05it/s] 78%|███████▊  | 100/128 [00:48<00:14,  1.99it/s] 79%|███████▉  | 101/128 [00:48<00:13,  2.02it/s] 80%|███████▉  | 102/128 [00:49<00:12,  2.05it/s] 80%|████████  | 103/128 [00:49<00:11,  2.18it/s] 81%|████████▏ | 104/128 [00:50<00:10,  2.20it/s] 82%|████████▏ | 105/128 [00:50<00:10,  2.17it/s] 83%|████████▎ | 106/128 [00:51<00:10,  2.19it/s] 84%|████████▎ | 107/128 [00:51<00:09,  2.25it/s] 84%|████████▍ | 108/128 [00:51<00:09,  2.21it/s] 85%|████████▌ | 109/128 [00:52<00:09,  2.11it/s] 86%|████████▌ | 110/128 [00:53<00:08,  2.05it/s] 87%|████████▋ | 111/128 [00:53<00:08,  2.11it/s] 88%|████████▊ | 112/128 [00:53<00:07,  2.11it/s] 88%|████████▊ | 113/128 [00:54<00:07,  2.05it/s] 89%|████████▉ | 114/128 [00:54<00:06,  2.17it/s] 90%|████████▉ | 115/128 [00:55<00:05,  2.23it/s] 91%|█████████ | 116/128 [00:55<00:05,  2.13it/s] 91%|█████████▏| 117/128 [00:56<00:04,  2.20it/s] 92%|█████████▏| 118/128 [00:56<00:04,  2.21it/s] 93%|█████████▎| 119/128 [00:57<00:03,  2.26it/s] 94%|█████████▍| 120/128 [00:57<00:03,  2.14it/s] 95%|█████████▍| 121/128 [00:58<00:03,  2.14it/s] 95%|█████████▌| 122/128 [00:58<00:02,  2.07it/s] 96%|█████████▌| 123/128 [00:59<00:02,  2.12it/s] 97%|█████████▋| 124/128 [00:59<00:01,  2.05it/s] 98%|█████████▊| 125/128 [00:59<00:01,  2.10it/s] 98%|█████████▊| 126/128 [01:00<00:00,  2.02it/s] 99%|█████████▉| 127/128 [01:00<00:00,  2.09it/s]100%|██████████| 128/128 [01:01<00:00,  2.10it/s]100%|██████████| 128/128 [01:01<00:00,  2.08it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:05<00:10,  5.05s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  6.02s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.80s/it]
[2024-01-18 09:35:08,907] [openicl.icl_retriever.icl_random_retriever] [INFO] Retrieving data for test set...
  0%|          | 0/128 [00:00<?, ?it/s] 52%|█████▏    | 66/128 [00:00<00:00, 655.78it/s]100%|██████████| 128/128 [00:00<00:00, 667.17it/s]
[2024-01-18 09:35:09,228] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '0'
  0%|          | 0/128 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  1%|          | 1/128 [00:00<01:04,  1.97it/s]  2%|▏         | 2/128 [00:00<01:00,  2.08it/s]  2%|▏         | 3/128 [00:01<01:01,  2.03it/s]  3%|▎         | 4/128 [00:01<00:59,  2.08it/s]  4%|▍         | 5/128 [00:02<01:00,  2.02it/s]  5%|▍         | 6/128 [00:02<00:58,  2.10it/s]  5%|▌         | 7/128 [00:03<00:58,  2.05it/s]  6%|▋         | 8/128 [00:03<00:56,  2.12it/s]  7%|▋         | 9/128 [00:04<00:57,  2.06it/s]  8%|▊         | 10/128 [00:04<00:56,  2.10it/s]  9%|▊         | 11/128 [00:05<00:55,  2.12it/s]  9%|▉         | 12/128 [00:05<00:54,  2.13it/s] 10%|█         | 13/128 [00:06<00:55,  2.08it/s] 11%|█         | 14/128 [00:06<00:55,  2.04it/s] 12%|█▏        | 15/128 [00:07<00:59,  1.90it/s] 12%|█▎        | 16/128 [00:07<00:58,  1.91it/s] 13%|█▎        | 17/128 [00:08<00:58,  1.90it/s] 14%|█▍        | 18/128 [00:08<00:55,  1.98it/s] 15%|█▍        | 19/128 [00:09<00:52,  2.06it/s] 16%|█▌        | 20/128 [00:09<00:49,  2.18it/s] 16%|█▋        | 21/128 [00:10<00:50,  2.11it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.07it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.10it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.21it/s] 20%|█▉        | 25/128 [00:12<00:48,  2.10it/s] 20%|██        | 26/128 [00:12<00:49,  2.05it/s] 21%|██        | 27/128 [00:13<00:49,  2.03it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.99it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.06it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.16it/s] 24%|██▍       | 31/128 [00:15<00:46,  2.07it/s] 25%|██▌       | 32/128 [00:15<00:47,  2.02it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.98it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.03it/s] 27%|██▋       | 35/128 [00:16<00:42,  2.17it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.08it/s] 29%|██▉       | 37/128 [00:17<00:44,  2.04it/s] 30%|██▉       | 38/128 [00:18<00:44,  2.02it/s] 30%|███       | 39/128 [00:19<00:44,  1.98it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.95it/s] 32%|███▏      | 41/128 [00:20<00:43,  2.01it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.99it/s] 34%|███▎      | 43/128 [00:21<00:41,  2.04it/s] 34%|███▍      | 44/128 [00:21<00:41,  2.01it/s] 35%|███▌      | 45/128 [00:22<00:44,  1.87it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.94it/s] 37%|███▋      | 47/128 [00:23<00:41,  1.93it/s] 38%|███▊      | 48/128 [00:23<00:39,  2.02it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.06it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.02it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.06it/s] 41%|████      | 52/128 [00:25<00:37,  2.02it/s] 41%|████▏     | 53/128 [00:26<00:37,  2.00it/s] 42%|████▏     | 54/128 [00:26<00:35,  2.07it/s] 43%|████▎     | 55/128 [00:27<00:35,  2.03it/s] 44%|████▍     | 56/128 [00:27<00:35,  2.01it/s] 45%|████▍     | 57/128 [00:28<00:35,  1.98it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.98it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.96it/s] 47%|████▋     | 60/128 [00:29<00:34,  1.96it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.94it/s] 48%|████▊     | 62/128 [00:30<00:36,  1.82it/s] 49%|████▉     | 63/128 [00:31<00:34,  1.87it/s] 50%|█████     | 64/128 [00:31<00:33,  1.88it/s] 51%|█████     | 65/128 [00:32<00:32,  1.91it/s] 52%|█████▏    | 66/128 [00:32<00:30,  2.00it/s] 52%|█████▏    | 67/128 [00:33<00:30,  1.98it/s] 53%|█████▎    | 68/128 [00:33<00:30,  1.97it/s] 54%|█████▍    | 69/128 [00:34<00:30,  1.95it/s] 55%|█████▍    | 70/128 [00:34<00:29,  1.94it/s] 55%|█████▌    | 71/128 [00:35<00:28,  2.00it/s] 56%|█████▋    | 72/128 [00:35<00:26,  2.14it/s] 57%|█████▋    | 73/128 [00:36<00:26,  2.05it/s] 58%|█████▊    | 74/128 [00:36<00:27,  1.99it/s] 59%|█████▊    | 75/128 [00:37<00:26,  1.97it/s] 59%|█████▉    | 76/128 [00:37<00:26,  1.93it/s] 60%|██████    | 77/128 [00:38<00:26,  1.92it/s] 61%|██████    | 78/128 [00:38<00:25,  1.93it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.93it/s] 62%|██████▎   | 80/128 [00:39<00:24,  1.94it/s] 63%|██████▎   | 81/128 [00:40<00:23,  2.02it/s] 64%|██████▍   | 82/128 [00:40<00:23,  1.99it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.98it/s] 66%|██████▌   | 84/128 [00:41<00:22,  1.97it/s] 66%|██████▋   | 85/128 [00:42<00:21,  1.96it/s] 67%|██████▋   | 86/128 [00:42<00:21,  1.95it/s] 68%|██████▊   | 87/128 [00:43<00:21,  1.95it/s] 69%|██████▉   | 88/128 [00:43<00:19,  2.03it/s] 70%|██████▉   | 89/128 [00:44<00:18,  2.06it/s] 70%|███████   | 90/128 [00:44<00:18,  2.01it/s] 71%|███████   | 91/128 [00:45<00:18,  2.04it/s] 72%|███████▏  | 92/128 [00:45<00:17,  2.01it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.96it/s] 73%|███████▎  | 94/128 [00:46<00:17,  1.96it/s] 74%|███████▍  | 95/128 [00:47<00:16,  1.95it/s] 75%|███████▌  | 96/128 [00:47<00:16,  1.94it/s] 76%|███████▌  | 97/128 [00:48<00:15,  2.02it/s] 77%|███████▋  | 98/128 [00:48<00:14,  2.00it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.04it/s] 78%|███████▊  | 100/128 [00:49<00:13,  2.10it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.05it/s] 80%|███████▉  | 102/128 [00:50<00:12,  2.10it/s] 80%|████████  | 103/128 [00:51<00:12,  1.93it/s] 81%|████████▏ | 104/128 [00:51<00:12,  1.93it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:52<00:10,  2.02it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.08it/s] 84%|████████▍ | 108/128 [00:53<00:09,  2.10it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.03it/s] 86%|████████▌ | 110/128 [00:54<00:08,  2.01it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.05it/s] 88%|████████▊ | 112/128 [00:55<00:07,  2.10it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.04it/s] 89%|████████▉ | 114/128 [00:56<00:06,  2.01it/s] 90%|████████▉ | 115/128 [00:57<00:06,  1.99it/s] 91%|█████████ | 116/128 [00:57<00:05,  2.03it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.06it/s] 92%|█████████▏| 118/128 [00:58<00:04,  2.03it/s] 93%|█████████▎| 119/128 [00:59<00:04,  2.00it/s] 94%|█████████▍| 120/128 [00:59<00:03,  2.07it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.03it/s] 95%|█████████▌| 122/128 [01:00<00:02,  2.01it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.99it/s] 97%|█████████▋| 124/128 [01:01<00:01,  2.03it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.09it/s] 98%|█████████▊| 126/128 [01:02<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.05it/s]100%|██████████| 128/128 [01:03<00:00,  2.02it/s]100%|██████████| 128/128 [01:03<00:00,  2.01it/s]
[2024-01-18 09:36:12,851] [openicl.icl_inferencer.icl_ppl_inferencer] [INFO] Calculating PPL for prompts labeled '1'
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:00<01:05,  1.94it/s]  2%|▏         | 2/128 [00:00<01:01,  2.05it/s]  2%|▏         | 3/128 [00:01<01:02,  2.01it/s]  3%|▎         | 4/128 [00:01<01:00,  2.05it/s]  4%|▍         | 5/128 [00:02<01:01,  1.99it/s]  5%|▍         | 6/128 [00:02<00:58,  2.07it/s]  5%|▌         | 7/128 [00:03<00:59,  2.03it/s]  6%|▋         | 8/128 [00:03<00:57,  2.09it/s]  7%|▋         | 9/128 [00:04<00:58,  2.03it/s]  8%|▊         | 10/128 [00:04<00:57,  2.07it/s]  9%|▊         | 11/128 [00:05<00:55,  2.09it/s]  9%|▉         | 12/128 [00:05<00:55,  2.10it/s] 10%|█         | 13/128 [00:06<00:56,  2.05it/s] 11%|█         | 14/128 [00:06<00:56,  2.01it/s] 12%|█▏        | 15/128 [00:07<01:00,  1.87it/s] 12%|█▎        | 16/128 [00:08<00:59,  1.88it/s] 13%|█▎        | 17/128 [00:08<00:59,  1.88it/s] 14%|█▍        | 18/128 [00:09<00:56,  1.95it/s] 15%|█▍        | 19/128 [00:09<00:53,  2.03it/s] 16%|█▌        | 20/128 [00:09<00:50,  2.15it/s] 16%|█▋        | 21/128 [00:10<00:51,  2.08it/s] 17%|█▋        | 22/128 [00:10<00:51,  2.04it/s] 18%|█▊        | 23/128 [00:11<00:50,  2.07it/s] 19%|█▉        | 24/128 [00:11<00:47,  2.18it/s] 20%|█▉        | 25/128 [00:12<00:49,  2.08it/s] 20%|██        | 26/128 [00:12<00:50,  2.03it/s] 21%|██        | 27/128 [00:13<00:50,  2.01it/s] 22%|██▏       | 28/128 [00:13<00:50,  1.97it/s] 23%|██▎       | 29/128 [00:14<00:48,  2.04it/s] 23%|██▎       | 30/128 [00:14<00:45,  2.14it/s] 24%|██▍       | 31/128 [00:15<00:47,  2.05it/s] 25%|██▌       | 32/128 [00:15<00:48,  2.00it/s] 26%|██▌       | 33/128 [00:16<00:48,  1.95it/s] 27%|██▋       | 34/128 [00:16<00:46,  2.00it/s] 27%|██▋       | 35/128 [00:17<00:43,  2.14it/s] 28%|██▊       | 36/128 [00:17<00:44,  2.05it/s] 29%|██▉       | 37/128 [00:18<00:45,  2.01it/s] 30%|██▉       | 38/128 [00:18<00:45,  1.99it/s] 30%|███       | 39/128 [00:19<00:45,  1.96it/s] 31%|███▏      | 40/128 [00:19<00:45,  1.93it/s] 32%|███▏      | 41/128 [00:20<00:43,  1.99it/s] 33%|███▎      | 42/128 [00:20<00:43,  1.97it/s] 34%|███▎      | 43/128 [00:21<00:42,  2.01it/s] 34%|███▍      | 44/128 [00:21<00:42,  1.99it/s] 35%|███▌      | 45/128 [00:22<00:44,  1.85it/s] 36%|███▌      | 46/128 [00:22<00:42,  1.92it/s] 37%|███▋      | 47/128 [00:23<00:42,  1.91it/s] 38%|███▊      | 48/128 [00:23<00:40,  2.00it/s] 38%|███▊      | 49/128 [00:24<00:38,  2.04it/s] 39%|███▉      | 50/128 [00:24<00:38,  2.00it/s] 40%|███▉      | 51/128 [00:25<00:37,  2.04it/s] 41%|████      | 52/128 [00:25<00:37,  2.00it/s] 41%|████▏     | 53/128 [00:26<00:37,  1.98it/s] 42%|████▏     | 54/128 [00:26<00:36,  2.05it/s] 43%|████▎     | 55/128 [00:27<00:36,  2.01it/s] 44%|████▍     | 56/128 [00:27<00:36,  1.99it/s] 45%|████▍     | 57/128 [00:28<00:36,  1.97it/s] 45%|████▌     | 58/128 [00:28<00:35,  1.96it/s] 46%|████▌     | 59/128 [00:29<00:35,  1.95it/s] 47%|████▋     | 60/128 [00:29<00:35,  1.94it/s] 48%|████▊     | 61/128 [00:30<00:34,  1.92it/s] 48%|████▊     | 62/128 [00:31<00:36,  1.81it/s] 49%|████▉     | 63/128 [00:31<00:35,  1.85it/s] 50%|█████     | 64/128 [00:32<00:34,  1.86it/s] 51%|█████     | 65/128 [00:32<00:33,  1.89it/s] 52%|█████▏    | 66/128 [00:33<00:31,  1.98it/s] 52%|█████▏    | 67/128 [00:33<00:31,  1.96it/s] 53%|█████▎    | 68/128 [00:34<00:30,  1.96it/s] 54%|█████▍    | 69/128 [00:34<00:30,  1.93it/s] 55%|█████▍    | 70/128 [00:35<00:30,  1.93it/s] 55%|█████▌    | 71/128 [00:35<00:28,  1.98it/s] 56%|█████▋    | 72/128 [00:36<00:26,  2.13it/s] 57%|█████▋    | 73/128 [00:36<00:27,  2.03it/s] 58%|█████▊    | 74/128 [00:37<00:27,  1.98it/s] 59%|█████▊    | 75/128 [00:37<00:27,  1.95it/s] 59%|█████▉    | 76/128 [00:38<00:27,  1.92it/s] 60%|██████    | 77/128 [00:38<00:26,  1.91it/s] 61%|██████    | 78/128 [00:39<00:26,  1.91it/s] 62%|██████▏   | 79/128 [00:39<00:25,  1.91it/s] 62%|██████▎   | 80/128 [00:40<00:24,  1.92it/s] 63%|██████▎   | 81/128 [00:40<00:23,  2.00it/s] 64%|██████▍   | 82/128 [00:41<00:23,  1.97it/s] 65%|██████▍   | 83/128 [00:41<00:22,  1.96it/s] 66%|██████▌   | 84/128 [00:42<00:22,  1.95it/s] 66%|██████▋   | 85/128 [00:42<00:22,  1.94it/s] 67%|██████▋   | 86/128 [00:43<00:21,  1.94it/s] 68%|██████▊   | 87/128 [00:43<00:21,  1.93it/s] 69%|██████▉   | 88/128 [00:44<00:19,  2.02it/s] 70%|██████▉   | 89/128 [00:44<00:19,  2.05it/s] 70%|███████   | 90/128 [00:45<00:19,  1.99it/s] 71%|███████   | 91/128 [00:45<00:18,  2.03it/s] 72%|███████▏  | 92/128 [00:46<00:18,  2.00it/s] 73%|███████▎  | 93/128 [00:46<00:17,  1.95it/s] 73%|███████▎  | 94/128 [00:47<00:17,  1.95it/s] 74%|███████▍  | 95/128 [00:47<00:17,  1.94it/s] 75%|███████▌  | 96/128 [00:48<00:16,  1.93it/s] 76%|███████▌  | 97/128 [00:48<00:15,  2.01it/s] 77%|███████▋  | 98/128 [00:49<00:15,  1.99it/s] 77%|███████▋  | 99/128 [00:49<00:14,  2.03it/s] 78%|███████▊  | 100/128 [00:50<00:13,  2.09it/s] 79%|███████▉  | 101/128 [00:50<00:13,  2.04it/s] 80%|███████▉  | 102/128 [00:51<00:12,  2.09it/s] 80%|████████  | 103/128 [00:51<00:13,  1.92it/s] 81%|████████▏ | 104/128 [00:52<00:12,  1.92it/s] 82%|████████▏ | 105/128 [00:52<00:11,  1.93it/s] 83%|████████▎ | 106/128 [00:53<00:10,  2.01it/s] 84%|████████▎ | 107/128 [00:53<00:10,  2.07it/s] 84%|████████▍ | 108/128 [00:54<00:09,  2.09it/s] 85%|████████▌ | 109/128 [00:54<00:09,  2.02it/s] 86%|████████▌ | 110/128 [00:55<00:09,  2.00it/s] 87%|████████▋ | 111/128 [00:55<00:08,  2.03it/s] 88%|████████▊ | 112/128 [00:56<00:07,  2.09it/s] 88%|████████▊ | 113/128 [00:56<00:07,  2.03it/s] 89%|████████▉ | 114/128 [00:57<00:07,  2.00it/s] 90%|████████▉ | 115/128 [00:57<00:06,  1.98it/s] 91%|█████████ | 116/128 [00:58<00:05,  2.02it/s] 91%|█████████▏| 117/128 [00:58<00:05,  2.05it/s] 92%|█████████▏| 118/128 [00:59<00:04,  2.02it/s] 93%|█████████▎| 119/128 [00:59<00:04,  1.99it/s] 94%|█████████▍| 120/128 [01:00<00:03,  2.06it/s] 95%|█████████▍| 121/128 [01:00<00:03,  2.02it/s] 95%|█████████▌| 122/128 [01:01<00:03,  2.00it/s] 96%|█████████▌| 123/128 [01:01<00:02,  1.98it/s] 97%|█████████▋| 124/128 [01:02<00:01,  2.02it/s] 98%|█████████▊| 125/128 [01:02<00:01,  2.08it/s] 98%|█████████▊| 126/128 [01:03<00:00,  2.01it/s] 99%|█████████▉| 127/128 [01:03<00:00,  2.04it/s]100%|██████████| 128/128 [01:04<00:00,  2.01it/s]100%|██████████| 128/128 [01:04<00:00,  1.99it/s]
it took 9122.617132425308 seconds for NousResearch/Llama-2-7b-hfto sort 50 cases with 16 ices in sst2
